/*
 * ! UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2015 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/base/ManagedObject','sap/ui/dt/ElementUtil'],function(M,E){"use strict";var a=M.extend("sap.ui.dt.ManagedObjectObserver",{metadata:{"abstract":true,library:"sap.ui.dt",properties:{},associations:{target:{type:"sap.ui.base.ManagedObject"}},events:{modified:{parameters:{type:"string",value:"any",oldValue:"any",target:"sap.ui.core.Element"}},destroyed:{}}}});a.prototype.init=function(){};a.prototype.exit=function(){var t=this.getTargetInstance();if(t){this.unobserve(t);}};a.prototype.setTarget=function(t){var o=this.getTargetInstance();if(o){this.unobserve(o);}this.setAssociation("target",t);var T=this.getTargetInstance();if(T){this.observe(T);}return this;};a.prototype.observe=function(t){var b=this;t.attachEvent("_change",this.fireModified,this);var o=this._fnOriginalDestroy=t.destroy;var d=false;t.destroy=function(){if(d){return;}b.unobserve(t);var O=o.apply(this,arguments);b.fireDestroyed();return O;};this._fnOriginalBindProperty=t.bindProperty;t.bindProperty=function(){var O=b._fnOriginalBindProperty.apply(this,arguments);b.fireModified();return O;};this._fnOriginalUnBindProperty=t.unbindProperty;t.unbindProperty=function(){var O=b._fnOriginalUnBindProperty.apply(this,arguments);b.fireModified();return O;};this._fnOriginalBindAggregation=t.bindAggregation;t.bindAggregation=function(s){var O=b._fnOriginalBindAggregation.apply(this,arguments);b.fireModified();return O;};this._fnOriginalUnBindAggregation=t.unbindAggregation;t.unbindAggregation=function(s){var O=b._fnOriginalUnBindAggregation.apply(this,arguments);b.fireModified();return O;};this._fnOriginalSetParent=t.setParent;t.setParent=function(p,s,S){var f=false;if(!this._bInSetParent){f=true;this._bInSetParent=true;}var c=this.getParent();var O=b._fnOriginalSetParent.apply(this,arguments);if(f&&!this.__bSapUiDtSupressParentChangeEvent){this._bInSetParent=false;if(c!==p){b.fireModified({type:"setParent",value:p,oldValue:c,target:this});}}return O;};this._fnOriginalAddAggregation=t.addAggregation;t.addAggregation=function(s,O,S){b._bAddOrSetAggregationCall=true;var v=b._fnOriginalAddAggregation.apply(this,arguments);b.fireModified({type:"addOrSetAggregation",value:O,target:this});return v;};this._fnOriginalSetAggregation=t.setAggregation;t.setAggregation=function(s,O,S){b._bAddOrSetAggregationCall=true;var v=b._fnOriginalSetAggregation.apply(this,arguments);b.fireModified({type:"addOrSetAggregation",value:O,target:this});return v;};this._fnOriginalRemoveAggregation=t.removeAggregation;t.removeAggregation=function(s,O,S){b._bRemoveAggregationCall=true;var v=b._fnOriginalRemoveAggregation.apply(this,arguments);b.fireModified({type:"removeAggregation",value:O,target:this});return v;};this._fnOriginalInsertAggregation=t.insertAggregation;t.insertAggregation=function(s,O,i,S){b._bInsertAggregationCall=true;var v=b._fnOriginalInsertAggregation.apply(this,arguments);b.fireModified({type:"insertAggregation",value:O,target:this});return v;};this._fnOriginalRemoveAllAggregation=t.removeAllAggregation;t.removeAllAggregation=function(s,S){b._bRemoveAllAggregationCall=true;var r=this.getAggregation(s);var O=b._fnOriginalRemoveAllAggregation.apply(this,arguments);b.fireModified({type:"removeAllAggregation",value:r,target:this});return O;};this._fnOriginalDestroyAggregation=t.destroyAggregation;t.destroyAggregation=function(s,S){b._bDestroyAggregationCall=true;var r=this.getAggregation(s);var O=b._fnOriginalDestroyAggregation.apply(this,arguments);b.fireModified({type:"destroyAggregation",value:r,target:this});return O;};b._aOriginalAddMutators={};b._aOriginalInsertMutators={};b._aOriginalRemoveMutators={};b._aOriginalRemoveAllMutators={};b._aOriginalDestructors={};var A=t.getMetadata().getAllAggregations();Object.keys(A).forEach(function(s){var c=A[s];var _=t[c._sMutator];b._aOriginalAddMutators[c.name]=_;t[c._sMutator]=function(O){b._bAddOrSetAggregationCall=false;var v;if(O&&typeof O==='object'){O.__bSapUiDtSupressOverlayDestroy=true;}try{v=_.apply(this,arguments);}finally{if(O&&typeof O==='object'){delete O.__bSapUiDtSupressOverlayDestroy;}}if(!b._bAddOrSetAggregationCall){b.fireModified({type:"addOrSetAggregation",value:O,target:this});}return v;};var e=t[c._sInsertMutator];b._aOriginalInsertMutators[c.name]=e;t[c._sInsertMutator]=function(O,i){b._bInsertAggregationCall=false;var v;if(O&&typeof O==='object'){O.__bSapUiDtSupressOverlayDestroy=true;}try{v=e.apply(this,arguments);}finally{if(O&&typeof O==='object'){delete O.__bSapUiDtSupressOverlayDestroy;}}if(!b._bInsertAggregationCall){b.fireModified({type:"insertAggregation",value:O,target:this});}return v;};var f=t[c._sRemoveMutator];b._aOriginalRemoveMutators[c.name]=f;t[c._sRemoveMutator]=function(O,S){b._bRemoveAggregationCall=false;var v=f.apply(this,arguments);if(!b._bRemoveAggregationCall){b.fireModified({type:"removeAggregation",value:O,target:this});}return v;};var g=t[c._sRemoveAllMutator];b._aOriginalRemoveAllMutators[c.name]=g;t[c._sRemoveAllMutator]=function(S){b._bRemoveAllAggregationCall=false;var r=this.getAggregation(s);var O=g.apply(this,arguments);if(!b._bRemoveAllAggregationCall){b.fireModified({type:"removeAllAggregation",value:r,target:this});}return O;};var h=t[c._sDestructor];b._aOriginalDestructors[c.name]=h;t[c._sDestructor]=function(S){b._bDestroyAggregationCall=false;var r=this.getAggregation(s);var O=h.apply(this,arguments);if(!b._bDestroyAggregationCall){b.fireModified({type:"destroyAggregation",value:r,target:this});}return O;};});};a.prototype.unobserve=function(t){var b=this;t.destroy=this._fnOriginalDestroy;delete this._fnOriginalDestroy;t.bindProperty=this._fnOriginalBindProperty;delete this._fnOriginalBindProperty;t.unbindProperty=this._fnOriginalUnBindProperty;delete this._fnOriginalUnBindProperty;t.bindAggregation=this._fnOriginalBindAggregation;delete this._fnOriginalBindAggregation;t.unbindAggregation=this._fnOriginalUnBindAggregation;delete this._fnOriginalUnBindAggregation;t.setParent=this._fnOriginalSetParent;delete this._fnOriginalSetParent;t.addAggregation=this._fnOriginalAddAggregation;delete this._fnOriginalAddAggregation;t.removeAggregation=this._fnOriginalRemoveAggregation;delete this._fnOriginalRemoveAggregation;t.insertAggregation=this._fnOriginalInsertAggregation;delete this._fnOriginalInsertAggregation;t.setAggregation=this._fnOriginalSetAggregation;delete this._fnOriginalSetAggregation;t.removeAllAggregation=this._fnOriginalRemoveAllAggregation;delete this._fnOriginalRemoveAllAggregations;t.destroyAggregation=this._fnOriginalDestroyAggregation;delete this._fnOriginalDestroyAggregation;var A=t.getMetadata().getAllAggregations();Object.keys(A).forEach(function(s){var o=A[s];t[o._sMutator]=b._aOriginalAddMutators[o.name];t[o._sInsertMutator]=b._aOriginalInsertMutators[o.name];t[o._sRemoveMutator]=b._aOriginalRemoveMutators[o.name];t[o._sRemoveAllMutator]=b._aOriginalRemoveAllMutators[o.name];t[o._sDestructor]=b._aOriginalDestructors[o.name];});delete this._aOriginalAddMutators;delete this._aOriginalInsertMutators;delete this._aOriginalRemoveMutators;delete this._aOriginalRemoveAllMutators;delete this._aOriginalDestructors;t.detachEvent("_change",this.fireModified,this);};a.prototype.getTargetInstance=function(){return sap.ui.getCore().byId(this.getTarget());};return a;},true);
