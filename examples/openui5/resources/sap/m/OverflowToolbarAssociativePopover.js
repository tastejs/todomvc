/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2015 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['./Popover','./PopoverRenderer','./OverflowToolbarAssociativePopoverControls','./OverflowToolbarLayoutData'],function(P,a,O,b){"use strict";var c=P.extend("sap.m._overflowToolbarHelpers.OverflowToolbarAssociativePopover",{metadata:{associations:{associatedContent:{type:"sap.ui.core.Control",multiple:true}}},renderer:a.render});c.prototype.init=function(){P.prototype.init.apply(this,arguments);this.oControlsManager=new O();};c.prototype.onBeforeRendering=function(){P.prototype.onBeforeRendering.apply(this,arguments);this.addStyleClass("sapMOTAPopover");var h=this._getAllContent().some(function(o){return o.hasStyleClass("sapMOTAPButtonWithIcon");});if(h){this.addStyleClass("sapMOTAPButtonsWithIcons");}else{this.removeStyleClass("sapMOTAPButtonsWithIcons");}};c.prototype.addAssociatedContent=function(o){this.addAssociation("associatedContent",o,true);this._preProcessControl(o);return this;};c.prototype.removeAssociatedContent=function(o){var r=this.removeAssociation("associatedContent",o,true),d;if(r){d=sap.ui.getCore().byId(r);this._postProcessControl(d);}return r;};c.prototype._preProcessControl=function(o){var s=o.getMetadata().getName(),d=O.getControlConfig(o),A,p;d.listenForEvents.forEach(function(e){A="attach"+C(e);o[A](this._closeOnInteraction,this);},this);p="_preProcess"+s.split(".").map(C).join("");if(typeof this.oControlsManager[p]==="function"){this.oControlsManager[p](o);}var l=o.getLayoutData();if(l instanceof b&&l.getPriority()===sap.m.OverflowToolbarPriority.Disappear){o.addStyleClass("sapMOTAPHidden");}return this;};c.prototype._postProcessControl=function(o){var s=o.getMetadata().getName(),d=O.getControlConfig(o),D,p;d.listenForEvents.forEach(function(e){D="detach"+C(e);o[D](this._closeOnInteraction,this);},this);p="_postProcess"+s.split(".").map(C).join("");if(typeof this.oControlsManager[p]==="function"){this.oControlsManager[p](o);}o.removeStyleClass("sapMOTAPHidden");o.$().remove();return this;};c.prototype._closeOnInteraction=function(){this.close();};c.prototype._getContentIdsHash=function(){return this._getAllContent().join(".");};c.prototype._getAllContent=function(){var A=this.getAssociatedContent().map(function(i){return sap.ui.getCore().byId(i);});if(this.getPlacement()===sap.m.PlacementType.Top){A.reverse();}return this.getContent().concat(A);};c.prototype.getCurrentPosition=function(){return this._oCalcedPos;};c.prototype._calcPlacement=function(){var r=P.prototype._calcPlacement.call(this);this.fireAfterOpen({});return r;};function C(n){return n.substring(0,1).toUpperCase()+n.substring(1);}return c;},false);
