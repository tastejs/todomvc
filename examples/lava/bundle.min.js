!function(e){function t(){return""===_.hash||"#"===_.hash}function i(e,t){for(var i=0;i<e.length;i+=1)if(t(e[i],i,e)===!1)return}function a(e){for(var t=[],i=0,a=e.length;a>i;i++)t=t.concat(e[i]);return t}function n(e,t,i){if(!e.length)return i();var a=0;!function n(){t(e[a],function(t){t||t===!1?(i(t),i=function(){}):(a+=1,a===e.length?i():n())})}()}function r(e,t,i){i=e;for(var a in t)if(t.hasOwnProperty(a)&&(i=t[a](e),i!==e))break;return i===e?"([._a-zA-Z0-9-%()]+)":i}function o(e,t){for(var i,a=0,n="";i=e.substr(a).match(/[^\w\d\- %@&]*\*[^\w\d\- %@&]*/);)a=i.index+i[0].length,i[0]=i[0].replace(/^\*/,"([_.()!\\ %@&a-zA-Z0-9-]+)"),n+=e.substr(0,i.index)+i[0];e=n+=e.substr(a);var s,o,l=e.match(/:([^\/]+)/gi);if(l){o=l.length;for(var _=0;o>_;_++)s=l[_],e="::"===s.slice(0,2)?s.slice(1):e.replace(s,r(s,t))}return e}function l(e,t,i,a){var n,s=0,r=0,o=0,i=""+(i||"("),a=""+(a||")");for(n=0;n<e.length;n++){var l=e[n];if(l.indexOf(i,s)>l.indexOf(a,s)||~l.indexOf(i,s)&&!~l.indexOf(a,s)||!~l.indexOf(i,s)&&~l.indexOf(a,s)){if(r=l.indexOf(i,s),o=l.indexOf(a,s),~r&&!~o||!~r&&~o){var _=e.slice(0,(n||1)+1).join(t);e=[_].concat(e.slice((n||1)+1))}s=(o>r?o:r)+1,n=0}else s=0}return e}var _=document.location,c={mode:"modern",hash:_.hash,history:!1,check:function(){var e=_.hash;e!=this.hash&&(this.hash=e,this.onHashChanged())},fire:function(){"modern"===this.mode?this.history===!0?window.onpopstate():window.onhashchange():this.onHashChanged()},init:function(e,t){function i(e){for(var t=0,i=h.listeners.length;i>t;t++)h.listeners[t](e)}var a=this;if(this.history=t,h.listeners||(h.listeners=[]),"onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7))this.history===!0?setTimeout(function(){window.onpopstate=i},500):window.onhashchange=i,this.mode="modern";else{var n=document.createElement("iframe");n.id="state-frame",n.style.display="none",document.body.appendChild(n),this.writeFrame(""),"onpropertychange"in document&&"attachEvent"in document&&document.attachEvent("onpropertychange",function(){"location"===event.propertyName&&a.check()}),window.setInterval(function(){a.check()},50),this.onHashChanged=i,this.mode="legacy"}return h.listeners.push(e),this.mode},destroy:function(e){if(h&&h.listeners)for(var t=h.listeners,i=t.length-1;i>=0;i--)t[i]===e&&t.splice(i,1)},setHash:function(e){return"legacy"===this.mode&&this.writeFrame(e),this.history===!0?(window.history.pushState({},document.title,e),this.fire()):_.hash="/"===e[0]?e:"/"+e,this},writeFrame:function(e){var t=document.getElementById("state-frame"),i=t.contentDocument||t.contentWindow.document;i.open(),i.write("<script>_hash = '"+e+"'; onload = parent.listener.syncHash;<script>"),i.close()},syncHash:function(){var e=this._hash;return e!=_.hash&&(_.hash=e),this},onHashChanged:function(){}},h=e.Router=function(e){return this instanceof h?(this.params={},this.routes={},this.methods=["on","once","after","before"],this.scope=[],this._methods={},this._insert=this.insert,this.insert=this.insertEx,this.historySupport=null!=(null!=window.history?window.history.pushState:null),this.configure(),void this.mount(e||{})):new h(e)};h.prototype.init=function(e){var i,a=this;return this.handler=function(e){var t=e&&e.newURL||window.location.hash,i=a.history===!0?a.getPath():t.replace(/.*#/,"");a.dispatch("on","/"===i.charAt(0)?i:"/"+i)},c.init(this.handler,this.history),this.history===!1?t()&&e?_.hash=e:t()||a.dispatch("on","/"+_.hash.replace(/^(#\/|#|\/)/,"")):(this.convert_hash_in_init?(i=t()&&e?e:t()?null:_.hash.replace(/^#/,""),i&&window.history.replaceState({},document.title,i)):i=this.getPath(),(i||this.run_in_init===!0)&&this.handler()),this},h.prototype.explode=function(){var e=this.history===!0?this.getPath():_.hash;return"/"===e.charAt(1)&&(e=e.slice(1)),e.slice(1,e.length).split("/")},h.prototype.setRoute=function(e,t,i){var a=this.explode();return"number"==typeof e&&"string"==typeof t?a[e]=t:"string"==typeof i?a.splice(e,t,s):a=[e],c.setHash(a.join("/")),a},h.prototype.insertEx=function(e,t,i,a){return"once"===e&&(e="on",i=function(e){var t=!1;return function(){return t?void 0:(t=!0,e.apply(this,arguments))}}(i)),this._insert(e,t,i,a)},h.prototype.getRoute=function(e){var t=e;if("number"==typeof e)t=this.explode()[e];else if("string"==typeof e){var i=this.explode();t=i.indexOf(e)}else t=this.explode();return t},h.prototype.destroy=function(){return c.destroy(this.handler),this},h.prototype.getPath=function(){var e=window.location.pathname;return"/"!==e.substr(0,1)&&(e="/"+e),e};var u=/\?.*/;h.prototype.configure=function(e){e=e||{};for(var t=0;t<this.methods.length;t++)this._methods[this.methods[t]]=!0;return this.recurse=e.recurse||this.recurse||!1,this.async=e.async||!1,this.delimiter=e.delimiter||"/",this.strict=void 0===e.strict?!0:e.strict,this.notfound=e.notfound,this.resource=e.resource,this.history=e.html5history&&this.historySupport||!1,this.run_in_init=this.history===!0&&e.run_handler_in_init!==!1,this.convert_hash_in_init=this.history===!0&&e.convert_hash_in_init!==!1,this.every={after:e.after||null,before:e.before||null,on:e.on||null},this},h.prototype.param=function(e,t){":"!==e[0]&&(e=":"+e);var i=RegExp(e,"g");return this.params[e]=function(e){return e.replace(i,t.source||t)},this},h.prototype.on=h.prototype.route=function(e,t,i){var a=this;return i||"function"!=typeof t||(i=t,t=e,e="on"),Array.isArray(t)?t.forEach(function(t){a.on(e,t,i)}):(t.source&&(t=t.source.replace(/\\\//gi,"/")),Array.isArray(e)?e.forEach(function(e){a.on(e.toLowerCase(),t,i)}):(t=t.split(RegExp(this.delimiter)),t=l(t,this.delimiter),void this.insert(e,this.scope.concat(t),i)))},h.prototype.path=function(e,t){var i=this.scope.length;e.source&&(e=e.source.replace(/\\\//gi,"/")),e=e.split(RegExp(this.delimiter)),e=l(e,this.delimiter),this.scope=this.scope.concat(e),t.call(this,this),this.scope.splice(i,e.length)},h.prototype.dispatch=function(e,t,i){function a(){s.last=r.after,s.invoke(s.runlist(r),s,i)}var n,s=this,r=this.traverse(e,t.replace(u,""),this.routes,""),o=this._invoked;return this._invoked=!0,r&&0!==r.length?("forward"===this.recurse&&(r=r.reverse()),n=this.every&&this.every.after?[this.every.after].concat(this.last):[this.last],n&&n.length>0&&o?(this.async?this.invoke(n,this,a):(this.invoke(n,this),a()),!0):(a(),!0)):(this.last=[],"function"==typeof this.notfound&&this.invoke([this.notfound],{method:e,path:t},i),!1)},h.prototype.invoke=function(e,t,a){var s,r=this;this.async?(s=function(i,a){return Array.isArray(i)?n(i,s,a):void("function"==typeof i&&i.apply(t,(e.captures||[]).concat(a)))},n(e,s,function(){a&&a.apply(t,arguments)})):(s=function(a){return Array.isArray(a)?i(a,s):"function"==typeof a?a.apply(t,e.captures||[]):void("string"==typeof a&&r.resource&&r.resource[a].apply(t,e.captures||[]))},i(e,s))},h.prototype.traverse=function(e,t,i,a,n){function s(e){function t(e){for(var i=[],a=0;a<e.length;a++)i[a]=Array.isArray(e[a])?t(e[a]):e[a];return i}function i(e){for(var t=e.length-1;t>=0;t--)Array.isArray(e[t])?(i(e[t]),0===e[t].length&&e.splice(t,1)):n(e[t])||e.splice(t,1)}if(!n)return e;var a=t(e);return a.matched=e.matched,a.captures=e.captures,a.after=e.after.filter(n),i(a),a}var r,o,l,_,c=[];if(t===this.delimiter&&i[e])return _=[[i.before,i[e]].filter(Boolean)],_.after=[i.after].filter(Boolean),_.matched=!0,_.captures=[],s(_);for(var h in i)if(i.hasOwnProperty(h)&&(!this._methods[h]||this._methods[h]&&"object"==typeof i[h]&&!Array.isArray(i[h]))){if(r=o=a+this.delimiter+h,this.strict||(o+="["+this.delimiter+"]?"),l=t.match(RegExp("^"+o)),!l)continue;if(l[0]&&l[0]==t&&i[h][e])return _=[[i[h].before,i[h][e]].filter(Boolean)],_.after=[i[h].after].filter(Boolean),_.matched=!0,_.captures=l.slice(1),this.recurse&&i===this.routes&&(_.push([i.before,i.on].filter(Boolean)),_.after=_.after.concat([i.after].filter(Boolean))),s(_);if(_=this.traverse(e,t,i[h],r),_.matched)return _.length>0&&(c=c.concat(_)),this.recurse&&(c.push([i[h].before,i[h].on].filter(Boolean)),_.after=_.after.concat([i[h].after].filter(Boolean)),i===this.routes&&(c.push([i.before,i.on].filter(Boolean)),_.after=_.after.concat([i.after].filter(Boolean)))),c.matched=!0,c.captures=_.captures,c.after=_.after,s(c)}return!1},h.prototype.insert=function(e,t,i,a){var n,s,r,l,_;if(t=t.filter(function(e){return e&&e.length>0}),a=a||this.routes,_=t.shift(),/\:|\*/.test(_)&&!/\\d|\\w/.test(_)&&(_=o(_,this.params)),t.length>0)return a[_]=a[_]||{},this.insert(e,t,i,a[_]);if(_||t.length||a!==this.routes){if(s=typeof a[_],r=Array.isArray(a[_]),a[_]&&!r&&"object"==s)switch(n=typeof a[_][e]){case"function":return void(a[_][e]=[a[_][e],i]);case"object":return void a[_][e].push(i);case"undefined":return void(a[_][e]=i)}else if("undefined"==s)return l={},l[e]=i,void(a[_]=l);throw Error("Invalid route context: "+s)}switch(n=typeof a[e]){case"function":return void(a[e]=[a[e],i]);case"object":return void a[e].push(i);case"undefined":return void(a[e]=i)}},h.prototype.extend=function(e){function t(e){a._methods[e]=!0,a[e]=function(){var t=1===arguments.length?[e,""]:[e];a.on.apply(a,t.concat(Array.prototype.slice.call(arguments)))}}var i,a=this,n=e.length;for(i=0;n>i;i++)t(e[i])},h.prototype.runlist=function(e){var t=this.every&&this.every.before?[this.every.before].concat(a(e)):a(e);return this.every&&this.every.on&&t.push(this.every.on),t.captures=e.captures,t.source=e.source,t},h.prototype.mount=function(e,t){function i(t,i){var n=t,s=t.split(a.delimiter),r=typeof e[t],o=""===s[0]||!a._methods[s[0]],_=o?"on":n;return o&&(n=n.slice((n.match(RegExp("^"+a.delimiter))||[""])[0].length),s.shift()),o&&"object"===r&&!Array.isArray(e[t])?(i=i.concat(s),void a.mount(e[t],i)):(o&&(i=i.concat(n.split(a.delimiter)),i=l(i,a.delimiter)),void a.insert(_,i,e[t]))}if(e&&"object"==typeof e&&!Array.isArray(e)){var a=this;t=t||[],Array.isArray(t)||(t=t.split(a.delimiter));for(var n in e)e.hasOwnProperty(n)&&i(n,t.slice(0))}}}("object"==typeof exports?exports:window),function(e){var t={schema:null,Environment:null,DOM:null,Element:null,String:null,Array:null,Object:null,Date:null,CAPABILITY_NAMES:null,KNOWN_EXCEPTIONS:null,_descriptor_to_type:{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object","[object Error]":"error","[object Null]":"null","[object Undefined]":"undefined"},KEY_CODES:{ENTER:13,ESCAPE:27,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40},init:function(){"undefined"!=typeof window&&("id"in window.document||t.t("MooTools isn't loaded"),this.Environment&&this.Environment.init(),this.DOM&&this.DOM.init(),this.Element&&this.Element.init())},getType:function(e){var t="null";return null!==e&&(t=typeof e,("object"==t||"function"==t)&&(t=this._descriptor_to_type[this.toString.call(e)]||"object")),t},getElementById:function(e){return document.getElementById(e)},extend:function(e,t){for(var i in t)e[i]=t[i]},implement:function(e,t){for(var i in t)i in e||(e[i]=t[i])},selectElements:function(e){return Slick.search(window.document,e,[])},getElementsByTagName:function(e){return document.getElementsByTagName(e)},clone:function(e){switch(this.getType(e)){case"array":return this.Array.clone(e);case"object":return this.Object.clone(e);default:return e}},t:function(e){if("number"==typeof e&&this.KNOWN_EXCEPTIONS&&e in this.KNOWN_EXCEPTIONS)throw Error(this.KNOWN_EXCEPTIONS[e]);throw Error(e||"Debug assertion failed")},"true":function(){return!0},"false":function(){return!1}};t.schema={dom:{PREFER_RANGE_API:!1},DEBUG:!0},t.KNOWN_EXCEPTIONS={1:"Firestorm: framework requires initialization"},t.CAPABILITY_NAMES={SUPPORTS_RANGE:0,STRIPS_INNER_HTML_SCRIPT_AND_STYLE_TAGS:1,MOVES_WHITESPACE_BEFORE_SCRIPT:2,NEEDS_INPUT_EVENT_SHIM:3},t.Environment={browser_name:null,browser_version:null,platform:null,capabilities:[],tests:[function(e){return"createRange"in e&&"undefined"!=typeof Range&&Range.prototype.createContextualFragment},function(e,t){return t.innerHTML="<div></div>",t.firstChild.innerHTML="<script></script>",""===t.firstChild.innerHTML},function(e,t){return t.innerHTML="Test: <script type='text/x-placeholder'></script>Value","Test:"===t.childNodes[0].nodeValue&&" Value"===t.childNodes[2].nodeValue},function(e){return"documentMode"in e&&e.documentMode<10}],requestAnimationFrame:function(){t.t(1)},init:function(){var e,t=window.document,i=t.createElement("div"),a=this.tests,n=0,s=a.length;for(this.browser_name=Browser.name,this.browser_version=Browser.version,this.platform=Browser.platform,e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,this.requestAnimationFrame=e?function(t){e.call(window,t)}:null;s>n;n++)this.capabilities[n]=a[n](t,i)}},t.Element={init:function(){document.createElement("div").classList?(this.hasClass=this.hasClass_ClassList,this.addClass=this.addClass_ClassList,this.removeClass=this.removeClass_ClassList):(this.hasClass=this.hasClass_Old,this.addClass=this.addClass_Old,this.removeClass=this.removeClass_Old)},addListener:function(e,t,i,a){document.id(e).addEvent(t,i,a)},removeListener:function(e,t,i){document.id(e).removeEvent(t,i)},addDelegation:function(e,t,i,a){document.id(e).addEvent(t+":relay("+i+")",a)},removeDelegation:function(e,t,i,a){document.id(e).removeEvent(t+":relay("+i+")",a)},destroy:function(e){document.id(e).destroy()},remove:function(e){e.parentNode&&e.parentNode.removeChild(e)},_findChildById:function(e,t){var i,a,n,s=null;for(a=0,i=e.childNodes.length;i>a;a++)if(n=e.childNodes[a],1==n.nodeType){if(n.getAttribute("id")===t){s=n;break}if(s=this.findChildById(n,t))break}return s},findChildById:function(e,t){return e.getAttribute("id")===t?e:this._findChildById(e,t)},insertElement:function(e,t,i){this["insertElement"+i](e,t)},insertElementTop:function(e,t){e.insertBefore(t,e.firstChild)},insertElementBottom:function(e,t){e.appendChild(t)},insertElementBefore:function(e,t){e.parentNode.insertBefore(t,e)},insertElementAfter:function(e,t){e.parentNode.insertBefore(t,e.nextSibling)},selectElements:function(e,t){return Slick.search(e,t,[])},setClass:function(e,t){"className"in e?e.className=t||"":e.setAttribute("class",t)},getClass:function(e){return"className"in e?e.className||null:e.getAttribute("class")},hasClass:function(){t.t(1)},hasClass_Old:function(e,i){return t.String.toClassList(e.className||"").contains(i)},hasClass_ClassList:function(e,t){return e.classList.contains(t)},addClass:function(){t.t(1)},addClass_Old:function(e,i){e.className=t.String.toClassList(i+" "+e.className).join(" ")},addClass_ClassList:function(e,t){e.classList.add(t)},removeClass:function(){t.t(1)},removeClass_Old:function(e,i){var a=t.String.toClassList(e.className||"");t.Array.exclude(a,i),e.className=a.join(" ")},removeClass_ClassList:function(e,t){e.classList.remove(t)},addClasses:function(e,t){for(var i=0,a=t.length;a>i;i++)this.addClass(e,t[i])},removeClasses:function(e,t){for(var i=0,a=t.length;a>i;i++)this.removeClass(e,t[i])}},t.extend(t.Element,{setProperty:function(e,t,i){document.id(e).set(t,i)},getProperty:function(e,t){return document.id(e).get(t)},removeProperty:function(e,t){document.id(e).setProperty(t,null)},hasAttribute:function(e,t){return Slick.hasAttribute(e,t)},getAttribute:function(e,t){return Slick.getAttribute(e,t)},getTagName:function(e){return e.nodeName.toLowerCase()},getOuterHTML:function(e){return e.outerHTML}}),t.extend(t.Element,{getSize:function(e){return t.schema.DEBUG&&-1!=["body","html"].indexOf(e.nodeName.toLowerCase())&&t.t("This method requires an element inside the body tag."),{x:e.offsetWidth,y:e.offsetHeight}}}),t.extend(t.Element,{setStyle:function(e,t,i){document.id(e).setStyle(t,i)},setPixels:function(e,i,a){for(var n="",s=0,r=a.length;r>s;s++)t.schema.DEBUG&&"number"!=typeof a[s]&&t.t("Invalid argument passed to setPixels"),n+=Math.round(a[s])+"px ";this.setStyle(e,i,n)},getStyle:function(e,t){return document.id(e).getStyle(t)},setOpacity:function(e,t){document.id(e).set("opacity",t)},getOpacity:function(e){return document.id(e).get("opacity")},addClass:function(e,t){document.id(e).addClass(t)},removeClass:function(e,t){document.id(e).removeClass(t)},addClasses:function(e,i){t.schema.DEBUG&&"string"==typeof i&&t.t();for(var a=0,n=i.length;n>a;a++)this.addClass(e,i[a])},removeClasses:function(e,i){t.schema.DEBUG&&"string"==typeof i&&t.t();for(var a=0,n=i.length;n>a;a++)this.removeClass(e,i[a])}}),t.DOM={_wrap_map:{select:[1,"<select multiple='multiple'>","</select>"],fieldset:[1,"<fieldset>","</fieldset>"],table:[1,"<table>","</table>"],tbody:[2,"<table><tbody>","</tbody></table>"],thead:[2,"<table><tbody>","</tbody></table>"],tfoot:[2,"<table><tbody>","</tbody></table>"],tr:[3,"<table><tbody><tr>","</tr></tbody></table>"],colgroup:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],map:[1,"<map>","</map>"]},_needs_shy:!1,_moves_whitespace:!1,init:function(){var e=t.Environment;this._needs_shy=e.capabilities[t.CAPABILITY_NAMES.STRIPS_INNER_HTML_SCRIPT_AND_STYLE_TAGS],this._moves_whitespace=e.capabilities[t.CAPABILITY_NAMES.MOVES_WHITESPACE_BEFORE_SCRIPT],t.schema.dom.PREFER_RANGE_API&&e.capabilities[t.CAPABILITY_NAMES.SUPPORTS_RANGE]?(this.insertHTMLBefore=this.insertHTMLBefore_Range,this.insertHTMLAfter=this.insertHTMLAfter_Range,this.insertHTMLTop=this.insertHTMLTop_Range,this.insertHTMLBottom=this.insertHTMLBottom_Range,this.clearOuterRange=this.clearOuterRange_Range,this.clearInnerRange=this.clearInnerRange_Range,this.replaceInnerRange=this.replaceInnerRange_Range,this.moveRegionAfter=this.moveRegionAfter_Range,this.moveRegionBefore=this.moveRegionBefore_Range):(this.insertHTMLBefore=this.insertHTMLBefore_Nodes,this.insertHTMLAfter=this.insertHTMLAfter_Nodes,this.insertHTMLTop=this.insertHTMLTop_Nodes,this.insertHTMLBottom=this.insertHTMLBottom_Nodes,this.clearOuterRange=this.clearOuterRange_Nodes,this.clearInnerRange=this.clearInnerRange_Nodes,this.replaceInnerRange=this.replaceInnerRange_Nodes,this.moveRegionAfter=this.moveRegionAfter_Nodes,this.moveRegionBefore=this.moveRegionBefore_Nodes)},insertHTMLBefore:function(){t.t(1)},insertHTMLAfter:function(){t.t(1)},insertHTMLTop:function(){t.t(1)},insertHTMLBottom:function(){t.t(1)},clearOuterRange:function(){t.t(1)},clearInnerRange:function(){t.t(1)},replaceInnerRange:function(){t.t(1)},moveRegionBefore:function(){t.t(1)},moveRegionAfter:function(){t.t(1)},insertHTML:function(e,t,i){this["insertHTML"+(i||"Bottom")](e,t)},_setInnerHTML:function(e,i){var a,n,s,r;if(this._moves_whitespace&&(a=[],i=i.replace(/(\s+)(<script id='([^']+)')/g,function(e,t,i,n){return a.push([n,t]),i})),e.innerHTML=i,a&&a.length>0)for(n=a.length,s=0;n>s;s++)r=t.Element.findChildById(e,a[s][0]),r.parentNode.insertBefore(document.createTextNode(a[s][1]),r)},_firstNodeFor:function(e,t){var i,a,n,s=this._wrap_map[e.nodeName.toLowerCase()]||[0,"",""],r=s[0],o=s[1],l=s[2];for(this._needs_shy&&(t="&shy;"+t),i=document.createElement("div"),this._setInnerHTML(i,o+t+l),a=0;r>=a;a++)i=i.firstChild;if(this._needs_shy){for(n=i;1===n.nodeType&&!n.nodeName;)n=n.firstChild;3===n.nodeType&&"Â­"===n.nodeValue.charAt(0)&&(n.nodeValue=n.nodeValue.slice(1))}return i},clearInnerRange_Nodes:function(e,t){for(var i=e.parentNode,a=e.nextSibling;a&&a!==t;)i.removeChild(a),a=e.nextSibling},clearOuterRange_Nodes:function(e,t){this.clearInnerRange_Nodes(e,t),e.parentNode.removeChild(e),t.parentNode.removeChild(t)},replaceInnerRange_Nodes:function(e,t,i){this.clearInnerRange_Nodes(e,t),this.insertHTMLBefore_Nodes(t,i)},_insertHTMLBefore:function(e,t,i){var a,n;for(a=this._firstNodeFor(e,t);a;)n=a.nextSibling,e.insertBefore(a,i),a=n},insertHTMLAfter_Nodes:function(e,t){this._insertHTMLBefore(e.parentNode,t,e.nextSibling)},insertHTMLBefore_Nodes:function(e,t){this._insertHTMLBefore(e.parentNode,t,e)},insertHTMLTop_Nodes:function(e,t){this._insertHTMLBefore(e,t,e.firstChild)},insertHTMLBottom_Nodes:function(e,t){this._insertHTMLBefore(e,t,null)},_moveRegionBefore:function(e,t,i,a){for(var n;i&&i!==a;)n=i.nextSibling,e.insertBefore(i,t),i=n;e.insertBefore(a,t)},moveRegionBefore_Nodes:function(e,t,i){this._moveRegionBefore(e.parentNode,e,t,i)},moveRegionAfter_Nodes:function(e,t,i){this._moveRegionBefore(e.parentNode,e.nextSibling,t,i)},_createInnerRange:function(e,t){var i=document.createRange();return i.setStartAfter(e),i.setEndBefore(t),i},_createOuterRange:function(e,t){var i=document.createRange();return i.setStartBefore(e),i.setEndAfter(t),i},replaceInnerRange_Range:function(e,t,i){var a=this._createInnerRange(e,t);a.deleteContents(),a.insertNode(a.createContextualFragment(i))},clearOuterRange_Range:function(e,t){var i=this._createOuterRange(e,t);i.deleteContents()},clearInnerRange_Range:function(e,t){var i=this._createInnerRange(e,t);i.deleteContents()},insertHTMLAfter_Range:function(e,t){var i=document.createRange();i.setStartAfter(e),i.setEndAfter(e),i.insertNode(i.createContextualFragment(t))},insertHTMLBefore_Range:function(e,t){var i=document.createRange();i.setStartBefore(e),i.setEndBefore(e),i.insertNode(i.createContextualFragment(t))},insertHTMLTop_Range:function(e,t){var i=document.createRange();i.setStart(e,0),i.collapse(!0),i.insertNode(i.createContextualFragment(t))},insertHTMLBottom_Range:function(e,t){var i,a=e.lastChild;a?(i=document.createRange(),i.setStartAfter(a),i.collapse(!0),i.insertNode(i.createContextualFragment(t))):this.insertHTMLTop_Range(e,t)},moveRegionBefore_Range:function(e,t,i){e.parentNode.insertBefore(this._createOuterRange(t,i).extractContents(),e)},moveRegionAfter_Range:function(e,t,i){e.parentNode.insertBefore(this._createOuterRange(t,i).extractContents(),e.nextSibling)}},t.Array={swap:function(e,t,i){var a=e[t];e[t]=e[i],e[i]=a},include:function(e,t){return-1==e.indexOf(t)?(e.push(t),!0):!1},includeUnique:function(e,t){for(var i=0,a=t.length;a>i;i++)-1==e.indexOf(t[i])&&e.push(t[i])},exclude:function(e,t){var i=e.indexOf(t);return-1==i?!1:(e.splice(i,1),!0)},excludeAll:function(e,t){for(var i,a=0,n=t.length;n>a;a++)i=e.indexOf(t[a]),-1!=i&&e.splice(i,1)},clone:function(e){for(var i=e.length,a=0,n=Array(i);i>a;a++)n[a]=t.clone(e[a]);return n},replace:function(e,i,a){var n=e.indexOf(i);-1==n&&t.t("Array.replace: value is not in array"),e[n]=a}},t.String={QUOTE_ESCAPE_REGEX:/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,quote_escape_map:{"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},escape_chars:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},unescape_chars:{"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`"},HTML_ESCAPE_REGEX:/[<>\&]/g,ATTRIBUTE_ESCAPE_REGEX:/[&<>\"\'\`]/g,TEXTAREA_ESCAPE_REGEX:/[<>&\'\"]/g,UNESCAPE_REGEX:/(&amp;|&lt;|&gt;)/g,camelCase:function(e){return e.replace(/-\D/g,function(e){return e.charAt(1).toUpperCase()})},hyphenate:function(e){return e.replace(/[A-Z]/g,function(e){return"-"+e.charAt(0).toLowerCase()})},capitalize:function(e){return e.replace(/\b[a-z]/g,function(e){return e.toUpperCase()})},escape:function(e,t){var i=this.escape_chars;return e.replace(t,function(e){return i[e]})},unescape:function(e){var t=this.unescape_chars;return e.replace(this.UNESCAPE_REGEX,function(e){return t[e]})},quote:function(e){var t,i=this.quote_escape_map;return t=this.QUOTE_ESCAPE_REGEX.test(e)?'"'+e.replace(this.QUOTE_ESCAPE_REGEX,function(e){var t=i[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'},escapeStringForRegExp:function(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},repeat:function(e,t){for(var i="";t>1;)1&t&&(i+=e),t>>=1,e+=e;return i+e},toClassList:function(e){var t=e.trim().split(/\s+/),i={};return t.filter(function(e){return i[e]?void 0:i[e]=e})}},t.Object={isEmpty:function(e){for(var t in e)return!1;return!0},clone:function(e){var i,a={};for(i in e)a[i]=t.clone(e[i]);return a},copy:function(e){var i={};return t.extend(i,e),i}},t.Date={DAYS_IN_MONTH:[31,28,31,30,31,30,31,31,30,31,30,31],getDaysInMonth:function(e,t){return 1==t&&(e%4==0&&e%100!=0||e%400==0)?29:this.DAYS_IN_MONTH[t]}},t.init(),"undefined"!=typeof module&&module.exports?module.exports=t:e.Firestorm=t}(this);var Lava={version:[],schema:null,ClassManager:null,ExpressionParser:null,TemplateParser:null,ObjectParser:null,TemplateWalker:null,transitions:null,Cron:null,Core:null,ScopeManager:null,modifiers:null,types:null,extenders:null,resources:null,algorithms:{sorting:{}},animation:{},animator:{},data:{},system:{},mixin:{},parsers:{},view:{},widget:{},scope:{},user:{},app:null,view_manager:null,popover_manager:null,focus_manager:null,serializer:null,locales:{},widgets:{},sugar_map:{},classes:{},TARGET_ARGUMENT_TYPES:{VALUE:1,BIND:2},ELEMENT_ID_PREFIX:"e",SYSTEM_ID_REGEX:/^e?\\d+$/,VALID_PROPERTY_NAME_REGEX:/^[a-zA-Z\_\$][a-zA-Z0-9\_\$]*$/,EMPTY_REGEX:/^\s*$/,VALID_LABEL_REGEX:/^[A-Za-z\_][A-Za-z\_0-9]*$/,DEFAULT_LESS:function(e,t){return t>e},VOID_TAGS:["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],JS_KEYWORDS:["break","case","catch","class","const","continue","debugger","default","delete","do","else","export","extends","false","finally","for","function","if","import","in","instanceof","new","null","protected","return","super","switch","this","throw","true","try","typeof","var","while","with","abstract","boolean","byte","char","decimal","double","enum","final","float","get","implements","int","interface","internal","long","package","private","protected","public","sbyte","set","short","static","uint","ulong","ushort","void","assert","ensure","event","goto","invariant","namespace","native","require","synchronized","throws","transient","use","volatile"],KNOWN_EXCEPTIONS:null,_widget_title_to_sugar_instance:{},_sugar_instances:{},guid:1,init:function(){var e,t,i=0;"undefined"==typeof Firestorm&&Lava.t("init: Firestorm is not loaded"),this.ClassManager.registerRootNamespace("Lava",this),this.ScopeManager.init();for(e in this.classes)this._loadClass(e);for(this.serializer=new Lava.system.Serializer(Lava.schema.default_serializer_config),"undefined"!=typeof window&&(this._initGlobals(),this.ClassManager.registerExistingConstructor("Lava.WidgetConfigExtensionGateway",this.WidgetConfigExtensionGateway),this.ClassManager.registerExistingConstructor("Lava.ClassLocatorGateway",this.ClassLocatorGateway),this.Cron.init()),t=this.schema.SUGAR_CLASSES.length;t>i;i++)this.registerSugar(this.schema.SUGAR_CLASSES[i]);this.define=this.define_Normal,this.init=null},_initGlobals:function(){this._initGlobal(Lava.schema.system.VIEW_MANAGER_CLASS,"view_manager"),this._initGlobal(Lava.schema.system.APP_CLASS,"app"),this._initGlobal(Lava.schema.popover_manager.CLASS,"popover_manager"),this._initGlobal(Lava.schema.focus_manager.CLASS,"focus_manager")},_initGlobal:function(e,t){if(e){var i=this.ClassManager.getConstructor(e);this[t]=new i}},parseOptions:function(serialized_object){return Lava.schema.VALIDATE_OPTIONS&&this.ObjectParser.parse(serialized_object),eval("("+serialized_object+")")},isValidId:function(e){return this.VALID_LABEL_REGEX.test(e)&&!this.SYSTEM_ID_REGEX.test(e)},logError:function(e){if("undefined"==typeof window)throw Error(e);window.console&&window.console.error(e)},logException:function(e){this.logError("string"==typeof e||"number"==typeof e?e+"":e.message)},getWidgetConfig:function(e){!Lava.schema.DEBUG||e in this.widgets||Lava.t("Widget config not found: "+e);var t=this.widgets[e];return t.is_extended||Lava.extenders[t.extender_type](t),t},createWidget:function(e,t,i){var a,n=this.getWidgetConfig(e);return t?(Lava.schema.DEBUG&&t["extends"]&&t["extends"]!=e&&Lava.t("Malformed widget config"),t["extends"]=e,Lava.extenders[t.extender_type||n.extender_type](t)):t=n,a=Lava.ClassManager.getConstructor(t["class"]),Lava.schema.DEBUG&&!a&&Lava.t("Class not found: "+class_name),new a(t,null,null,null,i)},hasWidgetConfig:function(e){return e in this.widgets},excludeDefaultEvents:function(e){for(var t=0,i=e.length,a=[];i>t;t++)-1==Lava.schema.system.DEFAULT_EVENTS.indexOf(e[t])&&a.push(e[t]);return a},t:function(e){if("number"==typeof e&&this.KNOWN_EXCEPTIONS&&e in this.KNOWN_EXCEPTIONS)throw Error(this.KNOWN_EXCEPTIONS[e]);throw Error(e||"Debug assertion failed")},registerSugar:function(e){Lava.schema.DEBUG&&e in this._sugar_instances&&Lava.t("Class is already registered as sugar");var t=this.ClassManager.getConstructor(e);this._sugar_instances[e]=new t},getSugarInstance:function(e){return this._sugar_instances[e]},getWidgetSugarInstance:function(e){var t,i;return e in this._widget_title_to_sugar_instance||(i=this.getWidgetConfig(e),"sugar"in i||Lava.t("Widget "+e+" does not have sugar in configuration"),t=i.sugar["class"]||Lava.schema.widget.DEFAULT_SUGAR_CLASS,this._widget_title_to_sugar_instance[e]=this._sugar_instances[t]),this._widget_title_to_sugar_instance[e]},storeWidgetSchema:function(e,t){!Lava.schema.widget.ALLOW_REDEFINITION&&e in this.widgets&&Lava.t("storeWidgetSchema: widget is already defined: "+e),this.widgets[e]=t,"sugar"in t&&t.sugar.tag_name&&(this.sugar_map[t.sugar.tag_name]={widget_title:e})},bootstrap:function(){this.init&&this.init(),Lava.schema.focus_manager.IS_ENABLED&&this.focus_manager&&this.focus_manager.enable();var e,t,i=document.body,a=Firestorm.Element.getProperty(i,"lava-app"),n=0;if(null!=a)this._elementToWidget(i);else for(e=Firestorm.selectElements('script[type="lava/app"],lava-app'),t=e.length;t>n;n++)"script"==Firestorm.Element.getTagName(e[n])?this._scriptToWidget(e[n]):this._elementToWidget(e[n]);Lava.schema.popover_manager.IS_ENABLED&&this.popover_manager&&this.popover_manager.enable()},_elementToWidget:function(e){var t,i,a,n,s=Lava.TemplateParser.parseRaw(Firestorm.Element.getOuterHTML(e));return Lava.schema.DEBUG&&1!=s.length&&Lava.t(),i=s[0],a=Lava.parsers.Common.toWidget(i),a.is_extended=!0,a["class"]=i.attributes["lava-app"],i.attributes.id&&Firestorm.Element.removeProperty(e,"id"),n=Lava.ClassManager.getConstructor(a["class"]||"Lava.widget.Standard","Lava.widget"),Lava.schema.DEBUG&&!n&&Lava.t("Class not found: "+a["class"]),t=new n(a),t.injectIntoExistingElement(e),t},_scriptToWidget:function(e){var t,i,a,n=Firestorm.Element.getProperty(e,"id"),s=Firestorm.Element.getProperty(e,"lava-app");return i={type:"widget",is_extended:!0,template:null,container:{type:"Morph"}},i.template=Lava.TemplateParser.parse(Firestorm.Element.getProperty(e,"html"),i),n&&(i.id=n,Firestorm.Element.removeProperty(e,"id")),a=Lava.ClassManager.getConstructor(s||"Lava.widget.Standard","Lava.widget"),Lava.schema.DEBUG&&!a&&Lava.t("Class not found: "+s),t=new a(i),t.inject(e,"After"),Firestorm.Element.destroy(e),t},WidgetConfigExtensionGateway:function(e,t,i,a,n){Lava.extenders[e.extender_type](e),"class_locator"in e&&(e["class"]=Lava.schema.widget.DEFAULT_CLASS_LOCATOR_GATEWAY),Lava.schema.DEBUG&&!e["class"]&&Lava.t("Trying to create a widget without class");var s=Lava.ClassManager.getConstructor(e["class"],"Lava.widget");return Lava.schema.DEBUG&&!s&&Lava.t("Class not found: "+e["class"]),new s(e,t,i,a,n)},ClassLocatorGateway:function(e,t,i,a,n){var s=Lava.view_manager.locateTarget(t,e.class_locator.locator_type,e.class_locator.name);!Lava.schema.DEBUG||s&&s.isWidget||Lava.t("[ClassLocatorGateway] Target is null or not a widget");var r=s.getPackageConstructor(e.real_class);return new r(e,t,i,a,n)},define:function(e,t){this.classes[e]=t},define_Normal:function(e,t){this.ClassManager.define(e,t)},_loadClass:function(e){var t,i=this.classes[e],a=0;if(Lava.schema.DEBUG&&!i&&Lava.t("[Lava::_loadClass] Class does not exists: "+e),"Extends"in i&&(this.ClassManager.hasClass(i.Extends)||this._loadClass(i.Extends)),"Implements"in i)if("string"==typeof i.Implements)this.ClassManager.hasClass(i.Implements)||this._loadClass(i.Implements);else for(t=i.Implements.length;t>a;a++)this.ClassManager.hasClass(i.Implements[a])||this._loadClass(i.Implements[a]);
this.ClassManager.define(e,i)},createCloner:function(e){return Function("return "+this.serializer.serialize(e))},refreshViews:function(){Lava.Core.isProcessingEvent()||Lava.view_manager.isRefreshing()||this.view_manager.refresh()},isVoidTag:function(e){return-1!=this.VOID_TAGS.indexOf(e)},mergeStorageSchema:function(e,t){var i;for(i in t)i in e?(!Lava.schema.DEBUG||e[i].type==t[i].type&&e[i].tag_name==t[i].tag_name||Lava.t("[Config storage_schema] property types must match: "+i),"properties"in t[i]&&("properties"in e[i]?Firestorm.implement(e[i].properties,t[i].properties):e[i].properties=t[i].properties)):e[i]=t[i]},store:function(e,t,i,a){t in e||(e[t]={}),Lava.schema.DEBUG&&i in e[t]&&Lava.t("Duplicate item in storage: "+i),e[t][i]=a},valueToType:function(e,t){return Lava.schema.DEBUG&&!Lava.types[e.type_name].isValidString(t,e)&&Lava.t("Invalid attribute value: "+t),Lava.types[e.type_name].fromSafeString(t,e)},suspendListener:function(e){e.fn=this.noop},resumeListener:function(e){e.fn=e.fn_original},noop:function(){},instanceOf:function(e,t){return-1!=e.Class.hierarchy_paths.indexOf(t)||-1!=e.Class["implements"].indexOf(t)},getFirestorm:function(){return Firestorm},destroy:function(){this.popover_manager&&this.popover_manager.destroy(),this.view_manager&&this.view_manager.destroy(),this.app.destroy(),this.view_manager.destroy()}};Lava.schema={VALIDATE_OPTIONS:!0,VALIDATE_OBJECT_PATHS:!0,DEFAULT_STABLE_SORT_ALGORITHM:"mergeSort",DEFAULT_UNSTABLE_SORT_ALGORITHM:"mergeSort",system:{APP_CLASS:"Lava.system.App",VIEW_MANAGER_CLASS:"Lava.system.ViewManager",DEFAULT_EVENTS:["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","keydown","keypress","keyup","change","focus","blur","input"],ALLOW_REQUEST_ANIMATION_FRAME:!0,REFRESH_INFINITE_LOOP_THRESHOLD:3},default_serializer_config:{},popover_manager:{IS_ENABLED:!0,CLASS:"Lava.system.PopoverManager",HIDE_EMPTY_TOOLTIPS:!0},focus_manager:{IS_ENABLED:!0,CLASS:"Lava.system.FocusManager"},data:{DEFAULT_MODULE_CLASS:"Module",DEFAULT_RECORD_CLASS:"Record",DEFAULT_FIELD_TYPE:"Basic",VALIDATE_IMPORT_DATA:!0},modules:{},view:{VALIDATE_CLASS_NAMES:!0,VALIDATE_STYLES:!0,DEFAULT_CLASS_LOCATOR_GATEWAY:"Lava.ClassLocatorGateway"},parsers:{view_name_to_class_map:{expression:"Expression",foreach:"Foreach","if":"If",view:"View",include:"Include"},PRESERVE_VIEW_NAME:!1,EXPORT_STRINGS:!1},widget:{VALIDATE_PROPERTY_TYPES:!0,DEFAULT_SUGAR_CLASS:"Lava.system.Sugar",ALLOW_REDEFINITION:!1,DEFAULT_EXTENSION_GATEWAY:"Lava.WidgetConfigExtensionGateway",DEFAULT_CLASS_LOCATOR_GATEWAY:"Lava.ClassLocatorGateway",DEFAULT_EXTENDER:"Standard"},SUGAR_CLASSES:["Lava.system.Sugar"],LOCALE:"en",RESOURCES_ENABLED:!0,DEBUG:!0},Lava.modifiers={toLower:function(e){return e?(""+e).toLowerCase():""},ucFirst:function(e){var t="";return e&&(t=""+e,t=t[0].toUpperCase()+t.substr(1)),t},stringFunction:function(e,t){return e?Firestorm.String[t](""+e):""},translateBoolean:function(e){return Lava.schema.DEBUG&&"boolean"!=typeof e&&Lava.t("translateBoolean: argument is not boolean type"),Lava.locales[Lava.schema.LOCALE].booleans[+e]},joinArray:function(e,t){return e?e.join(t):""}},Lava.transitions={linear:function(e){return e},inSine:function(e){return 1-Math.cos(e*Math.PI/2)},outSine:function(e){return Math.sin(e*Math.PI/2)},inOutSine:function(e){return-(Math.cos(Math.PI*e)-1)/2},inQuad:function(e){return e*e},outQuad:function(e){return e*(2-e)},inOutQuad:function(e){return.5>e?2*e*e:1-2*(e-=1)*e},inCubic:function(e){return e*e*e},outCubic:function(e){return(e-=1)*e*e+1},inOutCubic:function(e){return.5>e?4*e*e*e:4*(e-=1)*e*e+1}},Lava.resources={_container_resources_operations_map:{static_properties:"_containerSet",static_styles:"_containerSet",static_classes:"_containerSet",add_properties:"_containerAddObject",add_styles:"_containerAddObject",add_classes:"_containerAddArray",remove_properties:"_containerRemoveObject",remove_styles:"_containerRemoveObject",remove_classes:"_containerRemoveArray"},_container_resources_operands_map:{add_properties:"static_properties",remove_properties:"static_properties",add_styles:"static_styles",remove_styles:"static_styles",add_classes:"static_classes",remove_classes:"static_classes"},exportTranslatableString:function(){},addWidgetResource:function(e,t,i){!Lava.schema.DEBUG||e in Lava.widgets||Lava.t("Widget config not found: "+e);var a=Lava.widgets[e];a.is_extended&&Lava.t("Widget is already extended, can not add resources: "+e),a.resources||(a.resources={}),Lava.schema.DEBUG&&t in a.resources&&Lava.t("Locale is already defined: "+t),a.resources[t]=i},mergeResources:function(e,t){var i,a=Firestorm.Object.copy(e);for(i in t)i in a?(Lava.schema.DEBUG&&a[i].type!=t[i].type&&Lava.t("Resource types mismatch: "+i),"component"==t[i].type?a[i]={type:"component",value:this.mergeResources(a[i].value,t[i].value)}:"container_stack"==t[i].type&&("container_stack"!=a[i].type&&Lava.t(),a[i]={type:"container_stack",value:t[i].value.concat(a[i].value)})):a[i]=t[i];return a},mergeRootContainerStacks:function(e){for(var t in e)"container_stack"==e[t].type&&(e[t]={type:"container",value:this._mergeRootContainerStack(e[t].value)})},_mergeRootContainerStack:function(e){var t,i=0,a=e.length,n={};for(Lava.schema.DEBUG&&!Array.isArray(e)&&Lava.t();a>i;i++)t=e[i],this[this._container_resources_operations_map[t.name]](n,t.name,t.value);return n},_containerSet:function(e,t,i){e[t]=i},_containerAddObject:function(e,t,i){var a=this._container_resources_operands_map[t];a in e?Firestorm.extend(e[a],i):e[a]=i},_containerAddArray:function(e,t,i){var a=this._container_resources_operands_map[t];e[a]=a in e?e[a].concat(i):i},_containerRemoveObject:function(e,t,i){var a,n=this._container_resources_operands_map[t];if(n in e){a=e[n];for(var s in i)delete a[s]}},_containerRemoveArray:function(e,t,i){var a=this._container_resources_operands_map[t];a in e&&Firestorm.Array.excludeAll(e[a],i)},putResourceValue:function(e,t,i){var a,n=t.split("."),s=n.pop(),r=0,o=n.length;for(Lava.schema.DEBUG&&/[a-z]/.test(s)&&Lava.t("Terminal resource names must be uppercase");o>r;r++)a=n[r],Lava.schema.DEBUG&&/[A-Z]/.test(a)&&Lava.t("Resource component names must be lowercase"),a in e?Lava.schema.DEBUG&&"component"!=e[a].type&&Lava.t("Malformed resource definition, path is not component: "+t):e[a]={type:"component",value:{}},e=e[a].value;s in e&&Lava.t("Resource is already defined: "+t),e[s]=i}},Lava.types={AbstractType:{type_name:null,fromString:function(e,t){return this.isValidString(e,t)||Lava.t("Invalid "+this.type_name+" string: "+e),this.fromSafeString(e,t)}},Boolean:{"extends":"AbstractType",_mappings:{"true":!0,1:!0,"false":!1,0:!1},isValidValue:function(e){return"boolean"==typeof e},isValidString:function(e){return e in this._mappings},fromSafeString:function(e){return this._mappings[e]}},String:{"extends":"AbstractType",isValidValue:function(e){return"string"==typeof e},isValidString:function(){return!0},fromSafeString:function(e){return e}},Number:{"extends":"AbstractType",_valid_value_regex:/^(\-|\+)?\d+(\.\d*)?$/,isValidValue:function(e){return"number"==typeof e&&this._valid_value_regex.test(e)},isValidString:function(e){return this._valid_value_regex.test(e)},fromSafeString:function(e){return+e}},Integer:{"extends":"Number",_valid_value_regex:/^(\-|\+)?\d+$/},PositiveInteger:{"extends":"Number",_valid_value_regex:/^\+?[1-9]\d*$/},NonNegativeInteger:{"extends":"Number",_valid_value_regex:/^\+?\d+$/},Percent:{"extends":"Number",_valid_value_regex:/^(0?\.\d+|1\.0+|0|1)$/,isValidValue:function(e){return"number"==typeof e&&e>=0&&1>=e}},Set:{"extends":"AbstractType",isValidValue:function(e,t){return!Lava.schema.DEBUG||t&&"allowed_values"in t||Lava.t("Set type: missing allowed_values in schema"),-1!=t.allowed_values.indexOf(e)},isValidString:function(e,t){return this.isValidValue(e,t)},fromSafeString:function(e){return e}},SwitchAttribute:{"extends":"AbstractType",isValidValue:function(e,t){return""===e||e===t.name},isValidString:function(e,t){return this.isValidValue(e,t)},fromSafeString:function(){return!0}},Map:{"extends":"AbstractType",isValidValue:function(e,t){return!Lava.schema.DEBUG||t&&"value_map"in t||Lava.t("Set type: missing allowed_values in schema"),e in t.value_map},isValidString:function(e,t){return this.isValidValue(e,t)},fromSafeString:function(e,t){return t.value_map[e]}},Array:{"extends":"AbstractType",isValidValue:function(e){return Array.isArray(e)},isValidString:function(){return!1},fromSafeString:function(){Lava.t()}},Date:{"extends":"AbstractType",isValidValue:function(e){return"date"==Firestorm.getType(e)},isValidString:function(){return!1},fromSafeString:function(){Lava.t()}}},function(e){function t(i){var a;"extends"in i&&(a=e[i["extends"]],a.is_extended||t(a),Firestorm.implement(i,a)),i.is_extended=!0}var i;for(i in e)t(e[i]),e[i].type_name=i}(Lava.types),Lava.extenders={_widget_config_merged_properties:{includes:"_mergeIncludes",sugar:"_mergeSugar",storage_schema:"_mergeStorageSchema",bindings:"_mergeConfigProperty",assigns:"_mergeConfigProperty",options:"_mergeConfigProperty",properties:"_mergeConfigProperty"},_sugar_merge_map:{attribute_mappings:!0,content_schema:{tag_roles:!0}},_exceptions:["resources","resources_cache","storage"],_mergeConfigProperty:function(e,t,i){var a,n=e[i],s=t[i];for(a in s)a in n||(n[a]=s[a])},_mergeWithMap:function(e,t,i){var a;for(a in t)a in e?a in i&&(1==i[a]?Firestorm.implement(e[a],t[a]):this._mergeWithMap(e[a],t[a],i[a])):e[a]=t[a]},_mergeSugar:function(e,t,i){this._mergeWithMap(e[i],t[i],this._sugar_merge_map)},_mergeIncludes:function(e,t,i,a){var n,s,r=e[i],o=t[i];for(n in o)n in r?(s=a+"$"+n,Lava.schema.DEBUG&&s in r&&Lava.t(),r[s]=o[n]):r[n]=o[n]},_mergeStorage:function(e,t,i){var a,n=e.storage_schema,s=e[i],r=t[i];for(a in r)a in s?-1!=["template_hash","object_hash","object"].indexOf(n[a].type)&&Firestorm.implement(s[a],r[a]):s[a]=r[a]},_extendResources:function(e,t){var i={};"resources"in e&&(Lava.schema.LOCALE in e.resources&&(i=Lava.resources.mergeResources(i,e.resources[Lava.schema.LOCALE])),"default"in e.resources&&(i=Lava.resources.mergeResources(i,e.resources["default"]))),t&&"resources_cache"in t&&(i=Lava.resources.mergeResources(i,t.resources_cache[Lava.schema.LOCALE])),Firestorm.Object.isEmpty(i)||(e.resources_cache={},e.resources_cache[Lava.schema.LOCALE]=i)},_mergeStorageSchema:function(e,t,i){Lava.mergeStorageSchema(e[i],t[i])},Standard:function(e){var t,i;if("extends"in e){i=e["extends"],t=Lava.getWidgetConfig(i);for(var a in t)-1==this._exceptions.indexOf(a)&&(a in e?a in this._widget_config_merged_properties&&this[this._widget_config_merged_properties[a]](e,t,a,i):e[a]=t[a]);"storage"in t&&("storage"in e?this._mergeStorage(e,t,"storage",i):e.storage=t.storage)}Lava.schema.RESOURCES_ENABLED&&this._extendResources(e,t),e["class"]=!e.real_class||"class_locator"in e?null:Lava.ClassManager.hasConstructor(e.real_class)?e.real_class:"Lava.widget."+e.real_class,e.is_extended=!0}},Lava.Cron={DEFAULT_TIMER_DELAY:20,_timer:null,is_running:!1,_active_tasks:[],init:function(){this._enable=Firestorm.Environment.requestAnimationFrame&&Lava.schema.system.ALLOW_REQUEST_ANIMATION_FRAME?this._enable_AnimationFrame:this._enable_Interval},timeout_callback:function(){var e=Lava.Cron;e.onTimer(),e.is_running||(clearInterval(e._timer),e._timer=null)},animation_frame_callback:function(){var e=Lava.Cron;e.onTimer(),e.is_running&&Firestorm.Environment.requestAnimationFrame(e.animation_frame_callback)},acceptTask:function(e){-1==this._active_tasks.indexOf(e)&&this._active_tasks.push(e),this._enable(),this.is_running||(this._enable(),this.is_running=!0)},_enable:function(){Lava.t("Framework requires initialization")},_enable_AnimationFrame:function(){Firestorm.Environment.requestAnimationFrame(this.animation_frame_callback)},_enable_Interval:function(){this._timer=window.setInterval(this.timeout_callback,this.DEFAULT_TIMER_DELAY)},onTimer:function(){for(var e,t=(new Date).getTime(),i=0,a=this._active_tasks.length,n=[];a>i;i++)e=this._active_tasks[i],e.isRunning()&&(e.onTimer(t),n.push(e));n.length||(this.is_running=!1),this._active_tasks=n}},Lava.Core={_dom_event_support:{focus:{delegation:!0},blur:{delegation:!0},change:{delegation:!0},reset:{delegation:!0},select:{delegation:!0},submit:{delegation:!0},paste:{delegation:!0},input:{delegation:!0}},_event_listeners:{},_event_usage_counters:{},_event_handlers:{},_nested_handlers_count:0,_freeze_protected_events:["mouseover","mouseout","mousemove"],addGlobalHandler:function(e,t,i){var a={event_name:e,fn:t,fn_original:t,context:i};return this._event_usage_counters[e]?(this._event_usage_counters[e]++,this._event_handlers[e].push(a)):(this._event_usage_counters[e]=1,this._event_handlers[e]=[a],this._initEvent(e)),a},removeGlobalHandler:function(e){var t=e.event_name,i=this._event_handlers[t].indexOf(e);Lava.schema.DEBUG&&-1==i&&Lava.t(),this._event_handlers[t].splice(i,1),this._event_usage_counters[t]--,0==this._event_usage_counters[t]&&this._shutdownEvent(t)},_createEventWrapper:function(e){var t=this,i=-1!=this._freeze_protected_events.indexOf(e);return"ie"==Firestorm.Environment.browser_name?function(a){"x"in a.page&&(a.page.x=Math.floor(a.page.x),a.page.y=Math.floor(a.page.y),a.client.x=Math.floor(a.client.x),a.client.y=Math.floor(a.client.y)),t._onDomEvent(e,a,i)}:function(a){t._onDomEvent(e,a,i)}},_initEvent:function(e){this._event_listeners[e]=this._createEventWrapper(e),e in this._dom_event_support&&this._dom_event_support[e].delegation?Firestorm.Element.addDelegation(window,e,"*",this._event_listeners[e]):Firestorm.Element.addListener(window,e,this._event_listeners[e])},_shutdownEvent:function(e){e in this._dom_event_support&&this._dom_event_support[e].delegation?Firestorm.Element.removeDelegation(window,e,"*",this._event_listeners[e]):Firestorm.Element.removeListener(window,e,this._event_listeners[e])},_onDomEvent:function(e,t,i){var a=this._event_handlers[e].slice(),n=0,s=a.length;for(this._nested_handlers_count++;s>n;n++)a[n].fn.call(a[n].context,e,t);this._nested_handlers_count--,0!=this._nested_handlers_count||Lava.view_manager.isRefreshing()||i&&Lava.ScopeManager.hasInfiniteLoop()||Lava.view_manager.refresh()},isProcessingEvent:function(){return this._nested_handlers_count>0}},Lava.ScopeManager={_scope_refresh_queues:[],_min_scope_refresh_level:0,_scope_refresh_current_indices:[],statistics:{max_refresh_cycles:0,count_dead_loop_exceptions:0},_refresh_id:0,_has_exceptions:!1,_has_infinite_loop:!1,_is_refreshing:!1,_lock_count:0,init:function(){this.scheduleScopeRefresh=this.scheduleScopeRefresh_Normal},scheduleScopeRefresh:function(){Lava.t("Framework requires initialization")},scheduleScopeRefresh_Normal:function(e,t){return this._scope_refresh_queues[t]||(this._min_scope_refresh_level>t&&(this._min_scope_refresh_level=t),this._scope_refresh_queues[t]=[]),{index:this._scope_refresh_queues[t].push(e)-1}},scheduleScopeRefresh_Locked:function(e){return e.refresh(this._refresh_id)&&Lava.logError("Scope Manager: infinite loop exception outside of normal refresh cycle"),null},lock:function(){Lava.schema.DEBUG&&this._is_refreshing&&Lava.t(),this.scheduleScopeRefresh=this.scheduleScopeRefresh_Locked,this._lock_count++},unlock:function(){0==this._lock_count&&Lava.t(),this._lock_count--,0==this._lock_count&&(this.scheduleScopeRefresh=this.scheduleScopeRefresh_Normal)},cancelScopeRefresh:function(e,t){Lava.schema.DEBUG&&null==e&&Lava.t(),this._scope_refresh_queues[t][e.index]=null},hasInfiniteLoop:function(){return this._has_infinite_loop},refresh:function(){if(this._is_refreshing)return void Lava.logError("ScopeManager: recursive call to ScopeManager#refresh()");var e=0,t=this._scope_refresh_queues.length;if(0!=t){for(this._is_refreshing=!0,this._has_exceptions=!1,this._refresh_id++;this._min_scope_refresh_level<t&&!(this._min_scope_refresh_level in this._scope_refresh_queues);)this._min_scope_refresh_level++;if(this._min_scope_refresh_level<t)for(;this._scopeRefreshCycle();)e++;this._scopeMalfunctionCycle(),this._has_exceptions?this._scope_refresh_queues=this._preserveScopeRefreshQueues():(Lava.schema.DEBUG&&this.debugVerify(),this._scope_refresh_queues=[]),this._scope_refresh_current_indices=[],this.statistics.max_refresh_cycles<e&&(this.statistics.max_refresh_cycles=e),this._has_infinite_loop=this._has_exceptions,this._is_refreshing=!1}},_scopeRefreshCycle:function(){var e,t=this._min_scope_refresh_level,i=this._scope_refresh_queues[t],a=i.length,n=0;t in this._scope_refresh_current_indices?n=this._scope_refresh_current_indices[t]:this._scope_refresh_current_indices[t]=0;do{for(;a>n;){if(i[n]&&i[n].refresh(this._refresh_id))return this._has_exceptions=!0,this.statistics.count_dead_loop_exceptions++,Lava.logError("Scope Manager: infinite loop exception, interrupting"),!1;if(n++,this._scope_refresh_current_indices[t]=n,this._min_scope_refresh_level<t)return!0}a=i.length}while(a>n);this._scope_refresh_queues[t]=null,this._scope_refresh_current_indices[t]=0,e=this._scope_refresh_queues.length;do if(this._min_scope_refresh_level++,this._scope_refresh_queues[this._min_scope_refresh_level])return!0;while(this._min_scope_refresh_level<e);return!1},_scopeMalfunctionCycle:function(){for(var e,t,i,a=this._min_scope_refresh_level,n=this._scope_refresh_queues.length;n>a;a++)if(a in this._scope_refresh_queues){e=this._scope_refresh_queues[a],i=e.length,a in this._scope_refresh_current_indices?t=this._scope_refresh_current_indices[a]:(this._scope_refresh_current_indices[a]=0,t=0);for(;i>t;)e[t]&&e[t].refresh(this._refresh_id,!0),t++,this._scope_refresh_current_indices[a]=t}},_preserveScopeRefreshQueues:function(){for(var e,t,i,a,n,s=[],r=this._min_scope_refresh_level,o=this._scope_refresh_queues.length;o>r;r++)if(r in this._scope_refresh_queues){for(e=this._scope_refresh_queues[r],t=this._scope_refresh_current_indices[r]||0,i=e.length,a=[];i>t;t++)e[t]&&(n=e[t],n.index=a.push(n)-1);s[r]=a}return s},_debug_all_scopes:[],debugTrackScope:function(e){this._debug_all_scopes.push(e)},debugStopTracking:function(e){var t=this._debug_all_scopes.indexOf(e);-1==t&&Lava.t(),this._debug_all_scopes.splice(t,1)},debugVerify:function(){try{for(var e=0,t=this._debug_all_scopes.length;t>e;e++)this._debug_all_scopes[e].debugAssertClean()}catch(i){Lava.logException(i)}}},Lava.algorithms.sorting.mergeSort=function(){"use strict";function e(e,t,a,n){for(var s=[],r=0,o=0;t>r&&n>o;)i(e[r],a[o])?(s.push(e[r]),r++):(s.push(a[o]),o++);return t>r&&(s=s.concat(e.slice(r))),n>o&&(s=s.concat(a.slice(o))),s}function t(a,n){var s,r;return 2==n?i(a[0],a[1])?a:[a[1],a[0]]:(s=Math.floor(n/2),r=n-s,e(2>s?a.slice(0,s):t(a.slice(0,s),s),s,2>r?a.slice(s):t(a.slice(s),r),r))}var i=null;return function(e,a){var n,s=e.length;return 2>s?n=e:(i=a,n=t(e,s)),n}}(),Lava.TemplateWalker={_handlers_map:{string:"_handleString",view:"_handleView",widget:"_handleWidget",include:"_handleInclude",static_value:"_handleStaticValue",static_eval:"_handleStaticEval",static_tag:"_handleStaticTag"},_visitor:null,_template_stack:[],_index_stack:[],_view_config_stack:[],_has_enter:!1,_has_leave:!1,_has_enter_region:!1,_has_leave_region:!1,walkTemplate:function(e,t){Lava.schema.DEBUG&&this._visitor&&Lava.t(),this._template_stack=[],this._index_stack=[],this._view_config_stack=[],this._visitor=t,this._has_enter=!!this._visitor.enter,this._has_leave=!!this._visitor.leave,this._has_enter_region=!!this._visitor.enterRegion,this._has_leave_region=!!this._visitor.leaveRegion,this._has_enter_region&&this._visitor.enterRegion(this,"root_template");try{this._walkTemplate(e)}catch(i){if("WALKER_STOP"!=i)throw i}this._has_leave_region&&this._visitor.leaveRegion(this,"root_template"),this._visitor=null},interrupt:function(){throw"WALKER_STOP"},getTemplateStack:function(){return this._template_stack.slice()},getIndexStack:function(){return this._index_stack.slice()},getCurrentTemplate:function(){return this._template_stack[this._template_stack.length-1]},getCurrentIndex:function(){return this._index_stack[this._index_stack.length-1]},getViewConfigStack:function(){return this._view_config_stack.slice()},getCurrentViewConfig:function(){return this._view_config_stack[this._view_config_stack.length]},_walkTemplate:function(e){Lava.schema.DEBUG&&!Array.isArray(e)&&Lava.t();var t,i,a=0,n=e.length;for(i=this._template_stack.push(e)-1,this._index_stack.push(0),this._has_enter_region&&this._visitor.enterRegion(this,"template");n>a;a++)this._index_stack[i]=a,t="string"==typeof e[a]?"string":e[a].type,this._has_enter&&this._visitor.enter(this,t,e[a]),this[this._handlers_map[t]](e[a]),this._has_leave&&this._visitor.leave(this,t,e[a]);this._has_leave_region&&this._visitor.leaveRegion(this,"template"),this._template_stack.pop(),this._index_stack.pop()},_handleViewCommon:function(e){var t,i=0;if("template"in e&&(this._has_enter_region&&this._visitor.enterRegion(this,"template"),this._walkTemplate(e.template),this._has_leave_region&&this._visitor.leaveRegion(this,"template")),"else_template"in e&&(this._has_enter_region&&this._visitor.enterRegion(this,"else_template"),this._walkTemplate(e.else_template),this._has_leave_region&&this._visitor.leaveRegion(this,"else_template")),"elseif_templates"in e){for(this._has_enter_region&&this._visitor.enterRegion(this,"elseif_templates"),t=e.elseif_templates.length;t>i;i++)this._walkTemplate(e.elseif_templates[i]);this._has_leave_region&&this._visitor.leaveRegion(this,"elseif_templates")}},_handleView:function(e){this._view_config_stack.push(e),this._visitor.visitView&&this._visitor.visitView(this,e),this._handleViewCommon(e),this._view_config_stack.pop()},_walkStorageObject:function(e,t){var i;this._has_enter_region&&this._visitor.enterRegion(this,"object");for(i in t)"template"==t[i].type&&this._walkTemplate(e[i]);this._has_leave_region&&this._visitor.leaveRegion(this,"object")},_handleWidget:function(e){var t,i,a,n,s,r,o;if(this._view_config_stack.push(e),this._visitor.visitWidget&&this._visitor.visitWidget(this,e),this._handleViewCommon(e),e.includes){this._has_enter_region&&this._visitor.enterRegion(this,"includes");for(t in e.includes)this._walkTemplate(e.includes[t]);this._has_leave_region&&this._visitor.leaveRegion(this,"includes")}if(e.storage){o=Lava.parsers.Storage.getMergedStorageSchema(e);for(t in e.storage){switch(this._has_enter_region&&this._visitor.enterRegion(this,"storage"),r=o[t],i=e.storage[t],r.type){case"template_collection":for(this._has_enter_region&&this._visitor.enterRegion(this,"template_collection"),a=0,n=i.length;n>a;a++)this._walkTemplate(i[a]);this._has_leave_region&&this._visitor.leaveRegion(this,"template_collection");break;case"object_collection":for(this._has_enter_region&&this._visitor.enterRegion(this,"object_collection"),a=0,n=i.length;n>a;a++)this._walkStorageObject(i[a],r.properties);this._has_leave_region&&this._visitor.leaveRegion(this,"object_collection");break;case"template_hash":this._has_enter_region&&this._visitor.enterRegion(this,"template_hash");for(s in i)this._walkTemplate(i[s]);this._has_leave_region&&this._visitor.leaveRegion(this,"template_hash");break;case"object_hash":this._has_enter_region&&this._visitor.enterRegion(this,"object_hash");for(s in i)this._walkStorageObject(i[s],r.properties);this._has_leave_region&&this._visitor.leaveRegion(this,"object_hash");break;case"object":this._walkStorageObject(i,r.properties);break;default:Lava.t()}this._has_leave_region&&this._visitor.leaveRegion(this,"storage")}}this._view_config_stack.pop()},_handleString:function(e){this._visitor.visitString&&this._visitor.visitString(this,e)},_handleInclude:function(e){this._visitor.visitInclude&&this._visitor.visitInclude(this,e)},_handleStaticValue:function(e){this._visitor.visitStaticValue&&this._visitor.visitStaticValue(this,e)},_handleStaticEval:function(e){this._visitor.visitStaticEval&&this._visitor.visitStaticEval(this,e)},_handleStaticTag:function(e){this._visitor.visitStaticTag&&this._visitor.visitStaticTag(this,e)}},Lava.ClassManager={inline_simple_arrays:!0,is_monomorphic:!0,SIMPLE_TYPES:["string","boolean","number","null","undefined"],MEMBER_TYPES:{FUNCTION:0,PRIMITIVE:1,OBJECT:2,STRING:3,REGEXP:4,EMPTY_ARRAY:5,INLINE_ARRAY:6,SLICE_ARRAY:7},_sources:{},constructors:{},_reserved_members:["Extends","Implements","Class","Shared"],_root:{},registerRootNamespace:function(e,t){this._root[e]=t},getClassData:function(e){return this._sources[e]},define:function(e,t){var i,a,n,s,r,o,l,_;if(a={name:e.split(".").pop(),path:e,source_object:t,"extends":null,"implements":[],parent_class_data:null,hierarchy_paths:null,hierarchy_names:null,skeleton:null,references:[],shared:{},constructor:null,own_references_count:0,is_monomorphic:this.is_monomorphic},"Extends"in t){Lava.schema.DEBUG&&"string"!=typeof t.Extends&&Lava.t("Extends: string expected. "+e),a["extends"]=t.Extends,n=this._sources[t.Extends],a.parent_class_data=n,n||Lava.t('[define] Base class not found: "'+t.Extends+'"'),n.skeleton||Lava.t("[define] Parent class was loaded without skeleton, extension is not possible: "+a["extends"]),-1!=n.hierarchy_names.indexOf(a.name)&&Lava.t("[define] Duplicate name in inheritance chain: "+a.name+" / "+e),a.hierarchy_paths=n.hierarchy_paths.slice(),a.hierarchy_paths.push(e),a.hierarchy_names=n.hierarchy_names.slice(),a.hierarchy_names.push(a.name),a.references=n.references.slice(),a.own_references_count-=n.references.length,a["implements"]=n["implements"].slice();for(i in n.shared)l=Array.isArray(n.shared[i]),a.shared[i]=l?n.shared[i].slice():Firestorm.Object.copy(n.shared[i]),i in t&&(Lava.schema.DEBUG&&Array.isArray(t[i])!=l&&Lava.t("Shared members of different types must not override each other (array must not become an object)"),l?a.shared[i]=t[i]:Firestorm.extend(a.shared[i],t[i]))}else a.hierarchy_paths=[e],a.hierarchy_names=[a.name];if("Shared"in t)for(o="string"==typeof t.Shared?[t.Shared]:t.Shared,s=0,r=o.length;r>s;s++)i=o[s],_=Firestorm.getType(t[i]),Lava.schema.DEBUG&&(i in t||Lava.t("Shared member is not in class: "+i),"object"!=_&&"array"!=_&&Lava.t("Shared: class member must be an object or array"),a.parent_class_data&&i in a.parent_class_data.skeleton&&Lava.t("[ClassManager] instance member from parent class may not become shared in descendant: "+i),i in a.shared&&Lava.t("Member is already shared in parent class: "+e+"#"+i)),a.shared[i]=t[i];if(a.skeleton=this._disassemble(a,t,!0),n&&this._extend(a,a.skeleton,n,n.skeleton,!0),a.own_references_count+=a.references.length,"Implements"in t)if("string"==typeof t.Implements)this._implementPath(a,t.Implements);else for(s=0,r=t.Implements.length;r>s;s++)this._implementPath(a,t.Implements[s]);a.constructor=this._buildRealConstructor(a),this._registerClass(a)},_implementPath:function(e,t){var i,a,n=this._sources[t];if(Lava.schema.DEBUG){n||Lava.t('Implements: class not found - "'+t+'"');for(i in n.shared)Lava.t("Implements: unable to use a class with Shared as mixin.");-1!=e["implements"].indexOf(t)&&Lava.t("Implements: class "+e.path+" already implements "+t)}e["implements"].push(t),a=e.references.length,e.references=e.references.concat(n.references),this._extend(e,e.skeleton,n,n.skeleton,!0,a)},_extend:function(e,t,i,a,n,s){var r,o,l,_;for(o in a)if(r=a[o],_=r.type,o in t)if(n&&t[o].type==this.MEMBER_TYPES.FUNCTION^_==this.MEMBER_TYPES.FUNCTION&&Lava.t("Extend: functions in class root are not replaceable with other types ("+o+")"),_==this.MEMBER_TYPES.FUNCTION){if(!n||void 0!==s)continue;l=i.name+"$"+o,l in t&&Lava.t("[ClassManager] Assertion failed, function already exists: "+l),t[l]=r}else _==this.MEMBER_TYPES.OBJECT&&this._extend(e,t[o].skeleton,i,r.skeleton,!1,s);else _==this.MEMBER_TYPES.OBJECT?(t[o]={type:this.MEMBER_TYPES.OBJECT,skeleton:{}},this._extend(e,t[o].skeleton,i,r.skeleton,!1,s)):t[o]=!s||_!=this.MEMBER_TYPES.FUNCTION&&_!=this.MEMBER_TYPES.SLICE_ARRAY&&_!=this.MEMBER_TYPES.REGEXP?r:{type:_,index:r.index+s}},_disassemble:function(e,t,i){var a,n,s,r,o={};for(a in t)if(!i||!(-1!=this._reserved_members.indexOf(a)||a in e.shared)){switch(n=t[a],s=Firestorm.getType(n)){case"null":case"boolean":case"number":r={type:this.MEMBER_TYPES.PRIMITIVE,value:n};break;case"string":r={type:this.MEMBER_TYPES.STRING,value:n};break;case"function":r={type:this.MEMBER_TYPES.FUNCTION,index:e.references.length},e.references.push(n);break;case"regexp":r={type:this.MEMBER_TYPES.REGEXP,index:e.references.length},e.references.push(n);break;case"object":r={type:this.MEMBER_TYPES.OBJECT,skeleton:this._disassemble(e,n,!1)};break;case"array":0==n.length?r={type:this.MEMBER_TYPES.EMPTY_ARRAY}:this.inline_simple_arrays&&this.isInlineArray(n)?r={type:this.MEMBER_TYPES.INLINE_ARRAY,value:n}:(r={type:this.MEMBER_TYPES.SLICE_ARRAY,index:e.references.length},e.references.push(n));break;case"undefined":Lava.t("[ClassManager] Forced code style restriction: please, replace undefined member values with null. Member name: "+a);break;default:Lava.t("[ClassManager] Unsupported property type in source object: "+s)}o[a]=r}return o},_buildRealConstructor:function(e){var t,i,a,n,s,r={},o=e.skeleton,l=[],_=!1,c=e.is_monomorphic;for(i in o){switch(o[i].type){case this.MEMBER_TYPES.STRING:c?t=Firestorm.String.quote(o[i].value):r[i]=o[i].value;break;case this.MEMBER_TYPES.PRIMITIVE:c?t=o[i].value+"":r[i]=o[i].value;break;case this.MEMBER_TYPES.EMPTY_ARRAY:t="[]";break;case this.MEMBER_TYPES.INLINE_ARRAY:t=this._serializeInlineArray(o[i].value);break;case this.MEMBER_TYPES.REGEXP:case this.MEMBER_TYPES.FUNCTION:r[i]=e.references[o[i].index];break;case this.MEMBER_TYPES.SLICE_ARRAY:t="r["+o[i].index+"].slice()",_=!0;break;case this.MEMBER_TYPES.OBJECT:s=[],this._serializeSkeleton(o[i].skeleton,e,"	",s)&&(_=!0),t=s.length?"{\n	"+s.join(",\n	")+"\n}":"{}";break;default:Lava.t("[_buildRealConstructor] unknown property descriptor type: "+o[i].type)}t&&(l.push(Lava.VALID_PROPERTY_NAME_REGEX.test(i)?"this."+i+" = "+t:"this["+Firestorm.String.quote(i)+"] = "+t),t=null)}for(i in e.shared)r[i]=e.shared[i];return r.Class=e,a=(_?"var r=this.Class.references;\n":"")+l.join(";\n")+";",e.skeleton.init&&(a+="\nthis.init.apply(this, arguments);"),n=Function(a),Firestorm.extend(n.prototype,r),n},_serializeSkeleton:function(e,t,i,a){var n,s,r,o=!1;for(n in e){switch(e[n].type){case this.MEMBER_TYPES.STRING:s=Firestorm.String.quote(e[n].value);break;case this.MEMBER_TYPES.PRIMITIVE:s=e[n].value+"";break;case this.MEMBER_TYPES.REGEXP:case this.MEMBER_TYPES.FUNCTION:s="r["+e[n].index+"]",o=!0;break;case this.MEMBER_TYPES.EMPTY_ARRAY:s="[]";break;case this.MEMBER_TYPES.INLINE_ARRAY:s=this._serializeInlineArray(e[n].value);break;case this.MEMBER_TYPES.SLICE_ARRAY:s="r["+e[n].index+"].slice()",o=!0;break;case this.MEMBER_TYPES.OBJECT:r=[],this._serializeSkeleton(e[n].skeleton,t,i+"	",r)&&(o=!0),s=r.length?"{\n	"+i+r.join(",\n	"+i)+"\n"+i+"}":"{}";break;default:Lava.t("[_serializeSkeleton] unknown property descriptor type: "+e[n].type)}a.push(Lava.VALID_PROPERTY_NAME_REGEX.test(n)&&-1==Lava.JS_KEYWORDS.indexOf(n)?n+": "+s:Firestorm.String.quote(n)+": "+s)}return o},_getNamespace:function(e){var t,i,a=e.length,n=1;a||Lava.t("ClassManager: class names must include a namespace, even for global classes."),e[0]in this._root||Lava.t("[ClassManager] namespace is not registered: "+e[0]),t=this._root[e[0]];for(;a>n;n++)i=e[n],i in t||(t[i]={}),t=t[i];return t},getConstructor:function(e,t){return e in this.constructors||!t||(e=t+"."+e),this.constructors[e]},isInlineArray:function(e){for(var t=!0,i=0,a=e.length;a>i;i++)if(-1==this.SIMPLE_TYPES.indexOf(Firestorm.getType(e[i]))){t=!1;break}return t},_serializeInlineArray:function(e){for(var t,i,a=[],n=0,s=e.length;s>n;n++){switch(t=Firestorm.getType(e[n])){case"string":i=Firestorm.String.quote(e[n]);break;case"null":case"undefined":case"boolean":case"number":i=e[n]+"";break;default:Lava.t()}a.push(i)}return"["+a.join(", ")+"]"},registerExistingConstructor:function(e,t){e in this._sources&&Lava.t('Class "'+e+'" is already defined'),this.constructors[e]=t},hasConstructor:function(e){return e in this.constructors
},hasClass:function(e){return e in this._sources},_getPrototypeGenerator:function(e){var t,i,a=e.skeleton,n=[],s=!e.is_monomorphic;for(t in a){switch(a[t].type){case this.MEMBER_TYPES.REGEXP:case this.MEMBER_TYPES.FUNCTION:i="r["+a[t].index+"]";break;case this.MEMBER_TYPES.STRING:s&&(i='"'+a[t].value.replace(/\"/g,'\\"')+'"');break;case this.MEMBER_TYPES.PRIMITIVE:s&&(i=a[t].value+"")}i&&(n.push(Lava.VALID_PROPERTY_NAME_REGEX.test(t)?"p."+t+" = "+i+";":"p["+Firestorm.String.quote(t)+"] = "+i+";"),i=null)}for(t in e.shared)n.push("p."+t+" = s."+t+";");return n.length?Function("cd,p","	var r=cd.references,\n		s=cd.shared;\n\n	"+n.join("\n	")+"\n"):null},exportClass:function(e){var t,i,a,n=this._sources[e],s={},r=this._getPrototypeGenerator(n);for(t in n.shared)t in n.source_object&&(s[t]=n.source_object[t]);return i={path:n.path,"extends":n["extends"],"implements":null,references:n.references,constructor:this.constructors[e],skeleton:n.skeleton,source_object:n.source_object},r&&(i.prototype_generator=r),Firestorm.Object.isEmpty(s)||(i.shared=s),n.parent_class_data?(i.own_references=n.references.slice(n.parent_class_data.references.length,n.parent_class_data.references.length+n.own_references_count),a=n["implements"].slice(n.parent_class_data["implements"].length)):(i.own_references=n.references.slice(0,n.own_references_count),a=n["implements"]),a.length&&(i["implements"]=a),i},loadClass:function(e){var t,i,a,n,s,r=0;if(e.shared||(e.shared={}),e["implements"]||(e["implements"]=[]),s=e["implements"],a=e.shared,e.name=e.path.split(".").pop(),e["extends"]){t=this._sources[e["extends"]],Lava.schema.DEBUG&&!t&&Lava.t("[loadClass] class parent does not exists: "+e["extends"]),e.parent_class_data=t;for(i in t.shared)i in a?Array.isArray(a[i])||Firestorm.implement(a[i],t.shared[i]):a[i]=Array.isArray(t.shared[i])?t.shared[i].slice():Firestorm.Object.copy(t.shared[i]);e["implements"]=t["implements"].concat(e["implements"]),e.hierarchy_names=t.hierarchy_names.slice(),e.hierarchy_names.push(e.name),e.hierarchy_paths=t.hierarchy_paths.slice(),e.hierarchy_paths.push(e.path)}else e.hierarchy_names=[e.name],e.hierarchy_paths=[e.path],e.parent_class_data=null;if(e.own_references)for(e.references=t?t.references.concat(e.own_references):e.own_references,n=s.length;n>r;r++)e.references=e.references.concat(this._sources[s[r]].references);e.prototype_generator&&(e.prototype_generator(e,e.constructor.prototype),e.constructor.prototype.Class=e),this._registerClass(e)},loadClasses:function(e){for(var t=0,i=e.length;i>t;t++)this.loadClass(e[t])},loadSkeletons:function(e){for(var t in e)this._sources[t].skeleton=e[t]},_registerClass:function(e){var t,i,a,n=e.path;(n in this._sources||n in this.constructors)&&Lava.t("Class is already defined: "+n),this._sources[n]=e,e.constructor&&(t=n.split("."),i=t.pop(),a=this._getNamespace(t),i in a&&null!=a[i]&&Lava.t("Class name conflict: '"+n+"' property is already defined in namespace path"),this.constructors[n]=e.constructor,a[i]=e.constructor)},getPackageConstructor:function(e,t){!Lava.schema.DEBUG||e in this._sources||Lava.t("[getPackageConstructor] Class not found: "+e);var i,a=this._sources[e],n=null;do{if(i=a.path+t,i in this.constructors){n=this.constructors[i];break}a=a.parent_class_data}while(a);return n},getClassNames:function(){return Object.keys(this._sources)},patch:function(e,t,i,a){var n,s=e.Class,r=s.constructor.prototype,o=s.hierarchy_names,l=o.indexOf(t),_=o.length;for(Lava.schema.DEBUG&&-1==l&&Lava.t();_>l;l++)if(n=o[l]+"$"+i,r[n]){i=n;break}return r[i]=r[a],r[a]=null,i}},Lava.parsers.Common={UNQUOTE_ESCAPE_REGEX:/[\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,_allowed_hash_options:["id","label","escape_off","as","own_enumerable_mode","depends"],_allowed_control_attributes:["event","bind","style","classes","container_class","type","options","label","roles","resource_id","widget"],_reserved_labels:["parent","widget","this","root"],locator_types:{"#":"Id","@":"Label",$:"Name"},_locator_regex:/^[\$\#\@]([a-zA-Z\_][a-zA-Z0-9\_]*)\.([a-zA-Z\_][\$a-zA-Z0-9\_]*)/,_identifier_regex:/^[a-zA-Z\_][\$a-zA-Z0-9\_]*/,_view_config_property_setters:{id:"setViewConfigId",label:"setViewConfigLabel",own_enumerable_mode:"_setOwnEnumerableMode",depends:"_setDepends"},_compile_handlers:{string:"_compileString",include:"_compileInclude",expression:"_compileExpression",directive:"_compileDirective",block:"_compileBlock",tag:"_compileTag",view:"_compileView",container:"_compileContainer","static":"_compileStaticContainer",widget:"_compileWidget",sugar:"_compileSugar"},isLiteral:function(e){return-1!==["true","false","null","undefined"].indexOf(e.toLowerCase())},_viewNameToClass:function(e){return Lava.schema.parsers.view_name_to_class_map[e]||e},_parseViewHash:function(e,t){for(var i in t)Lava.schema.DEBUG&&-1==this._allowed_hash_options.indexOf(i)&&Lava.t("Hash option is not supported: "+i),i in this._view_config_property_setters?this[this._view_config_property_setters[i]](e,t[i]):e[i]=t[i]},setViewConfigId:function(e,t){Lava.schema.DEBUG&&!Lava.isValidId(t)&&Lava.t(),e.id=t},setViewConfigLabel:function(e,t){Lava.schema.DEBUG&&!Lava.VALID_LABEL_REGEX.test(t)&&Lava.t("Malformed view label"),Lava.schema.DEBUG&&-1!=this._reserved_labels.indexOf(t)&&Lava.t("Label name is reserved: "+t),e.label=t},_setOwnEnumerableMode:function(e,t){Lava.schema.DEBUG&&-1==["Enumerable","DataView"].indexOf(t)&&Lava.t("Malformed 'own_enumerable_mode' hash option"),"scope"in e?(Lava.schema.DEBUG&&"own_enumerable_mode"in e.scope&&Lava.t(),e.scope.own_enumerable_mode=t):e.scope={own_enumerable_mode:t}},_setDepends:function(e,t){var i=[],a=Lava.ExpressionParser.parseRaw(t,Lava.ExpressionParser.SEPARATORS.SEMICOLON),n=0,s=a.length;for(Lava.schema.DEBUG&&0==s&&Lava.t("malformed 'depends' hash option");s>n;n++)!Lava.schema.DEBUG||a[n].flags&&a[n].flags.isScopeEval||Lava.t('malformed "depends" hash option: argument '),i.push(a[n].binds[0]);"scope"in e?(Lava.schema.DEBUG&&"depends"in e.scope&&Lava.t(),e.scope.depends=i):e.scope={depends:i}},_compileDirective:function(e,t,i){var a=Lava.parsers.Directives.processDirective(t,i,0==e.length||1==e.length&&"string"==typeof e[0]&&Lava.EMPTY_REGEX.test(e[0]));a&&("string"==typeof a?this._compileString(e,a):e.push(a))},_compileInclude:function(e,t){e.push(t)},_compileString:function(e,t){var i=e.length-1,a="string"==typeof e[i];a?e[i]+=t:e.push(t)},_compileBlock:function(e,t){var i,a={type:"view","class":null},n=0;if(Lava.schema.parsers.PRESERVE_VIEW_NAME&&(a.view_name=t.name),"arguments"in t&&(Lava.schema.DEBUG&&t.arguments.length>1&&Lava.t("Block may have no more than one argument"),t.arguments.length&&(a.argument=t.arguments[0])),"class_locator"in t?(a.class_locator=t.class_locator,a.real_class=t.real_class,a["class"]=Lava.schema.view.DEFAULT_CLASS_LOCATOR_GATEWAY):a["class"]=this._viewNameToClass(t.name),"$"==t.prefix&&(a.container={type:"Morph"}),this._parseViewHash(a,t.hash),a.template="content"in t?this.compileTemplate(t.content,a):[],"else_content"in t&&(a.else_template=this.compileTemplate(t.else_content)),"elseif_arguments"in t)for(a.elseif_arguments=t.elseif_arguments,a.elseif_templates=[],i=t.elseif_content.length;i>n;n++)a.elseif_templates.push(this.compileTemplate(t.elseif_content[n]));e.push(a)},_compileExpression:function(e,t){1!=t.arguments.length&&Lava.t("Expression block requires exactly one argument");var i={type:"view","class":"Expression",argument:t.arguments[0]};"$"==t.prefix&&(i.container={type:"Morph"}),e.push(i)},_compileTag:function(e,t){var i,a,n=Lava.isVoidTag(t.name),s="<"+t.name+this.renderTagAttributes(t.attributes)+(n?"/>":">");this._compileString(e,s),Lava.schema.DEBUG&&n&&t.content&&Lava.t("Void tag with content"),n||(t.content&&(i=this.compileTemplate(t.content),a=i.length,a&&"string"==typeof i[0]&&(this._compileString(e,i.shift()),a--),a&&e.splice.apply(e,[e.length,0].concat(i))),this._compileString(e,"</"+t.name+">"))},_compileView:function(e,t){var i={type:"view","class":"View",container:this._toContainer(t)},a=t.x;this._parseViewAttributes(i,t),"content"in t&&(i.template=this.compileTemplate(t.content,i)),"resource_id"in a&&(Lava.schema.DEBUG&&("static_styles"in i.container||"static_properties"in i.container||"static_styles"in i.container)&&Lava.t("View container with resource_id: all properties must be moved to resources"),i.container.resource_id=Lava.parsers.Common.parseResourceId(a.resource_id)),e.push(i)},_compileContainer:function(e,t){var i,a,n,s,r=t.x,o=null;if(Lava.schema.DEBUG&&(Lava.isVoidTag(t.name)&&Lava.t("Void tag with type='container'"),t.content||Lava.t("Empty container tag"),this._assertControlAttributesValid(r),("options"in r||"roles"in r||"label"in r)&&Lava.t("Please move x:options, x:roles and x:label from container element to the wrapped view")),i=this.asBlocks(t.content),1==i.length?a=this.compileAsView(i):2==i.length?(o=i[0],a=this.compileAsView([i[1]])):Lava.t("Malformed content of tag with type='container'"),Lava.schema.DEBUG&&a.container&&Lava.t("Wrapped view already has a container"),n=this._toContainer(t),a.container=n,o&&(!Lava.schema.DEBUG||"directive"==o.type&&"container_config"==o.name||Lava.t("Malformed content of tag with type='container'"),Lava.parsers.Directives.processDirective(o,a,!0)),Lava.schema.DEBUG){if("id"in a&&Lava.t("Please, move the id attribute from inner view's hash to wrapping container: "+a.id),"static_properties"in n&&"property_bindings"in n)for(s in n.property_bindings)s in n.static_properties&&Lava.t("Same property can not be bound and have static value at the same time - it may result in unexpected behaviour");if("static_styles"in n&&"style_bindings"in n)for(s in n.static_styles)s in n.style_bindings&&Lava.t("Same style can not be bound and have static value at the same time - it may result in unexpected behaviour")}"attributes"in t&&"id"in t.attributes&&(a.id=t.attributes.id),"resource_id"in r&&(Lava.schema.DEBUG&&("static_styles"in n||"static_properties"in n||"static_styles"in n)&&Lava.t("Element container with resource_id: all properties must be moved to resources"),n.resource_id=this.parseResourceId(r.resource_id)),e.push(a)},_compileStaticContainer:function(e,t){var i,a;if(Lava.schema.DEBUG){t.x.resource_id||Lava.t("Static container requires resource id");for(i in t.x)-1==["type","resource_id"].indexOf(i)&&Lava.t("Unknown control attribute on static container: "+i)}a={type:"static_tag",resource_id:this.parseResourceId(t.x.resource_id),name:t.name},"attributes"in t&&Lava.t("Static container with resource_id: all attributes must be moved to resources"),t.content&&(a.template=this.compileTemplate(t.content)),e.push(a)},_compileSugar:function(e,t){var i,a,n,s=Lava.sugar_map[t.name];"parse"in s?n=s.parse(t):(i=Lava.getWidgetConfig(s.widget_title),a=Lava.getWidgetSugarInstance(s.widget_title),n=a.parse(i.sugar,t,s.widget_title)),e.push(n)},_compileWidget:function(e,t){var i=this.createDefaultWidgetConfig();i["extends"]=t.x.widget,i.container=this._toContainer(t),this._parseViewAttributes(i,t),Lava.schema.DEBUG&&t.x&&"resource_id"in t.x&&Lava.t("x:widget attribute is not compatible with resource_id attribute"),t.content&&(i.template=this.compileTemplate(t.content,i)),e.push(i)},_parseViewAttributes:function(e,t){var i=t.x;i&&(Lava.schema.DEBUG&&this._assertControlAttributesValid(i),"options"in i&&("object"!=typeof i.options&&Lava.t("Malformed x:options"),e.options=i.options),"label"in i&&this.setViewConfigLabel(e,i.label),"roles"in i&&(e.roles=this.parseTargets(i.roles))),"attributes"in t&&"id"in t.attributes&&this.setViewConfigId(e,t.attributes.id)},_assertControlAttributesValid:function(e){for(var t in e)-1==this._allowed_control_attributes.indexOf(t)&&Lava.t("Unknown option in x: "+t)},_toContainer:function(e){var t={type:"Element",tag_name:e.name};return"attributes"in e&&this._parseContainerStaticAttributes(t,e.attributes),"x"in e&&this._parseContainerControlAttributes(t,e.x),t},_parseContainerControlAttributes:function(e,t){var i,a,n;if("event"in t){"object"!=typeof t.event&&Lava.t("Malformed x:event attribute"),e.events={};for(n in t.event)e.events[n]=Lava.parsers.Common.parseTargets(t.event[n])}if("bind"in t&&("object"!=typeof t.bind&&Lava.t("Malformed x:bind attribute"),e.property_bindings=this._parseBindingsHash(t.bind)),"style"in t&&("object"!=typeof t.style&&Lava.t("Malformed x:style attribute"),e.style_bindings=this._parseBindingsHash(t.style)),"classes"in t){var s=Lava.ExpressionParser.parse(t.classes,Lava.ExpressionParser.SEPARATORS.SEMICOLON),r={};for(i=0,a=s.length;a>i;i++)r[i]=s[i];e.class_bindings=r}"container_class"in t&&(e["class"]=t.container_class)},_parseBindingsHash:function(e){"object"!=typeof e&&Lava.t("Malformed control tag");var t,i,a={};for(t in e)i=Lava.ExpressionParser.parse(e[t]),0==i.length&&Lava.t("Binding: empty expression ("+t+")"),i.length>1&&Lava.t("Binding: malformed expression for '"+t+"'"),a[t]=i[0];return a},parseStyleAttribute:function(e){e=e.trim();var t,i=e.split(/[\;]+/),a={},n=0,s=i.length,r=0;if(e)for(;s>n;n++)i[n]=i[n].trim(),i[n]&&(t=i[n].split(":"),2==t.length?(t[0]=t[0].trim(),t[1]=t[1].trim(),a[t[0]]=t[1],r++):Lava.t("Unable to parse the style attribute"));return r?a:null},_parseContainerStaticAttributes:function(e,t){var i,a,n={};for(i in t)"style"==i?(a=this.parseStyleAttribute(t.style),a&&(e.static_styles=a)):"class"==i?e.static_classes=t["class"].trim().split(/\s+/):"id"==i||(n[i]=t[i]);for(i in n){e.static_properties=n;break}},compileTemplate:function(e,t){for(var i,a,n,s=[],r=0,o=e.length;o>r;r++)i=e[r],a="string"==typeof i?"string":i.type,"tag"==a&&(n=i.x,n?"type"in n?("widget"in n&&Lava.t("Malformed tag: both x:type and x:widget present"),a=n.type,-1==["view","container","static"].indexOf(a)&&Lava.t("Unknown x:type attribute: "+a)):"widget"in n?a="widget":Lava.sugar_map[i.name]?a="sugar":Lava.t("Tag with control attributes and no sugar or type on it: "+i.name):Lava.sugar_map[i.name]&&(a="sugar")),this[this._compile_handlers[a]](s,i,t);return s},compileAsView:function(e){var t=this.asBlocks(this.compileTemplate(e));return 1!=t.length&&Lava.t("Expected: exactly one view, got either several or none."),"view"!=t[0].type&&"widget"!=t[0].type&&Lava.t("Expected: view, got: "+t[0].type),t[0]},asBlocks:function(e){for(var t=0,i=e.length,a=[];i>t;t++)"string"==typeof e[t]?Lava.EMPTY_REGEX.test(e[t])||Lava.t("Text between tags is not allowed in this context. You may want to use a lava-style comment ({* ... *})"):a.push(e[t]);return a},asBlockType:function(e,t){for(var i=this.asBlocks(e),a=0,n=i.length;n>a;a++)i[a].type!=t&&Lava.t("Block type is not permitted in this context. Expected: "+t+", got: "+i[a].type);return i},renderTagAttributes:function(e){var t,i="";for(t in e)i+=" "+t+'="'+Firestorm.String.escape(e[t],Firestorm.String.ATTRIBUTE_ESCAPE_REGEX)+'"';return i},parseTargets:function(e){var t,i,a,n,s,r,o,l={},_=[];for(e=e.trim(),""==e&&Lava.t("Code style: empty targets are not allowed");e.length;){if(t=this._locator_regex.exec(e),t||(i=/^\d+$/.exec(e)),t?(l.locator_type=this.locator_types[e[0]],l.locator=t[1],l.name=t[2]):i?(l.locator_type="Guid",l.locator=+i[0]):(t=this._identifier_regex.exec(e),t||Lava.t("Malformed targets (1): "+e),l.name=t[0]),Lava.schema.DEBUG&&("Id"!=l.locator_type&&"Name"!=l.locator_type||Lava.isValidId(l.locator)?"Label"!=l.locator_type||Lava.VALID_LABEL_REGEX.test(l.locator)||Lava.t("Malformed target label"+l.locator):Lava.t("Malformed id: "+l.locator)),e=e.substr(t[0].length),"("==e[0]){for(")"==e[1]&&Lava.t("Code style: empty target arguments must be removed"),a={input:e.substr(1),tail_length:0},n=Lava.ExpressionParser.parseWithTailRaw(a,Lava.ExpressionParser.SEPARATORS.COMMA),l.arguments=[],s=0,r=n.length;r>s;s++)o=n[s].flags,o.isScopeEval?l.arguments.push({type:Lava.TARGET_ARGUMENT_TYPES.BIND,data:n[s].binds[0]}):o.isLiteral||o.isNumber||o.isString?l.arguments.push({type:Lava.TARGET_ARGUMENT_TYPES.VALUE,data:Function("return "+n[s].evaluator_src).apply({})}):Lava.t("Expressions are not allowed for target callback arguments, only scope paths and static values");e=e.substr(e.length-a.tail_length)}";"==e[0]?e=e.substr(1).trim():e.length&&(e=e.trim(),Lava.schema.DEBUG&&e.length&&(";"==e[0]&&Lava.t("Space between semicolon in targets is not allowed"),Lava.t("Malformed targets (2): "+e))),_.push(l)}return _},parseResourceId:function(e){e=e.trim();var t,i=this._locator_regex.exec(e);return i&&-1==i[2].indexOf("$")||Lava.t("Malformed resource id: "+e),t={locator_type:this.locator_types[e[0]],locator:i[1],name:i[2]}},createDefaultWidgetConfig:function(){return{type:"widget","class":Lava.schema.widget.DEFAULT_EXTENSION_GATEWAY,extender_type:Lava.schema.widget.DEFAULT_EXTENDER}},unquoteString:function(raw_string){var map=Firestorm.String.quote_escape_map,result;try{result=eval("("+raw_string.replace(this.UNQUOTE_ESCAPE_REGEX,function(e){var t=map[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+")")}catch(e){Lava.t("Malformed string: "+raw_string)}return result},toWidget:function(e){var t=this.createDefaultWidgetConfig();return t.container=this._toContainer(e),this._parseViewAttributes(t,e),e.content&&(t.template=this.compileTemplate(e.content,t)),t}},Lava.parsers.Directives={_directives_schema:{define:{view_config_presence:!1},define_resources:{view_config_presence:!1},widget:{},static_value:{},static_eval:{},attach_directives:{},assign:{view_config_presence:!0,is_top_directive:!0},roles:{view_config_presence:!0,is_top_directive:!0},container_config:{view_config_presence:!0,is_top_directive:!0},refresher:{view_config_presence:!0,is_top_directive:!0},option:{view_config_presence:!0,is_top_directive:!0},options:{view_config_presence:!0,is_top_directive:!0},bind:{view_config_presence:!0,is_top_directive:!0},property:{view_config_presence:!0,is_top_directive:!0},properties:{view_config_presence:!0,is_top_directive:!0},property_string:{view_config_presence:!0,is_top_directive:!0},resources:{view_config_presence:!0,is_top_directive:!0},default_events:{view_config_presence:!0,is_top_directive:!0}},_widget_tag_actions:{bind:"_widgetTagBind",assign:"_widgetTagAssign",option:"_widgetTagOption",property:"_widgetTagProperty",options:"_widgetTagOptions",properties:"_widgetTagProperties",roles:"_widgetTagRoles",resources:"_widgetTagResources",default_events:"_widgetTagDefaultEvents",sugar:"_widgetTagSugar",storage:"_widgetTagStorage",storage_schema:"_widgetTagStorageSchema",edit_template:"_widgetTagEditTemplate",include:"_widgetTagInclude"},_resource_tag_actions:{options:"_resourceTagOptions",container:"_resourceTagContainer",string:"_resourceTagString",plural_string:"_resourceTagPluralString"},_known_edit_tasks:{replace_config_option:"_editTaskSetConfigOptions",add_class_binding:"_editTaskAddClassBinding"},WIDGET_DEFINITION_ALLOWED_MAIN_VIEW_MEMBERS:["template","container","class","type"],_current_widget_title:null,_widget_directives_stack:[],processDirective:function(e,t,i){var a=e.name,n=this._directives_schema[a];return n||Lava.t("Unknown directive: "+a),n.view_config_presence&&(t&&!n.view_config_presence&&Lava.t("Directive must not be inside view definition: "+a),!t&&n.view_config_presence&&Lava.t("Directive must be inside view definition: "+a)),n.is_top_directive&&!i&&Lava.t("Directive must be at the top of the block content: "+a),this["_x"+a](e,t)},_importVars:function(e,t,i){for(var a=0,n=i.length;n>a;a++){var s=i[a];s in t&&(e[s]=t[s])}},_widgetTagBind:function(e,t){this._parseBinding(t,e)},_widgetTagAssign:function(e,t){this._parseAssign(t,e)},_widgetTagOption:function(e,t){this._parseOption(t,e,"options")},_widgetTagProperty:function(e,t){this._parseProperty(t,e,"properties")},_widgetTagOptions:function(e,t){this._parseObject(t,"options",e)},_widgetTagStorageSchema:function(e,t){this._parseObject(t,"storage_schema",e)},_widgetTagProperties:function(e,t){this._parseObject(t,"properties",e)},_widgetTagRoles:function(e,t){this._parseRoles(t,e)},_widgetTagSugar:function(e,t){"sugar"in t&&Lava.t("Sugar is already defined"),Lava.schema.DEBUG&&1!=e.content.length&&Lava.t("Malformed option: "+e.attributes.name),t.sugar=Lava.parseOptions(e.content[0])},_widgetTagStorage:function(e,t){Lava.parsers.Storage.parse(t,e.content)},_widgetTagDefaultEvents:function(e,t){this._parseDefaultEvents(e,t)},_widgetTagResources:function(e,t){this._xresources(e,t)},_parseTaskArguments:function(e){for(var t,i,a=Lava.parsers.Common.asBlockType(e,"tag"),n=0,s=a.length,r=[];s>n;n++){switch(a[n].name){case"template":i=a[n].content?Lava.parsers.Common.compileTemplate(a[n].content):[];break;case"expression":!Lava.schema.DEBUG||a[n].content&&1==a[n].content.length||Lava.t("malformed task arguments"),t=Lava.ExpressionParser.parse(a[n].content[0]),Lava.schema.DEBUG&&1!=t.length&&Lava.t("malformed task arguments: multiple expressions"),i=t[0];break;case"options":i=Lava.parseOptions(a[n].content[0]);break;default:Lava.t("edit_template: unknown or malformed task argument")}r.push(i)}return r},_widgetTagEditTemplate:function(raw_tag,widget_config){!Lava.schema.DEBUG||raw_tag.attributes&&raw_tag.attributes.name||Lava.t("Malformed edit_template tag");var tasks=Lava.parsers.Common.asBlockType(raw_tag.content,"tag"),i=0,count=tasks.length,source_widget_config,template,extends_,widget_tag,content_blocks,block_index,block_count,blocks_hash,task_arguments,handler;if(raw_tag.attributes.source_widget)source_widget_config=Lava.widgets[raw_tag.attributes.source_widget],!Lava.schema.DEBUG||source_widget_config&&!source_widget_config.is_extended||Lava.t("edit_template: source widget does not exist or is already extended"),!Lava.schema.DEBUG||source_widget_config.includes&&source_widget_config.includes[raw_tag.attributes.name]||Lava.t("[edit_template] source widget does not have the include: "+raw_tag.attributes.name),template=Firestorm.clone(source_widget_config.includes[raw_tag.attributes.name]);else{if("includes"in widget_config&&widget_config.includes[raw_tag.attributes.name])template=widget_config.includes[raw_tag.attributes.name];else for(widget_tag=this._widget_directives_stack[this._widget_directives_stack.length-1],widget_tag||Lava.t("edit_template: unable to find source template"),extends_=widget_tag.attributes["extends"];;){if(extends_||Lava.t("edit_template: unable to find source template"),source_widget_config=Lava.widgets[extends_],!Lava.schema.DEBUG||source_widget_config&&!source_widget_config.is_extended||Lava.t("edit_template: source widget does not exist or is already extended"),source_widget_config.includes&&source_widget_config.includes[raw_tag.attributes.name]){template=source_widget_config.includes[raw_tag.attributes.name];break}extends_=source_widget_config["extends"]}template||Lava.t(),template=Firestorm.clone(template)}for(;count>i;i++){if(!Lava.schema.DEBUG||tasks[i].attributes&&"task"==tasks[i].name||Lava.t("Malformed edit_template task"),task_arguments=null,blocks_hash=null,tasks[i].content){for(blocks_hash={},content_blocks=Lava.parsers.Common.asBlockType(tasks[i].content,"tag"),block_index=0,block_count=content_blocks.length;block_count>block_index;block_index++)blocks_hash[content_blocks[block_index].name]=content_blocks[block_index];"arguments"in blocks_hash&&(Lava.schema.DEBUG&&!blocks_hash.arguments.content&&Lava.t("edit_template: malformed task arguments"),task_arguments=this._parseTaskArguments(blocks_hash.arguments.content))}switch(tasks[i].attributes.type){case"manual":!Lava.schema.DEBUG||blocks_hash.handler&&blocks_hash.handler.content&&1==blocks_hash.handler.content.length||Lava.t("edit_template: malformed task handler"),handler=eval("("+blocks_hash.handler.content[0]+")"),Lava.schema.DEBUG&&"function"!=typeof handler&&Lava.t("malformed task handler"),handler(template,tasks[i],blocks_hash,task_arguments);break;case"traverse":!Lava.schema.DEBUG||blocks_hash.handler&&blocks_hash.handler.content&&1==blocks_hash.handler.content.length||Lava.t("edit_template: malformed task handler"),handler=eval("("+blocks_hash.handler.content[0]+")"),Lava.schema.DEBUG&&"object"!=typeof handler&&Lava.t("edit_template: wrong handler for traverse task"),handler.arguments=task_arguments,Lava.TemplateWalker.walkTemplate(template,handler);break;case"known":!Lava.schema.DEBUG||tasks[i].attributes.name in this._known_edit_tasks||Lava.t("[edit_template] unknown task: "+tasks[i].attributes.name),this[this._known_edit_tasks[tasks[i].attributes.name]](template,tasks[i],blocks_hash,task_arguments);break;default:Lava.t('edit_template: task requires the "type" attribute')}}Lava.store(widget_config,"includes",raw_tag.attributes.as||raw_tag.attributes.name,template)},_widgetTagInclude:function(e,t){var i=e.content?Lava.parsers.Common.compileTemplate(e.content):[];Lava.store(t,"includes",e.attributes.name,i)},_parseResources:function(e,t){var i,a,n=Lava.parsers.Common.asBlockType(e.content,"tag"),s=0,r=n.length,o={};for(Lava.schema.DEBUG&&0==r&&Lava.t("Empty resources definition");r>s;s++)i=n[s],!Lava.schema.DEBUG||i.attributes&&i.attributes.path||Lava.t("resources, tag is missing attributes: "+i.name),!Lava.schema.DEBUG||i.name in this._resource_tag_actions||Lava.t("resources, unknown tag: "+i.name),a=this[this._resource_tag_actions[i.name]](i),!Lava.schema.parsers.EXPORT_STRINGS||"string"!=a.type&&"plural_string"!=a.type||Lava.resources.exportTranslatableString(a,t,e.attributes.locale,i.attributes.path),Lava.resources.putResourceValue(o,i.attributes.path,a);return o},_resourceTagOptions:function(e){return!Lava.schema.DEBUG||e.content&&1==e.content.length&&""!=e.content[0]||Lava.t("Malformed resources options tag"),{type:"options",value:Lava.parseOptions(e.content[0])}},_resourceTagString:function(e){Lava.schema.DEBUG&&e.content&&1!=e.content.length&&Lava.t("Malformed resources string tag");var t={type:"string",value:e.content?e.content[0].trim():""};return e.attributes.description&&(t.description=e.attributes.description),t},_resourceTagPluralString:function(e){Lava.schema.DEBUG&&!e.content&&Lava.t("Malformed resources plural string tag");var t,i=Lava.parsers.Common.asBlockType(e.content,"tag"),a=0,n=i.length,s=[];for(Lava.schema.DEBUG&&0==n&&Lava.t("Malformed resources plural string definition");n>a;a++)!Lava.schema.DEBUG||"string"==i[a].name&&i[a].content&&i[a].content[0]||Lava.t("Resources, malformed plural string"),s.push(i[a].content[0].trim());return t={type:"plural_string",value:s},e.attributes.description&&(t.description=e.attributes.description),t},_resourceTagContainer:function(e){var t,i,a=e.content?Lava.parsers.Common.asBlockType(e.content,"tag"):[],n=a.length,s={type:"container_stack",value:[]},r=s.value,o={};n&&(Lava.schema.DEBUG&&(n>1&&Lava.t("Malformed resources/container definition"),"static_properties"!=a[0].name&&"add_properties"!=a[0].name&&Lava.t("Malformed resources/container definition"),(!a[0].attributes||a[0].content)&&Lava.t("resources/container: malformed (static/add)_properties tag"),("class"in a[0].attributes||"style"in a[0].attributes)&&Lava.t("resources/container: class and style attributes must be defined separately from properties")),r.push({name:a[0].name,value:a[0].attributes}),o[a[0].name]=!0);for(i in e.attributes){switch(i){case"remove_classes":case"remove_properties":case"remove_styles":Lava.schema.DEBUG&&!e.attributes[i].trim()&&Lava.t("Codestyle: remove the empty remove_* attributes from resources/container tag"),t=e.attributes[i].trim().split(/\s*,\s*/);break;case"add_classes":case"static_classes":Lava.schema.DEBUG&&"add_classes"==i&&!e.attributes[i].trim()&&Lava.t("Codestyle: remove the empty add_classes attribute from resources/container tag"),t=e.attributes[i].trim().split(/\s+/);break;case"add_styles":case"static_styles":Lava.schema.DEBUG&&"add_styles"==i&&!e.attributes[i].trim()&&Lava.t("Codestyle: remove the empty style attribute from resources/container tag"),t=Lava.parsers.Common.parseStyleAttribute(e.attributes[i]);break;case"path":t=null;break;default:Lava.t("Unknown resources/container attribute:"+i)}t&&(r.push({name:i,value:t}),o[i]=!0)}return Lava.schema.DEBUG&&(("static_styles"in o&&("add_styles"in o||"remove_styles"in o)||"static_classes"in o&&("add_classes"in o||"remove_classes"in o)||"static_properties"in o&&("add_properties"in o||"remove_properties"in o))&&Lava.t("resources/container: having add/remove instructions together with 'set' instruction has no sense"),0==r.length&&Lava.t("Empty resources/container definition")),s},_asMainView:function(e){var t,i=Lava.parsers.Common.compileAsView(e.content),a=Lava.parsers.Common.createDefaultWidgetConfig();if(Lava.schema.DEBUG){"View"!=i["class"]&&Lava.t("define: view in <view> must be pure View, not subclass"),"argument"in i&&Lava.t("Widgets do not support arguments");for(t in i)-1==this.WIDGET_DEFINITION_ALLOWED_MAIN_VIEW_MEMBERS.indexOf(t)&&Lava.t("<view>: view has an option, which can not be copied to widget: "+t+". Probably, it must be specified via separate tag")}return this._importVars(a,i,["template","container"]),a},_parseWidgetDefinition:function(e){!Lava.schema.DEBUG||"attributes"in e||Lava.t("Widget definition is missing attributes");var t,i,a,n=e.content?Lava.parsers.Common.asBlockType(e.content,"tag"):[],s={},r=0,o=n.length,l=!1;for(this._widget_directives_stack.push(e),o&&("view"==n[0].name?(s=this._asMainView(n[0]),r=1):"template"==n[0].name&&(s.template=Lava.parsers.Common.compileTemplate(n[0].content),r=1)),e.attributes["extends"]&&(s["extends"]=e.attributes["extends"]);o>r;r++)t=n[r],"storage_schema"==t.name&&l&&Lava.t("Widget definition: `storage_schema` must preceed the `storage` tag"),t.name in this._widget_tag_actions||Lava.t("Unknown tag in widget definition: "+t.name+". Note, that <template> and <view> tags must be on top."),this[this._widget_tag_actions[t.name]](t,s),"storage"==t.name&&(l=!0);return e.attributes.controller&&(a=e.attributes.controller,a[0]in Lava.parsers.Common.locator_types?(r=a.indexOf("/"),Lava.schema.DEBUG&&-1==r&&Lava.t("Malformed class name locator: "+a),i=a.substr(0,r),s.real_class=a.substr(r),s.class_locator={locator_type:Lava.parsers.Common.locator_types[i[0]],name:i.substr(1)},!Lava.schema.DEBUG||s.class_locator.name&&s.class_locator.locator_type||Lava.t("Malformed class name locator: "+a)):s.real_class=e.attributes.controller),e.attributes.label&&Lava.parsers.Common.setViewConfigLabel(s,e.attributes.label),e.attributes.id&&(Lava.schema.DEBUG&&s.id&&Lava.t("[Widget configuration] widget id was already set via main view configuration: "+e.attributes.id),Lava.parsers.Common.setViewConfigId(s,e.attributes.id)),s["class"]||(s["class"]=Lava.schema.widget.DEFAULT_EXTENSION_GATEWAY),s.extender_type||(s.extender_type=Lava.schema.widget.DEFAULT_EXTENDER),this._widget_directives_stack.pop(),s},_xdefine:function(e){Lava.schema.DEBUG&&(e.attributes&&e.attributes.title||Lava.t("define: missing 'title' attribute"),-1!=e.attributes.title.indexOf(" ")&&Lava.t("Widget title must not contain spaces"),"resource_id"in e.attributes&&Lava.t("resource_id is not allowed on define"),this._current_widget_title&&Lava.t("Nested defines are not allowed: "+e.attributes.title)),this._current_widget_title=e.attributes.title;var t=this._parseWidgetDefinition(e);this._current_widget_title=null,t.is_extended=!1,Lava.schema.DEBUG&&"class_locator"in t&&Lava.t("Dynamic class names are allowed only in inline widgets, not in x:define"),Lava.storeWidgetSchema(e.attributes.title,t)},_xwidget:function(e){var t=this._parseWidgetDefinition(e);return Lava.schema.DEBUG&&"sugar"in t&&Lava.t("Inline widgets must not have sugar"),!Lava.schema.DEBUG||t["class"]||t["extends"]||Lava.t("x:define: widget definition is missing either 'controller' or 'extends' attribute"),e.attributes.resource_id&&(t.resource_id=Lava.parsers.Common.parseResourceId(e.attributes.resource_id)),t.type="widget",t},_xassign:function(e,t){this._parseAssign(t,e)},_parseAssign:function(e,t){"assigns"in e||(e.assigns={}),!Lava.schema.DEBUG||"attributes"in t||Lava.t("assign: missing attributes"),!Lava.schema.DEBUG||t.content&&1==t.content.length||Lava.t("Malformed assign"),t.attributes.name in e.assigns&&Lava.t("Duplicate assign: "+t.attributes.name);
var i=Lava.ExpressionParser.parse(t.content[0]);Lava.schema.DEBUG&&1!=i.length&&Lava.t("Expression block requires exactly one argument"),t.attributes.once&&Lava.types.Boolean.fromString(t.attributes.once)&&(i[0].once=!0),e.assigns[t.attributes.name]=i[0]},_xoption:function(e,t){this._parseOption(t,e,"options")},_parseOption:function(e,t,i){!Lava.schema.DEBUG||"attributes"in t||Lava.t("option: missing attributes"),!Lava.schema.DEBUG||t.content&&1==t.content.length||Lava.t("Malformed option: "+t.attributes.name);var a,n=t.attributes.type;n?"targets"==n?a=Lava.parsers.Common.parseTargets(t.content[0]):"expressions"==n?a=Lava.ExpressionParser.parse(t.content[0],Lava.ExpressionParser.SEPARATORS.SEMICOLON):Lava.t("Unknown option type: "+n):a=Lava.parseOptions(t.content[0]),Lava.store(e,i,t.attributes.name,a)},_parseProperty:function(e,t,i){!Lava.schema.DEBUG||"attributes"in t||Lava.t("option: missing attributes"),!Lava.schema.DEBUG||t.content&&1==t.content.length||Lava.t("Malformed option: "+t.attributes.name),Lava.store(e,i,t.attributes.name,Lava.parseOptions(t.content[0]))},_xroles:function(e,t){this._parseRoles(t,e)},_parseRoles:function(e,t){"roles"in e&&Lava.t("Roles are already defined"),!Lava.schema.DEBUG||t.content&&1==t.content.length||Lava.t("Malformed roles tag/directive"),e.roles=Lava.parsers.Common.parseTargets(t.content[0])},_xcontainer_config:function(e,t){!Lava.schema.DEBUG||e.content&&0!=e.content.length||Lava.t("Malformed container_config directive: content is missing"),Lava.schema.DEBUG&&!t.container&&Lava.t("Trying to change container settings for container-less view. Please, change the view opening tag (# => $) or move the directive into wrapping container.");var i,a=t.container,n=Lava.parseOptions(e.content[0]);if(Lava.schema.DEBUG)for(i in n)-1==["type","options"].indexOf(i)&&Lava.t("[_xcontainer_config] setting config property is not allowed: "+i);"type"in n&&(a.type=n.type),"options"in n&&("options"in a||(a.options={}),Firestorm.extend(a.options,n.options))},_xrefresher:function(e,t){Lava.schema.DEBUG&&"widget"==t.type&&Lava.t("Wrong usage of x:refresher directive. May be applied only to views."),Lava.schema.DEBUG&&"refresher"in t&&Lava.t("Refresher is already defined"),!Lava.schema.DEBUG||e.content&&1==e.content.length||Lava.t("Malformed refresher config: no content"),t.refresher=Lava.parseOptions(e.content[0])},_parseBinding:function(e,t){1!=t.content.length&&Lava.t("Malformed binding in widget definition: "+t.attributes.name);var i={property_name:t.attributes.name,path_config:Lava.ExpressionParser.parseScopeEval(t.content[0])};"from_widget"in t.attributes&&(Lava.schema.DEBUG&&-1==["","1","true"].indexOf(t.attributes.from_widget)&&Lava.t("binding: invalid from_widget attribute"),i.from_widget=!0),Lava.store(e,"bindings",t.attributes.name,i)},_xbind:function(e,t){Lava.schema.DEBUG&&"widget"!=t.type&&Lava.t("Binding directive requires a widget"),this._parseBinding(t,e)},_parseObject:function(e,t,i){Lava.schema.DEBUG&&t in e&&Lava.t("Object already exists: "+t+". Ensure, that x:options and x:properties directives appear before x:option and x:property."),!Lava.schema.DEBUG||i.content&&1==i.content.length||Lava.t("Malformed directive or tag for config property: "+t),e[t]=Lava.parseOptions(i.content[0])},_xoptions:function(e,t){this._parseObject(t,"options",e)},_xproperty:function(e,t){Lava.schema.DEBUG&&"widget"!=t.type&&Lava.t("Property directive requires a widget"),this._parseProperty(t,e,"properties")},_xproperties:function(e,t){Lava.schema.DEBUG&&"widget"!=t.type&&Lava.t("Property directive requires a widget"),this._parseObject(t,"properties",e)},_storeDirectiveContent:function(e,t,i){!Lava.schema.DEBUG||"attributes"in t||Lava.t("option: missing attributes"),!Lava.schema.DEBUG||t.content&&1==t.content.length||Lava.t("Malformed property: "+t.attributes.name),Lava.store(e,i,t.attributes.name,t.content[0])},_xproperty_string:function(e,t){Lava.schema.DEBUG&&"widget"!=t.type&&Lava.t("property_string directive requires a widget"),this._storeDirectiveContent(t,e,"properties")},_xoption_string:function(e,t){this._storeDirectiveContent(t,e,"options")},_xdefine_resources:function(e){!Lava.schema.DEBUG||e.attributes&&e.attributes.locale&&e.attributes["for"]||Lava.t("Malformed x:resources definition. 'locale' and 'for' are required"),Lava.resources.addWidgetResource(e.attributes["for"],e.attributes.locale,this._parseResources(e,e.attributes["for"]))},_xresources:function(e,t){!Lava.schema.DEBUG||e.attributes&&e.attributes.locale||Lava.t("Malformed resources definition, missing locale"),t.resources||(t.resources={}),Lava.schema.DEBUG&&e.attributes.locale in t.resources&&Lava.t("Locale is already defined: "+e.attributes.locale),t.resources[e.attributes.locale]=this._parseResources(e,this._current_widget_title)},_xstatic_value:function(e){return!Lava.schema.DEBUG||!e.content&&e.attributes&&e.attributes.resource_id||Lava.t("Malformed static_value directive. Note: content inside directive is not allowed, even if it's blank space."),{type:"static_value",resource_id:Lava.parsers.Common.parseResourceId(e.attributes.resource_id)}},_xstatic_eval:function(e){!Lava.schema.DEBUG||e.content&&1==e.content.length||Lava.t("Malformed static_eval directive. No content.");var t=Lava.ExpressionParser.parse(e.content[0]);return Lava.schema.DEBUG&&0==t.length&&Lava.t("static_eval: malformed argument"),{type:"static_eval",argument:t[0]}},_xattach_directives:function(e){Lava.schema.DEBUG&&!e.content&&Lava.t("empty attach_directives");var t,i,a=Lava.parsers.Common.asBlocks(e.content),n=a[0],s=a.slice(1);if(Lava.schema.DEBUG)for(("tag"!=n.type||n.content||0==s.length)&&Lava.t("Malformed attach_directives"),t=0,i=s.length;i>t;t++)"directive"!=s[t].type&&Lava.t("Malformed attach_directives");return n.content=s,Lava.parsers.Common.compileAsView([n])},_parseDefaultEvents:function(e,t){!Lava.schema.DEBUG||e.content&&e.content.length||Lava.t("default_events: no content."),Lava.schema.DEBUG&&"default_events"in t&&Lava.t("default_events: property already defined");var i,a=Lava.parseOptions(e.content[0]),n=0;if(Lava.schema.DEBUG)for(Array.isArray(a)||Lava.t("default_events: array expected"),i=a.length;i>n;n++)"string"!=typeof a[n]&&Lava.t("default_events: expected an array of strings");t.default_events=Lava.excludeDefaultEvents(a)},_xdefault_events:function(e,t){this._parseDefaultEvents(e,t)},_selectFirst:function(e,t,i){var a,n={},s=null;return a=i?Function("node","return !!("+i+")"):function(){return!0},n["visit"+t]=function(e,t){a(t)&&(s=t,e.interrupt())},Lava.TemplateWalker.walkTemplate(e,n),s},_editTaskSetConfigOptions:function(e,t,i){Lava.schema.DEBUG&&!t.attributes.node_type&&Lava.t("_editTaskSetConfigOptions: malformed attributes");var a,n,s,r,o,l,_=i.assign,c=0;for(!Lava.schema.DEBUG||_&&_.attributes&&_.attributes.path&&_.content&&1==_.content.length||Lava.t("_editTaskSetConfigOptions: malformed or missing assign"),o=this._selectFirst(e,t.attributes.node_type,t.attributes.condition),o||Lava.t("_editTaskSetConfigOptions: target not found"),a=i.assign.attributes.path.split("."),n=a.pop(),s=Lava.parseOptions(i.assign.content[0]),r=a.length;r>c;c++)a[c]in o?Lava.schema.DEBUG&&(l=Firestorm.getType(o[a[c]]),"null"!=l&&"object"!=l&&Lava.t("_editTaskSetConfigOptions: trying to set a path, which is not an object")):o[a[c]]={},o=o[a[c]];o[n]=s},_editTaskAddClassBinding:function(e,t,i,a){Lava.schema.DEBUG&&!t.attributes.node_type&&Lava.t("_editTaskAddClassBinding: malformed attributes");var n,s=0;if(n=this._selectFirst(e,t.attributes.node_type,t.attributes.condition),n&&n.container||Lava.t("_editTaskAddClassBinding: target not found or does not have a container"),n.container.class_bindings){for(;s in n.container.class_bindings;)s++;n.container.class_bindings[s]=a[0]}else n.container.class_bindings={0:a[0]}}},Lava.parsers.Storage={_root_handlers:{template_collection:"_parseTemplateCollection",object_collection:"_parseObjectCollection",template_hash:"_parseTemplateHash",object_hash:"_parseObjectHash",object:"_parseObject"},_object_property_handlers:{template:"_parsePropertyAsTemplate",lava_type:"_parsePropertyAsLavaType"},_object_attributes_handlers:{lava_type:"_parseAttributeAsLavaType"},parse:function(e,t){for(var i,a=this.getMergedStorageSchema(e),n=Lava.parsers.Common.asBlockType(t,"tag"),s=0,r=n.length;r>s;s++)i=a[n[s].name],Lava.schema.DEBUG&&!i&&Lava.t("parsing storage; no schema for "+n[s].name),Lava.store(e,"storage",n[s].name,this[this._root_handlers[i.type]](i,n[s]))},_walkTemplateAsArray:function(e,t,i){for(var a=[],n=Lava.parsers.Common.asBlockType(t,"tag"),s=0,r=n.length;r>s;s++)Lava.schema.DEBUG&&n[s].name!=e.tag_name&&Lava.t("Unknown tag in collection: "+n[s].name),a.push(this[i](e,n[s]));return a},_walkTemplateAsHash:function(e,t,i){for(var a={},n=Lava.parsers.Common.asBlockType(t,"tag"),s=0,r=n.length;r>s;s++)Lava.schema.DEBUG&&(n[s].name!=e.tag_name&&Lava.t("Unknown tag in collection: "+n[s].name),n[s].attributes&&n[s].attributes.name||Lava.t("Storage: hash tag is missing the name attribute"),n[s].attributes.name in a&&Lava.t("Duplicate item name in storage:"+n[s].attributes.name)),a[n[s].attributes.name]=this[i](e,n[s],!0);return a},_asTemplate:function(e,t){return Lava.parsers.Common.compileTemplate(t.content)},_asObject:function(e,t,i){for(var a,n,s=Lava.parsers.Common.asBlockType(t.content,"tag"),r=0,o=s.length,l={};o>r;r++)a=e.properties[s[r].name],Lava.schema.DEBUG&&!a&&Lava.t("Unknown tag in object: "+s[r].name),Lava.schema.DEBUG&&s[r].name in l&&Lava.t("[Storage] duplicate item in object: "+s[r].name),l[s[r].name]=this[this._object_property_handlers[a.type]](a,s[r]);for(n in t.attributes)i&&"name"==n||(a=e.properties[n],!Lava.schema.DEBUG||a&&a.is_attribute||Lava.t("Unknown attribute in object: "+n),Lava.schema.DEBUG&&n in l&&Lava.t("[Storage] duplicate item (attribute) in object: "+n),l[n]=this[this._object_attributes_handlers[a.type]](a,t.attributes[n]));return l},getMergedStorageSchema:function(e){var t,i=e.storage_schema;return!e.is_extended&&e["extends"]&&(t=this.getMergedStorageSchema(Lava.widgets[e["extends"]]),t&&(i?(i=Firestorm.clone(i),Lava.mergeStorageSchema(i,t)):i=t)),i},_parseTemplateCollection:function(e,t){return this._walkTemplateAsArray(e,t.content,"_asTemplate")},_parseObjectCollection:function(e,t){return this._walkTemplateAsArray(e,t.content,"_asObject")},_parseTemplateHash:function(e,t){return this._walkTemplateAsHash(e,t.content,"_asTemplate")},_parseObjectHash:function(e,t){return this._walkTemplateAsHash(e,t.content,"_asObject")},_parseObject:function(e,t){return this._asObject(e,t)},_parsePropertyAsTemplate:function(e,t){return t.content?Lava.parsers.Common.compileTemplate(t.content):[]},_parsePropertyAsLavaType:function(e,t){return!Lava.schema.DEBUG||t.content&&1==t.content.length&&"string"==typeof t.content[0]||Lava.t("One string expected in tag content: "+t.name),Lava.valueToType(e,t.content[0])},_parseAttributeAsLavaType:function(e,t){return Lava.valueToType(e,t)}},Lava.ObjectParser=function(){function e(){this.yy={}}var t={trace:function(){},yy:{},symbols_:{error:2,root:3,EOF:4,value:5,objectDefinition:6,arrayDefinition:7,RAW_STRING:8,NUMBER:9,identifierPath:10,DOT:11,IDENTIFIER:12,OPEN_CURLY:13,memberList:14,CLOSE_CURLY:15,COMMA:16,member:17,COLON:18,OPEN_SQUARE:19,valueList:20,CLOSE_SQUARE:21,$accept:0,$end:1},terminals_:{2:"error",4:"EOF",8:"RAW_STRING",9:"NUMBER",11:"DOT",12:"IDENTIFIER",13:"OPEN_CURLY",15:"CLOSE_CURLY",16:"COMMA",18:"COLON",19:"OPEN_SQUARE",21:"CLOSE_SQUARE"},productions_:[0,[3,1],[3,2],[5,1],[5,1],[5,1],[5,1],[5,1],[10,3],[10,1],[6,3],[6,2],[14,3],[14,1],[17,3],[17,3],[7,3],[7,2],[20,3],[20,1]],performAction:function(e,t,i,a,n,s){var r=s.length-1;switch(n){case 7:a.assertPathValid(s[r]);break;case 8:s[r-2].push(s[r]);break;case 9:this.$=[s[r]]}},table:[{3:1,4:[1,2],5:3,6:4,7:5,8:[1,6],9:[1,7],10:8,12:[1,11],13:[1,9],19:[1,10]},{1:[3]},{1:[2,1]},{4:[1,12]},{4:[2,3],15:[2,3],16:[2,3],21:[2,3]},{4:[2,4],15:[2,4],16:[2,4],21:[2,4]},{4:[2,5],15:[2,5],16:[2,5],21:[2,5]},{4:[2,6],15:[2,6],16:[2,6],21:[2,6]},{4:[2,7],11:[1,13],15:[2,7],16:[2,7],21:[2,7]},{8:[1,17],12:[1,18],14:14,15:[1,15],17:16},{5:21,6:4,7:5,8:[1,6],9:[1,7],10:8,12:[1,11],13:[1,9],19:[1,10],20:19,21:[1,20]},{4:[2,9],11:[2,9],15:[2,9],16:[2,9],21:[2,9]},{1:[2,2]},{12:[1,22]},{15:[1,23],16:[1,24]},{4:[2,11],15:[2,11],16:[2,11],21:[2,11]},{15:[2,13],16:[2,13]},{18:[1,25]},{18:[1,26]},{16:[1,28],21:[1,27]},{4:[2,17],15:[2,17],16:[2,17],21:[2,17]},{16:[2,19],21:[2,19]},{4:[2,8],11:[2,8],15:[2,8],16:[2,8],21:[2,8]},{4:[2,10],15:[2,10],16:[2,10],21:[2,10]},{8:[1,17],12:[1,18],17:29},{5:30,6:4,7:5,8:[1,6],9:[1,7],10:8,12:[1,11],13:[1,9],19:[1,10]},{5:31,6:4,7:5,8:[1,6],9:[1,7],10:8,12:[1,11],13:[1,9],19:[1,10]},{4:[2,16],15:[2,16],16:[2,16],21:[2,16]},{5:32,6:4,7:5,8:[1,6],9:[1,7],10:8,12:[1,11],13:[1,9],19:[1,10]},{15:[2,12],16:[2,12]},{15:[2,14],16:[2,14]},{15:[2,15],16:[2,15]},{16:[2,18],21:[2,18]}],defaultActions:{2:[2,1],12:[2,2]},parseError:function(e,t){if(!t.recoverable)throw Error(e);this.trace(e)},parse:function(e){function t(){var e;return e=i.lexer.lex()||u,"number"!=typeof e&&(e=i.symbols_[e]||e),e}var i=this,a=[0],n=[null],s=[],r=this.table,o="",l=0,_=0,c=0,h=2,u=1;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var d=this.lexer.yylloc;s.push(d);var p=this.lexer.options&&this.lexer.options.ranges;this.parseError="function"==typeof this.yy.parseError?this.yy.parseError:(Object.getPrototypeOf?Object.getPrototypeOf(this):this.__proto__).parseError;for(var m,g,f,v,y,b,L,E,w,x={};;){if(f=a[a.length-1],this.defaultActions[f]?v=this.defaultActions[f]:((null===m||void 0===m)&&(m=t()),v=r[f]&&r[f][m]),void 0===v||!v.length||!v[0]){var S="";w=[];for(b in r[f])this.terminals_[b]&&b>h&&w.push("'"+this.terminals_[b]+"'");S=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+w.join(", ")+", got '"+(this.terminals_[m]||m)+"'":"Parse error on line "+(l+1)+": Unexpected "+(m==u?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(S,{text:this.lexer.match,token:this.terminals_[m]||m,line:this.lexer.yylineno,loc:d,expected:w})}if(v[0]instanceof Array&&v.length>1)throw Error("Parse Error: multiple actions possible at state: "+f+", token: "+m);switch(v[0]){case 1:a.push(m),n.push(this.lexer.yytext),s.push(this.lexer.yylloc),a.push(v[1]),m=null,g?(m=g,g=null):(_=this.lexer.yyleng,o=this.lexer.yytext,l=this.lexer.yylineno,d=this.lexer.yylloc,c>0&&c--);break;case 2:if(L=this.productions_[v[1]][1],x.$=n[n.length-L],x._$={first_line:s[s.length-(L||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(L||1)].first_column,last_column:s[s.length-1].last_column},p&&(x._$.range=[s[s.length-(L||1)].range[0],s[s.length-1].range[1]]),y=this.performAction.call(x,o,_,l,this.yy,v[1],n,s),void 0!==y)return y;L&&(a=a.slice(0,-1*L*2),n=n.slice(0,-1*L),s=s.slice(0,-1*L)),a.push(this.productions_[v[1]][0]),n.push(x.$),s.push(x._$),E=r[a[a.length-2]][a[a.length-1]],a.push(E);break;case 3:return!0}}return!0}},i=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,i=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var a=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);var n=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===a.length?this.yylloc.first_column:0)+a[a.length-i.length].length-i[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[n[0],n[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var i,a,n;if(this.options.backtrack_lexer&&(n={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(n.yylloc.range=this.yylloc.range.slice(0))),a=e[0].match(/(?:\r\n?|\n).*/g),a&&(this.yylineno+=a.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:a?a[a.length-1].length-a[a.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],i=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),i)return this.options.backtrack_lexer&&delete n,i;if(this._backtrack){for(var s in n)this[s]=n[s];return!1}return this.options.backtrack_lexer&&delete n,!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,i,a;this._more||(this.yytext="",this.match="");for(var n=this._currentRules(),s=0;s<n.length;s++)if(i=this._input.match(this.rules[n[s]]),i&&(!t||i[0].length>t[0].length)){if(t=i,a=s,this.options.backtrack_lexer){if(e=this.test_match(i,n[s]),e!==!1)return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?(e=this.test_match(t,n[a]),e!==!1?e:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){var e=this.conditionStack.length-1;return e>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return e=this.conditionStack.length-1-Math.abs(e||0),e>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,i,a){switch(i){case 0:return 13;case 1:return 15;case 2:return 19;case 3:return 21;case 4:return 18;case 5:return 11;case 6:return 16;case 7:return 9;case 8:return 9;case 9:return 8;case 10:return 8;case 11:return 12;case 12:break;case 13:return 4}},rules:[/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?::)/,/^(?:\.)/,/^(?:,)/,/^(?:\d+(\.\d+)?((e|E)(\+|-)\d+)?)/,/^(?:0x[a-fA-F0-9]+)/,/^(?:"([^\\\"]|\\.)*")/,/^(?:'([^\\\']|\\.)*')/,/^(?:[a-zA-Z\_][a-zA-Z0-9\_]*)/,/^(?:\s+)/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return e}();return t.lexer=i,e.prototype=t,t.Parser=e,new e}(),Lava.ObjectParser.yy={valid_globals:["Lava"],assertPathValid:function(e){Lava.schema.VALIDATE_OBJECT_PATHS&&(Lava.parsers.Common.isLiteral(e[0])||-1!=this.valid_globals.indexOf(e[0])||Lava.t("ObjectParser: invalid external path. Text: "+e.join(".")))}},Lava.ExpressionParser=function(){function e(){this.yy={}}var t={trace:function(){},yy:{},symbols_:{error:2,root:3,EOF:4,expressions:5,SEMICOLON:6,expressionWithOptionalDepends:7,COMMA:8,scopeEvalList:9,scopeEval:10,expression:11,DEPENDS_START:12,OPEN_CURLY:13,CLOSE_CURLY:14,expressionTail:15,operand:16,OPERATOR:17,OPEN_BRACE:18,CLOSE_BRACE:19,arrayDefinition:20,NUMBER:21,RAW_STRING:22,LITERAL:23,dynamicScope:24,functionCall:25,OPEN_SQUARE:26,expressionList:27,CLOSE_SQUARE:28,knownView:29,VIEW_BY_LABEL:30,VIEW_BY_ID:31,VIEW_BY_NAME:32,lookupOperator:33,LOOK_UP:34,LOOK_DOWN:35,viewLocator:36,DEEPNESS_OPERATOR:37,GLOBAL_MODIFIER_CALL:38,WIDGET_MODIFIER_CALL:39,ACTIVE_MODIFIER_CALL:40,IDENTIFIER:41,scopePath:42,SEARCH_OPERATOR:43,scopePathSegment:44,DOT_PROPERTY:45,$accept:0,$end:1},terminals_:{2:"error",4:"EOF",6:"SEMICOLON",8:"COMMA",12:"DEPENDS_START",13:"OPEN_CURLY",14:"CLOSE_CURLY",17:"OPERATOR",18:"OPEN_BRACE",19:"CLOSE_BRACE",21:"NUMBER",22:"RAW_STRING",23:"LITERAL",26:"OPEN_SQUARE",28:"CLOSE_SQUARE",30:"VIEW_BY_LABEL",31:"VIEW_BY_ID",32:"VIEW_BY_NAME",34:"LOOK_UP",35:"LOOK_DOWN",37:"DEEPNESS_OPERATOR",38:"GLOBAL_MODIFIER_CALL",39:"WIDGET_MODIFIER_CALL",40:"ACTIVE_MODIFIER_CALL",41:"IDENTIFIER",43:"SEARCH_OPERATOR",45:"DOT_PROPERTY"},productions_:[0,[3,1],[3,2],[5,3],[5,3],[5,1],[9,3],[9,1],[7,5],[7,1],[11,1],[11,1],[11,2],[15,3],[15,2],[16,3],[16,1],[16,1],[16,1],[16,1],[16,1],[16,1],[16,1],[20,3],[20,2],[27,3],[27,1],[29,1],[29,1],[29,1],[33,1],[33,1],[36,1],[36,2],[36,2],[36,3],[25,3],[25,4],[25,4],[25,5],[25,4],[25,5],[24,4],[10,1],[10,2],[10,3],[10,2],[10,2],[42,2],[42,1],[44,1],[44,3]],performAction:function(e,t,i,a,n,s){var r=s.length-1;switch(n){case 1:break;case 2:break;case 3:a.assertSemicolonAllowed(),a.finishArgument(s[r].trim());break;case 4:a.assertCommaAllowed(),a.finishArgument(s[r].trim());break;case 5:a.finishArgument(s[r].trim());break;case 6:a.x_argument_binds.push(s[r]);break;case 7:a.x_argument_binds.push(s[r]);break;case 8:this.$=s[r-4];break;case 9:this.$=s[r];break;case 10:a.x_counters.expression_tails++,this.$=s[r];break;case 11:a.x_counters.operands++,this.$=s[r];break;case 12:a.x_counters.operands++,a.x_counters.expression_tails++,this.$=s[r-1]+" "+s[r];break;case 13:a.x_counters.operands++,this.$=s[r-2]+" "+s[r-1]+" "+s[r];break;case 14:a.x_counters.operands++,this.$=s[r-1]+" "+s[r];break;case 15:a.x_counters.braces++,this.$="("+s[r-1]+")";break;case 16:this.$=s[r];break;case 17:a.x_counters.numbers++,this.$=s[r];break;case 18:a.x_counters.strings++,this.$=s[r];break;case 19:a.x_counters.literals++,this.$=s[r];break;case 20:var o=a.x_argument_binds.push(s[r])-1;this.$="this._binds["+o+"].getValue()";break;case 21:a.x_counters.dynamic_scopes++;var o=a.x_argument_binds.push(s[r])-1;this.$="this._binds["+o+"].getValue()";break;case 22:this.$=s[r];break;case 23:this.$="["+s[r-1]+"]";break;case 24:this.$="[]";break;case 25:this.$=s[r-2]+", "+s[r];break;case 26:this.$=s[r];break;case 27:this.$={locator_type:"Label",locator:s[r]};break;case 28:this.$={locator_type:"Id",locator:s[r]};break;case 29:this.$={locator_type:"Name",locator:s[r]};break;case 30:this.$={label:s[r],direction:"look_up"};break;case 31:this.$={label:s[r],direction:"look_down"};break;case 32:this.$=s[r];break;case 33:Lava.t("Lookup operator is not supported yet.");break;case 34:s[r-1].depth=parseInt(s[r]),s[r-1].depth||Lava.t("Deepness operator: depth must be > 0"),this.$=s[r-1];break;case 35:Lava.t("Lookup operator is not supported yet.");break;case 36:a.x_counters.global_modifiers++,this.$='this._callGlobalModifier("'+s[r-2]+'", [])';break;case 37:a.x_counters.global_modifiers++,this.$='this._callGlobalModifier("'+s[r-3]+'", ['+s[r-1]+"])";break;case 38:a.x_counters.widget_modifiers++,s[r-3].callback_name=s[r-2];var o=a.x_argument_widget_modifiers.push(s[r-3])-1;this.$='this._callModifier("'+o+'", [])';break;case 39:a.x_counters.widget_modifiers++,s[r-4].callback_name=s[r-3];var o=a.x_argument_widget_modifiers.push(s[r-4])-1;this.$='this._callModifier("'+o+'", ['+s[r-1]+"])";break;case 40:a.x_counters.active_modifiers++,s[r-3].callback_name=s[r-2];var o=a.x_argument_active_modifiers.push(s[r-3])-1;this.$='this._callActiveModifier("'+o+'", [])';break;case 41:a.x_counters.active_modifiers++,s[r-4].callback_name=s[r-3];var o=a.x_argument_active_modifiers.push(s[r-4])-1;this.$='this._callActiveModifier("'+o+'", ['+s[r-1]+"])";break;case 42:s[r-3].isDynamic=!0,s[r-3].property_name=s[r-1],this.$=s[r-3];break;case 43:this.$={property_name:s[r]};break;case 44:this.$={property_name:s[r-1],tail:s[r]};break;case 45:s[r-2].property_name=s[r-1],s[r-2].tail=s[r],this.$=s[r-2];break;case 46:s[r-1].property_name=s[r],this.$=s[r-1];break;case 47:s[r-1].tail=s[r],this.$=s[r-1];break;case 48:s[r-1].push(s[r]),this.$=s[r-1];break;case 49:this.$=[s[r]];break;case 50:this.$=s[r];break;case 51:var l=s[r-1].path_segments;if(l)for(var _=0,c=l.length;c>_;_++)"object"==typeof l[_]&&Lava.t("Dynamic segment must not contain other dynamic segments");this.$=s[r-1]}},table:[{3:1,4:[1,2],5:3,7:4,10:14,11:5,15:6,16:7,17:[1,8],18:[1,9],20:10,21:[1,11],22:[1,12],23:[1,13],24:15,25:16,26:[1,17],29:20,30:[1,22],31:[1,23],32:[1,24],36:19,38:[1,21],41:[1,18]},{1:[3]},{1:[2,1]},{4:[1,25],6:[1,26],8:[1,27]},{4:[2,5],6:[2,5],8:[2,5]},{4:[2,9],6:[2,9],8:[2,9],12:[1,28]},{4:[2,10],6:[2,10],8:[2,10],12:[2,10],17:[1,29],19:[2,10],28:[2,10]},{4:[2,11],6:[2,11],8:[2,11],12:[2,11],15:30,17:[1,8],19:[2,11],28:[2,11]},{10:14,16:31,18:[1,9],20:10,21:[1,11],22:[1,12],23:[1,13],24:15,25:16,26:[1,17],29:20,30:[1,22],31:[1,23],32:[1,24],36:19,38:[1,21],41:[1,18]},{10:14,11:32,15:6,16:7,17:[1,8],18:[1,9],20:10,21:[1,11],22:[1,12],23:[1,13],24:15,25:16,26:[1,17],29:20,30:[1,22],31:[1,23],32:[1,24],36:19,38:[1,21],41:[1,18]},{4:[2,16],6:[2,16],8:[2,16],12:[2,16],17:[2,16],19:[2,16],28:[2,16]},{4:[2,17],6:[2,17],8:[2,17],12:[2,17],17:[2,17],19:[2,17],28:[2,17]},{4:[2,18],6:[2,18],8:[2,18],12:[2,18],17:[2,18],19:[2,18],28:[2,18]},{4:[2,19],6:[2,19],8:[2,19],12:[2,19],17:[2,19],19:[2,19],28:[2,19]},{4:[2,20],6:[2,20],8:[2,20],12:[2,20],17:[2,20],19:[2,20],28:[2,20]},{4:[2,21],6:[2,21],8:[2,21],12:[2,21],17:[2,21],19:[2,21],28:[2,21]},{4:[2,22],6:[2,22],8:[2,22],12:[2,22],17:[2,22],19:[2,22],28:[2,22]},{10:14,11:35,15:6,16:7,17:[1,8],18:[1,9],20:10,21:[1,11],22:[1,12],23:[1,13],24:15,25:16,26:[1,17],27:33,28:[1,34],29:20,30:[1,22],31:[1,23],32:[1,24],36:19,38:[1,21],41:[1,18]},{4:[2,43],6:[2,43],8:[2,43],12:[2,43],14:[2,43],17:[2,43],19:[2,43],26:[1,39],28:[2,43],42:36,44:37,45:[1,38]},{26:[1,39],42:41,43:[1,40],44:37,45:[1,38]},{13:[1,42],26:[2,32],33:45,34:[1,47],35:[1,48],37:[1,46],39:[1,43],40:[1,44],43:[2,32],45:[2,32]},{18:[1,49]},{13:[2,27],26:[2,27],34:[2,27],35:[2,27],37:[2,27],39:[2,27],40:[2,27],43:[2,27],45:[2,27]},{13:[2,28],26:[2,28],34:[2,28],35:[2,28],37:[2,28],39:[2,28],40:[2,28],43:[2,28],45:[2,28]},{13:[2,29],26:[2,29],34:[2,29],35:[2,29],37:[2,29],39:[2,29],40:[2,29],43:[2,29],45:[2,29]},{1:[2,2]},{7:50,10:14,11:5,15:6,16:7,17:[1,8],18:[1,9],20:10,21:[1,11],22:[1,12],23:[1,13],24:15,25:16,26:[1,17],29:20,30:[1,22],31:[1,23],32:[1,24],36:19,38:[1,21],41:[1,18]},{7:51,10:14,11:5,15:6,16:7,17:[1,8],18:[1,9],20:10,21:[1,11],22:[1,12],23:[1,13],24:15,25:16,26:[1,17],29:20,30:[1,22],31:[1,23],32:[1,24],36:19,38:[1,21],41:[1,18]},{13:[1,52]},{10:14,16:53,18:[1,9],20:10,21:[1,11],22:[1,12],23:[1,13],24:15,25:16,26:[1,17],29:20,30:[1,22],31:[1,23],32:[1,24],36:19,38:[1,21],41:[1,18]},{4:[2,12],6:[2,12],8:[2,12],12:[2,12],17:[1,29],19:[2,12],28:[2,12]},{4:[2,14],6:[2,14],8:[2,14],12:[2,14],17:[2,14],19:[2,14],28:[2,14]},{19:[1,54]},{8:[1,56],28:[1,55]},{4:[2,24],6:[2,24],8:[2,24],12:[2,24],17:[2,24],19:[2,24],28:[2,24]},{8:[2,26],19:[2,26],28:[2,26]},{4:[2,44],6:[2,44],8:[2,44],12:[2,44],14:[2,44],17:[2,44],19:[2,44],26:[1,39],28:[2,44],44:57,45:[1,38]},{4:[2,49],6:[2,49],8:[2,49],12:[2,49],14:[2,49],17:[2,49],19:[2,49],26:[2,49],28:[2,49],45:[2,49]},{4:[2,50],6:[2,50],8:[2,50],12:[2,50],14:[2,50],17:[2,50],19:[2,50],26:[2,50],28:[2,50],45:[2,50]},{10:58,29:59,30:[1,22],31:[1,23],32:[1,24],36:19,41:[1,18]},{4:[2,46],6:[2,46],8:[2,46],12:[2,46],14:[2,46],17:[2,46],19:[2,46],26:[1,39],28:[2,46],42:60,44:37,45:[1,38]},{4:[2,47],6:[2,47],8:[2,47],12:[2,47],14:[2,47],17:[2,47],19:[2,47],26:[1,39],28:[2,47],44:57,45:[1,38]},{41:[1,61]},{18:[1,62]},{18:[1,63]},{26:[2,33],43:[2,33],45:[2,33]},{26:[2,34],33:64,34:[1,47],35:[1,48],43:[2,34],45:[2,34]},{26:[2,30],43:[2,30],45:[2,30]},{26:[2,31],43:[2,31],45:[2,31]},{10:14,11:35,15:6,16:7,17:[1,8],18:[1,9],19:[1,65],20:10,21:[1,11],22:[1,12],23:[1,13],24:15,25:16,26:[1,17],27:66,29:20,30:[1,22],31:[1,23],32:[1,24],36:19,38:[1,21],41:[1,18]},{4:[2,3],6:[2,3],8:[2,3]},{4:[2,4],6:[2,4],8:[2,4]},{9:67,10:68,29:59,30:[1,22],31:[1,23],32:[1,24],36:19,41:[1,18]},{4:[2,13],6:[2,13],8:[2,13],12:[2,13],17:[2,13],19:[2,13],28:[2,13]},{4:[2,15],6:[2,15],8:[2,15],12:[2,15],17:[2,15],19:[2,15],28:[2,15]},{4:[2,23],6:[2,23],8:[2,23],12:[2,23],17:[2,23],19:[2,23],28:[2,23]},{10:14,11:69,15:6,16:7,17:[1,8],18:[1,9],20:10,21:[1,11],22:[1,12],23:[1,13],24:15,25:16,26:[1,17],29:20,30:[1,22],31:[1,23],32:[1,24],36:19,38:[1,21],41:[1,18]},{4:[2,48],6:[2,48],8:[2,48],12:[2,48],14:[2,48],17:[2,48],19:[2,48],26:[2,48],28:[2,48],45:[2,48]},{28:[1,70]},{26:[2,32],33:45,34:[1,47],35:[1,48],37:[1,46],43:[2,32],45:[2,32]},{4:[2,45],6:[2,45],8:[2,45],12:[2,45],14:[2,45],17:[2,45],19:[2,45],26:[1,39],28:[2,45],44:57,45:[1,38]},{14:[1,71]},{10:14,11:35,15:6,16:7,17:[1,8],18:[1,9],19:[1,72],20:10,21:[1,11],22:[1,12],23:[1,13],24:15,25:16,26:[1,17],27:73,29:20,30:[1,22],31:[1,23],32:[1,24],36:19,38:[1,21],41:[1,18]},{10:14,11:35,15:6,16:7,17:[1,8],18:[1,9],19:[1,74],20:10,21:[1,11],22:[1,12],23:[1,13],24:15,25:16,26:[1,17],27:75,29:20,30:[1,22],31:[1,23],32:[1,24],36:19,38:[1,21],41:[1,18]},{26:[2,35],43:[2,35],45:[2,35]},{4:[2,36],6:[2,36],8:[2,36],12:[2,36],17:[2,36],19:[2,36],28:[2,36]},{8:[1,56],19:[1,76]},{8:[1,78],14:[1,77]},{8:[2,7],14:[2,7]},{8:[2,25],19:[2,25],28:[2,25]},{4:[2,51],6:[2,51],8:[2,51],12:[2,51],14:[2,51],17:[2,51],19:[2,51],26:[2,51],28:[2,51],45:[2,51]},{4:[2,42],6:[2,42],8:[2,42],12:[2,42],17:[2,42],19:[2,42],28:[2,42]},{4:[2,38],6:[2,38],8:[2,38],12:[2,38],17:[2,38],19:[2,38],28:[2,38]},{8:[1,56],19:[1,79]},{4:[2,40],6:[2,40],8:[2,40],12:[2,40],17:[2,40],19:[2,40],28:[2,40]},{8:[1,56],19:[1,80]},{4:[2,37],6:[2,37],8:[2,37],12:[2,37],17:[2,37],19:[2,37],28:[2,37]},{4:[2,8],6:[2,8],8:[2,8]},{10:81,29:59,30:[1,22],31:[1,23],32:[1,24],36:19,41:[1,18]},{4:[2,39],6:[2,39],8:[2,39],12:[2,39],17:[2,39],19:[2,39],28:[2,39]},{4:[2,41],6:[2,41],8:[2,41],12:[2,41],17:[2,41],19:[2,41],28:[2,41]},{8:[2,6],14:[2,6]}],defaultActions:{2:[2,1],25:[2,2]},parseError:function(e,t){if(!t.recoverable)throw Error(e);this.trace(e)},parse:function(e){function t(){var e;return e=i.lexer.lex()||u,"number"!=typeof e&&(e=i.symbols_[e]||e),e}var i=this,a=[0],n=[null],s=[],r=this.table,o="",l=0,_=0,c=0,h=2,u=1;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});
var d=this.lexer.yylloc;s.push(d);var p=this.lexer.options&&this.lexer.options.ranges;this.parseError="function"==typeof this.yy.parseError?this.yy.parseError:(Object.getPrototypeOf?Object.getPrototypeOf(this):this.__proto__).parseError;for(var m,g,f,v,y,b,L,E,w,x={};;){if(f=a[a.length-1],this.defaultActions[f]?v=this.defaultActions[f]:((null===m||void 0===m)&&(m=t()),v=r[f]&&r[f][m]),void 0===v||!v.length||!v[0]){var S="";w=[];for(b in r[f])this.terminals_[b]&&b>h&&w.push("'"+this.terminals_[b]+"'");S=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+w.join(", ")+", got '"+(this.terminals_[m]||m)+"'":"Parse error on line "+(l+1)+": Unexpected "+(m==u?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(S,{text:this.lexer.match,token:this.terminals_[m]||m,line:this.lexer.yylineno,loc:d,expected:w})}if(v[0]instanceof Array&&v.length>1)throw Error("Parse Error: multiple actions possible at state: "+f+", token: "+m);switch(v[0]){case 1:a.push(m),n.push(this.lexer.yytext),s.push(this.lexer.yylloc),a.push(v[1]),m=null,g?(m=g,g=null):(_=this.lexer.yyleng,o=this.lexer.yytext,l=this.lexer.yylineno,d=this.lexer.yylloc,c>0&&c--);break;case 2:if(L=this.productions_[v[1]][1],x.$=n[n.length-L],x._$={first_line:s[s.length-(L||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(L||1)].first_column,last_column:s[s.length-1].last_column},p&&(x._$.range=[s[s.length-(L||1)].range[0],s[s.length-1].range[1]]),y=this.performAction.call(x,o,_,l,this.yy,v[1],n,s),void 0!==y)return y;L&&(a=a.slice(0,-1*L*2),n=n.slice(0,-1*L),s=s.slice(0,-1*L)),a.push(this.productions_[v[1]][0]),n.push(x.$),s.push(x._$),E=r[a[a.length-2]][a[a.length-1]],a.push(E);break;case 3:return!0}}return!0}},i=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,i=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var a=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);var n=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===a.length?this.yylloc.first_column:0)+a[a.length-i.length].length-i[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[n[0],n[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var i,a,n;if(this.options.backtrack_lexer&&(n={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(n.yylloc.range=this.yylloc.range.slice(0))),a=e[0].match(/(?:\r\n?|\n).*/g),a&&(this.yylineno+=a.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:a?a[a.length-1].length-a[a.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],i=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),i)return this.options.backtrack_lexer&&delete n,i;if(this._backtrack){for(var s in n)this[s]=n[s];return!1}return this.options.backtrack_lexer&&delete n,!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,i,a;this._more||(this.yytext="",this.match="");for(var n=this._currentRules(),s=0;s<n.length;s++)if(i=this._input.match(this.rules[n[s]]),i&&(!t||i[0].length>t[0].length)){if(t=i,a=s,this.options.backtrack_lexer){if(e=this.test_match(i,n[s]),e!==!1)return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?(e=this.test_match(t,n[a]),e!==!1?e:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){var e=this.conditionStack.length-1;return e>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return e=this.conditionStack.length-1-Math.abs(e||0),e>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,i,a){switch(i){case 0:Lava.t("Spaces between function name and opening brace are not allowed (1)");break;case 1:Lava.t("Spaces between function name and opening brace are not allowed (1)");break;case 2:Lava.t("Spaces between function name and opening brace are not allowed (2)");break;case 3:Lava.t("Spaces in scope path are not allowed (1)");break;case 4:Lava.t("Spaces in scope path are not allowed (2)");break;case 5:return t.yytext=t.yytext.slice(1),30;case 6:return t.yytext=t.yytext.slice(1),31;case 7:return t.yytext=t.yytext.slice(1),32;case 8:return t.yytext=t.yytext.slice(2),40;case 9:return t.yytext=t.yytext.slice(5),40;case 10:return t.yytext=t.yytext.slice(1),39;case 11:return 38;case 12:return t.yytext=t.yytext.slice(1),37;case 13:return t.yytext=t.yytext.slice(1),45;case 14:return t.yytext=t.yytext.slice(2),43;case 15:return t.yytext=t.yytext.slice(5),43;case 16:return t.yytext=t.yytext.substr(4,t.yyleng-5),34;case 17:return t.yytext=t.yytext.substr(4,t.yyleng-5),35;case 18:return t.yytext=e.unescape(t.yytext),17;case 19:return t.yytext=e.unescape(t.yytext),17;case 20:return 12;case 21:return 17;case 22:return 17;case 23:return 17;case 24:return 17;case 25:return 17;case 26:return 17;case 27:return 8;case 28:return 6;case 29:return 21;case 30:return 21;case 31:return 22;case 32:return 22;case 33:return 26;case 34:return 28;case 35:break;case 36:return 13;case 37:return 14;case 38:return this.x_lex_brace_levels++,18;case 39:return this.x_tail_mode&&0==this.x_lex_brace_levels?(this.x_input_tail_length=this._input.length,this._input="",this.done=!0,4):(this.x_lex_brace_levels--,19);case 40:var n=t.yytext.toLowerCase(),s={lt:"<",gt:">",and:"&&"};return"this"==n&&Lava.t("'this' is reserved word. Are you missing the Label sign (@)?"),n in s&&n!=t.yytext&&Lava.t("Expression parser: 'lt', 'gt', 'and' must be lower case"),n in s?(t.yytext=s[n],17):Lava.parsers.Common.isLiteral(t.yytext)?(n!=t.yytext&&Lava.t("Expression parser, code style: literals must be lower case"),23):41;case 41:return 4}},rules:[/^(?:->([a-zA-Z\_][a-zA-Z0-9\_]*)(?=\s+)\()/,/^(?:-&gt;([a-zA-Z\_][a-zA-Z0-9\_]*)(?=\s+)\()/,/^(?:\.([a-zA-Z\_][a-zA-Z0-9\_]*)(?=\s+)\()/,/^(?:\s+[\~\.])/,/^(?:\[\s\b)/,/^(?:@([a-zA-Z\_][a-zA-Z0-9\_]*))/,/^(?:#([a-zA-Z\_][a-zA-Z0-9\_]*))/,/^(?:\$([a-zA-Z\_][a-zA-Z0-9\_]*))/,/^(?:->([a-zA-Z\_][a-zA-Z0-9\_]*)(?=\())/,/^(?:-&gt;([a-zA-Z\_][a-zA-Z0-9\_]*)(?=\())/,/^(?:\.([a-zA-Z\_][a-zA-Z0-9\_]*)(?=\())/,/^(?:([a-zA-Z\_][a-zA-Z0-9\_]*)(?=\())/,/^(?:~\d+)/,/^(?:\.[a-zA-Z0-9\_]+)/,/^(?:->([a-zA-Z\_][a-zA-Z0-9\_]*))/,/^(?:-&gt;([a-zA-Z\_][a-zA-Z0-9\_]*))/,/^(?::up\(([a-zA-Z\_][a-zA-Z0-9\_]*)\))/,/^(?::dn\(([a-zA-Z\_][a-zA-Z0-9\_]*)\))/,/^(?:(&lt;|&gt;))/,/^(?:(&amp;|&lt;|&gt;|&)+)/,/^(?:\/\/depends:)/,/^(?:[\+\-\*\/\%])/,/^(?:\|\||!!)/,/^(?:===|!==|==|!=|<=|>=|<|>)/,/^(?:>>>|>>|<<|[\|\^])/,/^(?:[\?\:])/,/^(?:!)/,/^(?:,)/,/^(?:;)/,/^(?:\d+(\.\d+)?((e|E)(\+|-)\d+)?)/,/^(?:0x[a-fA-F0-9]+)/,/^(?:"(\\"|[^"])*")/,/^(?:'(\\'|[^'])*')/,/^(?:\[(?=[^\s]))/,/^(?:\])/,/^(?:\s+)/,/^(?:\{)/,/^(?:\})/,/^(?:\()/,/^(?:\))/,/^(?:([a-zA-Z\_][a-zA-Z0-9\_]*))/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41],inclusive:!0}}};return e}();return t.lexer=i,e.prototype=t,t.Parser=e,new e}(),Lava.ExpressionParser._parse=Lava.ExpressionParser.parse,Lava.ExpressionParser.SEPARATORS={COMMA:1,SEMICOLON:2},Lava.ExpressionParser.parseRaw=function(e,t){this.yy.is_parsing&&Lava.t("Calling ExpressionParser.parse*() recursively will break the parser. Please, create another instance."),this.lexer.x_tail_mode=!1,this.lexer.x_lex_brace_levels=0,this.lexer.x_input_tail_length=0,this.yy.x_allowed_separator=t,this.yy.reset();try{this.yy.is_parsing=!0,this._parse(e)}finally{this.yy.is_parsing=!1}return this.yy.x_arguments},Lava.ExpressionParser.parse=function(e,t){return this.yy.convertArguments(this.parseRaw(e,t))},Lava.ExpressionParser.parseWithTailRaw=function(e,t){this.yy.is_parsing&&Lava.t("Calling ExpressionParser.parse*() recursively will break the parser. Please, create another instance."),this.lexer.x_tail_mode=!0,this.lexer.x_lex_brace_levels=0,this.lexer.x_input_tail_length=0,this.yy.x_allowed_separator=t,this.yy.reset();try{this.yy.is_parsing=!0,this._parse(e.input)}finally{this.yy.is_parsing=!1}return e.tail_length=this.lexer.x_input_tail_length,this.yy.x_arguments},Lava.ExpressionParser.parseWithTail=function(e,t){return this.yy.convertArguments(this.parseWithTailRaw(e,t))},Lava.ExpressionParser.parseScopeEval=function(e){var t=this.parseRaw(e);return!Lava.schema.DEBUG||1==t.length&&t[0].flags&&t[0].flags.isScopeEval||Lava.t("parseScopeEval: malformed scope path"),t[0].binds[0]},Lava.ExpressionParser.yy={is_parsing:!1,x_arguments:null,x_argument_binds:null,x_argument_widget_modifiers:null,x_argument_active_modifiers:null,x_allowed_separator:null,x_counters:{modifiers:0,active_modifiers:0,operands:0,expression_tails:0,braces:0,literals:0,numbers:0,strings:0,dynamic_scopes:0},unescape:function(e){return Firestorm.String.unescape(e)},reset:function(){this.x_argument_binds=[],this.x_argument_widget_modifiers=[],this.x_argument_active_modifiers=[],this.x_arguments=[]},resetCounters:function(){this.x_counters.global_modifiers=0,this.x_counters.widget_modifiers=0,this.x_counters.active_modifiers=0,this.x_counters.operands=0,this.x_counters.expression_tails=0,this.x_counters.braces=0,this.x_counters.literals=0,this.x_counters.numbers=0,this.x_counters.strings=0,this.x_counters.dynamic_scopes=0},finishArgument:function(e){var t={evaluator_src:e},i={};this.x_argument_binds.length&&(t.binds=this.x_argument_binds),this.x_argument_widget_modifiers.length&&(t.modifiers=this.x_argument_widget_modifiers),this.x_argument_active_modifiers.length&&(t.active_modifiers=this.x_argument_active_modifiers),this.x_counters.global_modifiers>0&&(i.hasGlobalModifiers=!0),1==this.x_argument_binds.length&&1==this.x_counters.operands&&0==this.x_counters.expression_tails&&0==this.x_counters.braces&&0==this.x_counters.dynamic_scopes&&(i.isScopeEval=!0),0==this.x_argument_binds.length&&0==this.x_counters.active_modifiers&&(i.isStatic=!0,1==this.x_counters.literals&&1==this.x_counters.operands&&(i.isLiteral=!0),1==this.x_counters.numbers&&1==this.x_counters.operands&&(i.isNumber=!0),1==this.x_counters.strings&&1==this.x_counters.operands&&(i.isString=!0)),Firestorm.Object.isEmpty(i)||(t.flags=i),this.x_arguments.push(t),this.x_argument_binds=[],this.x_argument_widget_modifiers=[],this.x_argument_active_modifiers=[],this.resetCounters()},convertArguments:function(e){for(var t=0,i=e.length,a=[];i>t;t++)a.push(this.convertArgument(e[t]));return a},convertArgument:function(e){var t="return ("+e.evaluator_src+");",i={evaluator:Function(t)};return"flags"in e&&(i.flags=e.flags),"binds"in e&&(i.binds=e.binds),"modifiers"in e&&(i.modifiers=e.modifiers),"active_modifiers"in e&&(i.active_modifiers=e.active_modifiers),i},assertSemicolonAllowed:function(){null==this.x_allowed_separator&&Lava.t("ExpressionParser: semicolon encountered, but separator is not set"),this.x_allowed_separator!=Lava.ExpressionParser.SEPARATORS.SEMICOLON&&Lava.t("ExpressionParser: comma is not allowed as separator here")},assertCommaAllowed:function(){null==this.x_allowed_separator&&Lava.t("ExpressionParser: comma encountered, but separator is not set"),this.x_allowed_separator!=Lava.ExpressionParser.SEPARATORS.COMMA&&Lava.t("ExpressionParser: semicolon is not allowed as separator here")}},Lava.TemplateParser=function(){function e(){this.yy={}}var t={trace:function(){},yy:{},symbols_:{error:2,root:3,EOF:4,blocks:5,block:6,CONTENT:7,INCLUDE:8,EXPRESSION_BLOCK_N:9,EXPRESSION_BLOCK_E:10,blockStart:11,BLOCK_END:12,elsePart:13,selfClosingTag:14,tagStart:15,TAG_END:16,SCRIPT_CONTENT:17,SWITCH_ON:18,SWITCH_OFF:19,OPEN_BLOCK:20,blockInit:21,BLOCK_CLOSE:22,blockHash:23,DYNAMIC_BLOCK_INIT:24,EMPTY_ARGS:25,EXPORT_ARGUMENTS:26,BLOCK_INIT:27,blockHashSegment:28,IDENTIFIER:29,HASH_ASSIGN:30,STRING:31,elseifChain:32,BLOCK_ELSE:33,blockElseif:34,OPEN_ELSEIF:35,TAG_OPEN:36,TAG_END_CLOSE:37,htmlHash:38,TAG_CLOSE:39,htmlHashSegment:40,HASH_ATTRIBUTE:41,UNESCAPED_HASH_ASSIGN:42,$accept:0,$end:1},terminals_:{2:"error",4:"EOF",7:"CONTENT",8:"INCLUDE",9:"EXPRESSION_BLOCK_N",10:"EXPRESSION_BLOCK_E",12:"BLOCK_END",16:"TAG_END",17:"SCRIPT_CONTENT",18:"SWITCH_ON",19:"SWITCH_OFF",20:"OPEN_BLOCK",22:"BLOCK_CLOSE",24:"DYNAMIC_BLOCK_INIT",25:"EMPTY_ARGS",26:"EXPORT_ARGUMENTS",27:"BLOCK_INIT",29:"IDENTIFIER",30:"HASH_ASSIGN",31:"STRING",33:"BLOCK_ELSE",35:"OPEN_ELSEIF",36:"TAG_OPEN",37:"TAG_END_CLOSE",39:"TAG_CLOSE",41:"HASH_ATTRIBUTE",42:"UNESCAPED_HASH_ASSIGN"},productions_:[0,[3,1],[3,2],[5,2],[5,1],[6,1],[6,1],[6,1],[6,1],[6,2],[6,3],[6,3],[6,4],[6,1],[6,2],[6,2],[6,3],[6,1],[6,1],[11,3],[11,4],[21,2],[21,2],[21,2],[21,2],[23,2],[23,1],[28,1],[28,2],[28,2],[13,3],[13,2],[13,1],[13,2],[13,1],[32,3],[32,2],[32,2],[32,1],[34,3],[14,2],[14,3],[15,2],[15,3],[38,2],[38,1],[40,1],[40,1],[40,2]],performAction:function(e,t,i,a,n,s){var r=s.length-1;switch(n){case 1:return[];case 2:return s[r-1];case 3:this.$=s[r-1],s[r]&&("script"==s[r].name&&"tag"==s[r].type&&s[r].attributes&&"lava/fragment"==s[r].attributes.type?this.$=s[r].content?s[r-1].concat(s[r].content):s[r-1]:"string"==typeof s[r]&&this.$.length&&"string"==typeof this.$[this.$.length-1]?this.$[this.$.length-1]+=s[r]:this.$.push(s[r]));break;case 4:this.$=s[r]?"script"==s[r].name&&"tag"==s[r].type&&s[r].attributes&&"lava/fragment"==s[r].attributes.type?s[r].content||[]:[s[r]]:[];break;case 5:this.$=s[r];break;case 6:var o=Lava.parsers.Common.parseTargets(s[r]);1!=o.length&&Lava.t("Malformed include"),o[0].type="include",this.$=o[0];break;case 7:this.$={type:"expression",prefix:s[r][1],arguments:Lava.ExpressionParser.parse(e.substr(3,t-4))};break;case 8:this.$={type:"expression",prefix:s[r][1],arguments:Lava.ExpressionParser.parse(e.substr(6,t-7))};break;case 9:s[r-1].name!=s[r]&&Lava.t('End block ("'+s[r]+'") does not match the start block ("'+s[r-1].name+'") (1)'),this.$=s[r-1];break;case 10:s[r-2].name!=s[r]&&Lava.t('End block ("'+s[r]+'") does not match the start block ("'+s[r-2].name+'") (2)'),s[r-2].content=s[r-1],this.$=s[r-2];break;case 11:s[r-2].name!=s[r]&&Lava.t('End block ("'+s[r]+'") does not match the start block ("'+s[r-2].name+'") (3)'),"elseif_arguments"in s[r-1]&&(s[r-2].elseif_arguments=s[r-1].elseif_arguments,s[r-2].elseif_content=s[r-1].elseif_content),"else_content"in s[r-1]&&(s[r-2].else_content=s[r-1].else_content),this.$=s[r-2];break;case 12:s[r-3].name!=s[r]&&Lava.t('End block ("'+s[r]+'") does not match the start block ("'+s[r-3].name+'") (4)'),s[r-3].content=s[r-2],"elseif_arguments"in s[r-1]&&(s[r-3].elseif_arguments=s[r-1].elseif_arguments,s[r-3].elseif_content=s[r-1].elseif_content),"else_content"in s[r-1]&&(s[r-3].else_content=s[r-1].else_content),this.$=s[r-3];break;case 13:this.$=s[r];break;case 14:a.validateTagEnd(s[r-1],s[r]),this.$=s[r-1];break;case 15:this.$=s[r-1],"script"==s[r-1].name&&s[r-1].x&&"equiv"in s[r-1].x&&(s[r-1].x.equiv||Lava.t("empty x:equiv"),this.$=a.parseRawTag(s[r-1].x.equiv),delete s[r-1].x.equiv,Firestorm.Object.isEmpty(s[r-1].x)||(this.$.x=Firestorm.Object.copy(s[r-1].x)),"attributes"in s[r-1]&&(this.$.attributes=s[r-1].attributes)),this.$.content=[s[r]];break;case 16:a.validateTagEnd(s[r-2],s[r]),s[r-2].content=s[r-1],this.$=s[r-2],Lava.isVoidTag(this.$.name)&&Lava.t("Void tag with content: "+this.$.name);break;case 17:"preserve_whitespace"==s[r]?(a.preserve_whitespace&&Lava.t("Switch {pre:} is already active"),a.preserve_whitespace=!0):Lava.t("Parser error: lexer returned unknown switch: "+s[r]),this.$=null;break;case 18:"preserve_whitespace"==s[r]?(a.preserve_whitespace||Lava.t("Trying to turn off inactive switch: {:pre}"),a.preserve_whitespace=!1):Lava.t("Parser error: lexer returned unknown switch: "+s[r]),this.$=null;break;case 19:this.$=s[r-1],this.$.prefix=s[r-2][1];break;case 20:this.$=s[r-2],this.$.prefix=s[r-3][1],this.$.hash=s[r-1];break;case 21:this.$={type:"block"},a.parseDynamicBlockInit(this.$,s[r-1].substr(1));break;case 22:this.$={type:"block"},a.parseDynamicBlockInit(this.$,s[r-1].substr(1)),this.$.arguments=a.lexer.x_export_arguments,a.lexer.x_export_arguments=null;break;case 23:this.$={type:"block",name:s[r-1]};break;case 24:this.$={type:"block",name:s[r-1]},this.$.arguments=a.lexer.x_export_arguments,a.lexer.x_export_arguments=null;break;case 25:s[r].name in s[r-1]&&Lava.t("Duplicate attribute in block definition: "+s[r].name),s[r-1][s[r].name]=s[r].value,this.$=s[r-1];break;case 26:this.$={},this.$[s[r].name]=s[r].value;break;case 27:this.$={name:s[r],value:!0};break;case 28:var l={"null":null,undefined:void 0,"true":!0,"false":!1};s[r]in l&&(s[r]=l[s[r]]),this.$={name:s[r-1],value:s[r]};break;case 29:this.$={name:s[r-1],value:s[r]};break;case 30:s[r-2].else_content=s[r],this.$=s[r-2];break;case 31:s[r-1].else_content=[],this.$=s[r-1];break;case 32:this.$=s[r];break;case 33:this.$={else_content:s[r]};break;case 34:this.$={else_content:[]};break;case 35:s[r-2].elseif_arguments.push(s[r-1]),s[r-2].elseif_content.push(s[r]),this.$=s[r-2];break;case 36:s[r-1].elseif_arguments.push(s[r]),s[r-1].elseif_content.push([]),this.$=s[r-1];break;case 37:this.$={elseif_arguments:[s[r-1]],elseif_content:[s[r]]};break;case 38:this.$={elseif_arguments:[s[r]],elseif_content:[[]]};break;case 39:var _=a.lexer.x_export_arguments;1!=_.length&&Lava.t("Elseif block requires exactly one argument"),this.$=_[0],a.lexer.x_export_arguments=null;break;case 40:s[r-1]!=s[r-1].toLowerCase()&&Lava.t("Tag names must be lower case: "+s[r-1]),this.$=a.parseRawTag(s[r-1]);break;case 41:s[r-2]!=s[r-2].toLowerCase()&&Lava.t("Tag names must be lower case: "+s[r-2]),this.$=a.parseRawTag(s[r-2],s[r-1]);break;case 42:s[r-1]!=s[r-1].toLowerCase()&&Lava.t("Tag names must be lower case: "+s[r-1]),this.$=a.parseRawTag(s[r-1]);break;case 43:s[r-2]!=s[r-2].toLowerCase()&&Lava.t("Tag names must be lower case: "+s[r-2]),this.$=a.parseRawTag(s[r-2],s[r-1]);break;case 44:s[r-1].push(s[r]),this.$=s[r-1];break;case 45:this.$=[s[r]];break;case 46:this.$={name:s[r],value:""};break;case 47:var c=s[r].split("=");this.$={name:c[0],value:c[1]};break;case 48:this.$={name:s[r-1],value:s[r]}}},table:[{3:1,4:[1,2],5:3,6:4,7:[1,5],8:[1,6],9:[1,7],10:[1,8],11:9,14:10,15:11,18:[1,12],19:[1,13],20:[1,14],36:[1,15]},{1:[3]},{1:[2,1]},{4:[1,16],6:17,7:[1,5],8:[1,6],9:[1,7],10:[1,8],11:9,14:10,15:11,18:[1,12],19:[1,13],20:[1,14],36:[1,15]},{4:[2,4],7:[2,4],8:[2,4],9:[2,4],10:[2,4],12:[2,4],16:[2,4],18:[2,4],19:[2,4],20:[2,4],33:[2,4],35:[2,4],36:[2,4]},{4:[2,5],7:[2,5],8:[2,5],9:[2,5],10:[2,5],12:[2,5],16:[2,5],18:[2,5],19:[2,5],20:[2,5],33:[2,5],35:[2,5],36:[2,5]},{4:[2,6],7:[2,6],8:[2,6],9:[2,6],10:[2,6],12:[2,6],16:[2,6],18:[2,6],19:[2,6],20:[2,6],33:[2,6],35:[2,6],36:[2,6]},{4:[2,7],7:[2,7],8:[2,7],9:[2,7],10:[2,7],12:[2,7],16:[2,7],18:[2,7],19:[2,7],20:[2,7],33:[2,7],35:[2,7],36:[2,7]},{4:[2,8],7:[2,8],8:[2,8],9:[2,8],10:[2,8],12:[2,8],16:[2,8],18:[2,8],19:[2,8],20:[2,8],33:[2,8],35:[2,8],36:[2,8]},{5:19,6:4,7:[1,5],8:[1,6],9:[1,7],10:[1,8],11:9,12:[1,18],13:20,14:10,15:11,18:[1,12],19:[1,13],20:[1,14],32:21,33:[1,22],34:23,35:[1,24],36:[1,15]},{4:[2,13],7:[2,13],8:[2,13],9:[2,13],10:[2,13],12:[2,13],16:[2,13],18:[2,13],19:[2,13],20:[2,13],33:[2,13],35:[2,13],36:[2,13]},{5:27,6:4,7:[1,5],8:[1,6],9:[1,7],10:[1,8],11:9,14:10,15:11,16:[1,25],17:[1,26],18:[1,12],19:[1,13],20:[1,14],36:[1,15]},{4:[2,17],7:[2,17],8:[2,17],9:[2,17],10:[2,17],12:[2,17],16:[2,17],18:[2,17],19:[2,17],20:[2,17],33:[2,17],35:[2,17],36:[2,17]},{4:[2,18],7:[2,18],8:[2,18],9:[2,18],10:[2,18],12:[2,18],16:[2,18],18:[2,18],19:[2,18],20:[2,18],33:[2,18],35:[2,18],36:[2,18]},{21:28,24:[1,29],27:[1,30]},{30:[1,37],37:[1,31],38:32,39:[1,33],40:34,41:[1,35],42:[1,36]},{1:[2,2]},{4:[2,3],7:[2,3],8:[2,3],9:[2,3],10:[2,3],12:[2,3],16:[2,3],18:[2,3],19:[2,3],20:[2,3],33:[2,3],35:[2,3],36:[2,3]},{4:[2,9],7:[2,9],8:[2,9],9:[2,9],10:[2,9],12:[2,9],16:[2,9],18:[2,9],19:[2,9],20:[2,9],33:[2,9],35:[2,9],36:[2,9]},{6:17,7:[1,5],8:[1,6],9:[1,7],10:[1,8],11:9,12:[1,38],13:39,14:10,15:11,18:[1,12],19:[1,13],20:[1,14],32:21,33:[1,22],34:23,35:[1,24],36:[1,15]},{12:[1,40]},{12:[2,32],33:[1,41],34:42,35:[1,24]},{5:43,6:4,7:[1,5],8:[1,6],9:[1,7],10:[1,8],11:9,12:[2,34],14:10,15:11,18:[1,12],19:[1,13],20:[1,14],36:[1,15]},{5:44,6:4,7:[1,5],8:[1,6],9:[1,7],10:[1,8],11:9,12:[2,38],14:10,15:11,18:[1,12],19:[1,13],20:[1,14],33:[2,38],35:[2,38],36:[1,15]},{26:[1,45]},{4:[2,14],7:[2,14],8:[2,14],9:[2,14],10:[2,14],12:[2,14],16:[2,14],18:[2,14],19:[2,14],20:[2,14],33:[2,14],35:[2,14],36:[2,14]},{4:[2,15],7:[2,15],8:[2,15],9:[2,15],10:[2,15],12:[2,15],16:[2,15],18:[2,15],19:[2,15],20:[2,15],33:[2,15],35:[2,15],36:[2,15]},{6:17,7:[1,5],8:[1,6],9:[1,7],10:[1,8],11:9,14:10,15:11,16:[1,46],18:[1,12],19:[1,13],20:[1,14],36:[1,15]},{22:[1,47],23:48,28:49,29:[1,50],30:[1,51]},{25:[1,52],26:[1,53]},{25:[1,54],26:[1,55]},{4:[2,40],7:[2,40],8:[2,40],9:[2,40],10:[2,40],12:[2,40],16:[2,40],18:[2,40],19:[2,40],20:[2,40],33:[2,40],35:[2,40],36:[2,40]},{30:[1,37],37:[1,56],39:[1,57],40:58,41:[1,35],42:[1,36]},{7:[2,42],8:[2,42],9:[2,42],10:[2,42],16:[2,42],17:[2,42],18:[2,42],19:[2,42],20:[2,42],36:[2,42]},{30:[2,45],37:[2,45],39:[2,45],41:[2,45],42:[2,45]},{30:[2,46],37:[2,46],39:[2,46],41:[2,46],42:[2,46]},{30:[2,47],37:[2,47],39:[2,47],41:[2,47],42:[2,47]},{31:[1,59]},{4:[2,10],7:[2,10],8:[2,10],9:[2,10],10:[2,10],12:[2,10],16:[2,10],18:[2,10],19:[2,10],20:[2,10],33:[2,10],35:[2,10],36:[2,10]},{12:[1,60]},{4:[2,11],7:[2,11],8:[2,11],9:[2,11],10:[2,11],12:[2,11],16:[2,11],18:[2,11],19:[2,11],20:[2,11],33:[2,11],35:[2,11],36:[2,11]},{5:61,6:4,7:[1,5],8:[1,6],9:[1,7],10:[1,8],11:9,12:[2,31],14:10,15:11,18:[1,12],19:[1,13],20:[1,14],36:[1,15]},{5:62,6:4,7:[1,5],8:[1,6],9:[1,7],10:[1,8],11:9,12:[2,36],14:10,15:11,18:[1,12],19:[1,13],20:[1,14],33:[2,36],35:[2,36],36:[1,15]},{6:17,7:[1,5],8:[1,6],9:[1,7],10:[1,8],11:9,12:[2,33],14:10,15:11,18:[1,12],19:[1,13],20:[1,14],36:[1,15]},{6:17,7:[1,5],8:[1,6],9:[1,7],10:[1,8],11:9,12:[2,37],14:10,15:11,18:[1,12],19:[1,13],20:[1,14],33:[2,37],35:[2,37],36:[1,15]},{22:[1,63]},{4:[2,16],7:[2,16],8:[2,16],9:[2,16],10:[2,16],12:[2,16],16:[2,16],18:[2,16],19:[2,16],20:[2,16],33:[2,16],35:[2,16],36:[2,16]},{7:[2,19],8:[2,19],9:[2,19],10:[2,19],12:[2,19],18:[2,19],19:[2,19],20:[2,19],33:[2,19],35:[2,19],36:[2,19]},{22:[1,64],28:65,29:[1,50],30:[1,51]},{22:[2,26],29:[2,26],30:[2,26]},{22:[2,27],29:[2,27],30:[2,27]},{29:[1,66],31:[1,67]},{22:[2,21],29:[2,21],30:[2,21]},{22:[2,22],29:[2,22],30:[2,22]},{22:[2,23],29:[2,23],30:[2,23]},{22:[2,24],29:[2,24],30:[2,24]},{4:[2,41],7:[2,41],8:[2,41],9:[2,41],10:[2,41],12:[2,41],16:[2,41],18:[2,41],19:[2,41],20:[2,41],33:[2,41],35:[2,41],36:[2,41]},{7:[2,43],8:[2,43],9:[2,43],10:[2,43],16:[2,43],17:[2,43],18:[2,43],19:[2,43],20:[2,43],36:[2,43]},{30:[2,44],37:[2,44],39:[2,44],41:[2,44],42:[2,44]},{30:[2,48],37:[2,48],39:[2,48],41:[2,48],42:[2,48]},{4:[2,12],7:[2,12],8:[2,12],9:[2,12],10:[2,12],12:[2,12],16:[2,12],18:[2,12],19:[2,12],20:[2,12],33:[2,12],35:[2,12],36:[2,12]},{6:17,7:[1,5],8:[1,6],9:[1,7],10:[1,8],11:9,12:[2,30],14:10,15:11,18:[1,12],19:[1,13],20:[1,14],36:[1,15]},{6:17,7:[1,5],8:[1,6],9:[1,7],10:[1,8],11:9,12:[2,35],14:10,15:11,18:[1,12],19:[1,13],20:[1,14],33:[2,35],35:[2,35],36:[1,15]},{7:[2,39],8:[2,39],9:[2,39],10:[2,39],12:[2,39],18:[2,39],19:[2,39],20:[2,39],33:[2,39],35:[2,39],36:[2,39]},{7:[2,20],8:[2,20],9:[2,20],10:[2,20],12:[2,20],18:[2,20],19:[2,20],20:[2,20],33:[2,20],35:[2,20],36:[2,20]},{22:[2,25],29:[2,25],30:[2,25]},{22:[2,28],29:[2,28],30:[2,28]},{22:[2,29],29:[2,29],30:[2,29]}],defaultActions:{2:[2,1],16:[2,2]},parseError:function(e,t){if(!t.recoverable)throw Error(e);this.trace(e)},parse:function(e){function t(){var e;return e=i.lexer.lex()||u,"number"!=typeof e&&(e=i.symbols_[e]||e),e}var i=this,a=[0],n=[null],s=[],r=this.table,o="",l=0,_=0,c=0,h=2,u=1;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var d=this.lexer.yylloc;s.push(d);var p=this.lexer.options&&this.lexer.options.ranges;this.parseError="function"==typeof this.yy.parseError?this.yy.parseError:(Object.getPrototypeOf?Object.getPrototypeOf(this):this.__proto__).parseError;for(var m,g,f,v,y,b,L,E,w,x={};;){if(f=a[a.length-1],this.defaultActions[f]?v=this.defaultActions[f]:((null===m||void 0===m)&&(m=t()),v=r[f]&&r[f][m]),void 0===v||!v.length||!v[0]){var S="";w=[];for(b in r[f])this.terminals_[b]&&b>h&&w.push("'"+this.terminals_[b]+"'");S=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+w.join(", ")+", got '"+(this.terminals_[m]||m)+"'":"Parse error on line "+(l+1)+": Unexpected "+(m==u?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(S,{text:this.lexer.match,token:this.terminals_[m]||m,line:this.lexer.yylineno,loc:d,expected:w})}if(v[0]instanceof Array&&v.length>1)throw Error("Parse Error: multiple actions possible at state: "+f+", token: "+m);switch(v[0]){case 1:a.push(m),n.push(this.lexer.yytext),s.push(this.lexer.yylloc),a.push(v[1]),m=null,g?(m=g,g=null):(_=this.lexer.yyleng,o=this.lexer.yytext,l=this.lexer.yylineno,d=this.lexer.yylloc,c>0&&c--);break;case 2:if(L=this.productions_[v[1]][1],x.$=n[n.length-L],x._$={first_line:s[s.length-(L||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(L||1)].first_column,last_column:s[s.length-1].last_column},p&&(x._$.range=[s[s.length-(L||1)].range[0],s[s.length-1].range[1]]),y=this.performAction.call(x,o,_,l,this.yy,v[1],n,s),void 0!==y)return y;L&&(a=a.slice(0,-1*L*2),n=n.slice(0,-1*L),s=s.slice(0,-1*L)),a.push(this.productions_[v[1]][0]),n.push(x.$),s.push(x._$),E=r[a[a.length-2]][a[a.length-1]],a.push(E);break;case 3:return!0}}return!0}},i=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,i=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var a=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);var n=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===a.length?this.yylloc.first_column:0)+a[a.length-i.length].length-i[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[n[0],n[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var i,a,n;if(this.options.backtrack_lexer&&(n={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(n.yylloc.range=this.yylloc.range.slice(0))),a=e[0].match(/(?:\r\n?|\n).*/g),a&&(this.yylineno+=a.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:a?a[a.length-1].length-a[a.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],i=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),i)return this.options.backtrack_lexer&&delete n,i;
if(this._backtrack){for(var s in n)this[s]=n[s];return!1}return this.options.backtrack_lexer&&delete n,!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,i,a;this._more||(this.yytext="",this.match="");for(var n=this._currentRules(),s=0;s<n.length;s++)if(i=this._input.match(this.rules[n[s]]),i&&(!t||i[0].length>t[0].length)){if(t=i,a=s,this.options.backtrack_lexer){if(e=this.test_match(i,n[s]),e!==!1)return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?(e=this.test_match(t,n[a]),e!==!1?e:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){var e=this.conditionStack.length-1;return e>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return e=this.conditionStack.length-1-Math.abs(e||0),e>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,i,a){switch(i){case 0:if(this._input.length&&this.begin("<"==this._input[0]?this.x_pure_blocks_mode?"skipTag":"tag":-1!==["#","$","/",">","*","&"].indexOf(this._input[1])?"block":"{else}"==this._input.substr(0,6)||"{elseif"==this._input.substr(0,7)?"block":"switch"),t.yytext)return 7;break;case 1:return 7;case 2:return this.popState(),7;case 3:return this.popState(),t.yytext=t.yytext.substr(2,t.yyleng-3),8;case 4:return this.popState(),t.yytext=t.yytext.substr(5,t.yyleng-6),8;case 5:return this.popState(),33;case 6:return this.popState(),t.yytext=t.yytext.substr(2,t.yyleng-3),12;case 7:this.popState();break;case 8:return this.popState(),9;case 9:return this.popState(),10;case 10:Lava.t("Spaces between block opening tag and block name are not allowed");break;case 11:Lava.t("Spaces between block name and opening brace are not allowed");break;case 12:return 20;case 13:return 35;case 14:return 24;case 15:return 27;case 16:return this.popState(),this.begin("blockHash"),25;case 17:var n={input:this._input,tail_length:0};return this.x_export_arguments=Lava.ExpressionParser.parseWithTail(n),this._input=this._input.substr(this._input.length-n.tail_length),/(\s|\})/.test(this._input[0])||Lava.t("Lex: arguments closing brace must be followed by whitespace or CLOSE_CURLY"),this.popState(),this.begin("blockHash"),26;case 18:return t.yytext=t.yytext.substr(0,t.yyleng-1),30;case 19:return 29;case 20:return t.yytext=Lava.parsers.Common.unquoteString(t.yytext),31;case 21:return t.yytext=Lava.parsers.Common.unquoteString(t.yytext),31;case 22:return this.popState(),22;case 23:break;case 24:return this.popState(),7;case 25:return this.popState(),7;case 26:return this.popState(),t.yytext=t.yytext.substr(2,t.yyleng-3).toLowerCase(),16;case 27:if(t.yytext=t.yytext.substr(1).trim().toLowerCase(),this.yy.x_lexer_tag_name=t.yytext,this.yy.x_lexer_is_fragment=!1,"script"==t.yytext){var s=this._input.indexOf(">");-1==s&&Lava.t("Lexical error: malformed script tag");var r=this._input.substr(0,s);/type=(\'|\")lava\/fragment(\'|\")/.test(r)&&(this.yy.x_lexer_is_fragment=!0)}return 36;case 28:var o=this.yy.x_lexer_tag_name;if(this.yy.x_lexer_tag_name=null,this.popState(),this.yy.x_lexer_is_fragment||"script"!=o&&"style"!=o){if(Lava.isVoidTag(o))return 37}else this.begin("script"==o?"eatScript":"eatStyle");return 39;case 29:return this.yy.x_lexer_tag_name=null,this.popState(),37;case 30:return t.yytext=t.yytext.trim(),41;case 31:return 41;case 32:return t.yytext=t.yytext.substr(0,t.yyleng-1),30;case 33:return t.yytext=t.yytext.trim(),42;case 34:return t.yytext=Lava.parsers.Common.unquoteString(t.yytext),31;case 35:return t.yytext=Lava.parsers.Common.unquoteString(t.yytext),31;case 36:break;case 37:return this.popState(),t.yytext=t.yytext.substr(0,t.yyleng-9),17;case 38:return this.popState(),t.yytext=t.yytext.substr(0,t.yyleng-8),17;case 39:var l={L:"{",R:"}",LT:"<",GT:">",AMP:"&"};return this.popState(),t.yytext=l[t.yytext.substr(2,t.yyleng-4)],7;case 40:if(this.popState(),"{literal:}"==t.yytext)this.begin("literal");else if("{pure_blocks:}"==t.yytext)this.x_pure_blocks_mode&&Lava.t('Lexer switch: "{pure_blocks:}" mode is already enabled'),this.x_pure_blocks_mode=!0;else{if("{pre:}"==t.yytext)return t.yytext="preserve_whitespace",18;Lava.t("Unknown switch: "+t.yytext)}break;case 41:if(this.popState(),"{:pure_blocks}"==t.yytext)this.x_pure_blocks_mode||Lava.t('Redundant lexer switch "{:pure_blocks}"'),this.x_pure_blocks_mode=!1;else{if("{:pre}"==t.yytext)return t.yytext="preserve_whitespace",19;Lava.t("Unknown switch: "+t.yytext)}break;case 42:return this.popState(),t.yytext=t.yytext.substr(0,t.yyleng-10),7;case 43:return 4}},rules:[/^(?:[^\x00]*?(?=((\{[\#\$\>\*])|{&gt;|(\{\/)|(<([a-zA-Z][a-zA-Z0-9\_\-]*(:[a-zA-Z0-9\_][a-zA-Z0-9\_\-]*)*)\s*)|(<\/([a-zA-Z][a-zA-Z0-9\_\-]*(:[a-zA-Z0-9\_][a-zA-Z0-9\_\-]*)*)>)|(<!--(.|\s)*?-->)|(<!\[CDATA\[(.|\s)*?\]\]>)|\{literal:\}|\{:literal\}|(\{:[LR]:\}|\{:[LG])|\{elseif\s*\(|\{else\})))/,/^(?:[^\x00]+)/,/^(?:<)/,/^(?:\{>[^\}]*\})/,/^(?:\{&gt;[^\}]*\})/,/^(?:\{else\})/,/^(?:\{\/(([a-zA-Z\_][a-zA-Z0-9\_]*)(\/([a-zA-Z\_][a-zA-Z0-9\_]*))*)\})/,/^(?:\{\*([^\*]|\*[^\}])*\*\})/,/^(?:\{(#|\$)>[^\}]+\})/,/^(?:\{(#|\$)&gt;[^\}]+\})/,/^(?:((\{[\#\$\>\*])|{&gt;)\s\b)/,/^(?:((\{[\#\$\>\*])|{&gt;)(([a-zA-Z\_][a-zA-Z0-9\_]*)(\/([a-zA-Z\_][a-zA-Z0-9\_]*))*)\s\()/,/^(?:((\{[\#\$\>\*])|{&gt;))/,/^(?:\{elseif(?=\())/,/^(?::[\$\#\@]([a-zA-Z\_][a-zA-Z0-9\_]*)\/(([a-zA-Z\_][a-zA-Z0-9\_]*)(\/([a-zA-Z\_][a-zA-Z0-9\_]*))*)(?=\())/,/^(?:(([a-zA-Z\_][a-zA-Z0-9\_]*)(\/([a-zA-Z\_][a-zA-Z0-9\_]*))*)(?=\())/,/^(?:\(\s*\))/,/^(?:\()/,/^(?:([a-zA-Z\_][a-zA-Z0-9\_]*)=)/,/^(?:([a-zA-Z\_][a-zA-Z0-9\_]*)(?=[\s\}]))/,/^(?:"([^\\\"]|\\.)*"(?=[\s\}]))/,/^(?:'([^\\\']|\\.)*'(?=[\s\}]))/,/^(?:\s*\})/,/^(?:\s+)/,/^(?:(<!--(.|\s)*?-->))/,/^(?:(<!\[CDATA\[(.|\s)*?\]\]>))/,/^(?:(<\/([a-zA-Z][a-zA-Z0-9\_\-]*(:[a-zA-Z0-9\_][a-zA-Z0-9\_\-]*)*)>))/,/^(?:(<([a-zA-Z][a-zA-Z0-9\_\-]*(:[a-zA-Z0-9\_][a-zA-Z0-9\_\-]*)*)\s*))/,/^(?:>)/,/^(?:\/>)/,/^(?:([a-zA-Z][a-zA-Z0-9\_\-]*(:[a-zA-Z0-9\_][a-zA-Z0-9\_\-]*)*)\s+)/,/^(?:([a-zA-Z][a-zA-Z0-9\_\-]*(:[a-zA-Z0-9\_][a-zA-Z0-9\_\-]*)*)(?=>))/,/^(?:([a-zA-Z][a-zA-Z0-9\_\-]*(:[a-zA-Z0-9\_][a-zA-Z0-9\_\-]*)*)=)/,/^(?:([a-zA-Z][a-zA-Z0-9\_\-]*(:[a-zA-Z0-9\_][a-zA-Z0-9\_\-]*)*)=([a-zA-Z\_][a-zA-Z0-9\_]*)+\s\b)/,/^(?:"([^\\\"]|\\.)*")/,/^(?:'([^\\\']|\\.)*')/,/^(?:\s+)/,/^(?:[\s\S]*?<\/script>)/,/^(?:[\s\S]*?<\/style>)/,/^(?:(\{:[LR]:\}|\{:[LG]))/,/^(?:\{literal:\})/,/^(?:\{:literal\})/,/^(?:[^\x00]*?\{:literal\})/,/^(?:$)/],conditions:{block:{rules:[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],inclusive:!1},blockHash:{rules:[18,19,20,21,22,23],inclusive:!1},tag:{rules:[24,25,26,27,28,29,30,31,32,33,34,35,36],inclusive:!1},skipTag:{rules:[2],inclusive:!1},"switch":{rules:[39,40,41],inclusive:!1},literal:{rules:[42],inclusive:!1},eatScript:{rules:[37],inclusive:!1},eatStyle:{rules:[38],inclusive:!1},INITIAL:{rules:[0,1,43],inclusive:!0}}};return e}();return t.lexer=i,e.prototype=t,t.Parser=e,new e}(),Lava.TemplateParser._parse=Lava.TemplateParser.parse,Lava.TemplateParser.parse=function(e,t){return Lava.parsers.Common.compileTemplate(this.parseRaw(e),t)},Lava.TemplateParser.parseRaw=function(e){this.yy.is_parsing&&Lava.t("Calling TemplateParser.parseRaw() recursively will break the parser. Please, create another instance.");var t;this.lexer.x_pure_blocks_mode=!1,this.lexer.x_export_arguments=null,this.yy.preserve_whitespace=!1;try{this.yy.is_parsing=!0,t=this._parse(e)}finally{this.yy.is_parsing=!1}return t},Lava.TemplateParser.yy={is_parsing:!1,CONTROL_ATTRIBUTE_PREFIX:"x:",preserve_whitespace:!1,x_lexer_tag_name:null,x_lexer_is_fragment:!1,_parseControlAttributes:function(e,t){for(var i,a,n,s,r,o,l=0,_=t.length,c={},h={};_>l;l++)if(i=t[l],0==i.name.indexOf(this.CONTROL_ATTRIBUTE_PREFIX))for(n=c,a=i.name.substr(this.CONTROL_ATTRIBUTE_PREFIX.length).split(":"),r=a.length;r;)r--,s=a.shift(),Lava.schema.DEBUG&&""==s&&Lava.t("Malformed control attribute: "+i.name),r?(s in n||(n[s]={}),n=n[s],"object"!=typeof n&&Lava.t("Conflicting control attribute: "+i.name)):(s in n&&Lava.t("Conflicting control attribute: "+i.name),n[s]=i.value);else Lava.schema.DEBUG&&i.name in h&&h[i.name]!=i.value&&Lava.t("Duplicate attribute on tag: "+i.name),h[i.name]=i.value;for(o in c){e.x=c;break}for(o in h){e.attributes=h;break}},parseRawTag:function(e,t){var i={};return t&&this._parseControlAttributes(i,t),0==e.indexOf(this.CONTROL_ATTRIBUTE_PREFIX)?(i.type="directive",i.name=e.substr(this.CONTROL_ATTRIBUTE_PREFIX.length)):(i.type="tag",i.name=e),i},validateTagEnd:function(e,t){var i="directive"==e.type?this.CONTROL_ATTRIBUTE_PREFIX+e.name:e.name;i!=t&&Lava.t('End tag ("'+t+'") does not match the start tag ("'+i+'")')},parseDynamicBlockInit:function(e,t){var i=t.indexOf("/"),a=t.substr(0,i);Lava.schema.DEBUG&&-1==i&&Lava.t(),!Lava.schema.DEBUG||a[0]in Lava.parsers.Common.locator_types||Lava.t("Malformed class name locator: "+t),e.class_locator={locator_type:Lava.parsers.Common.locator_types[a[0]],name:a.substr(1)},e.real_class=t.substr(i),e.name=e.real_class.substr(1),!Lava.schema.DEBUG||e.class_locator.name&&e.class_locator.locator_type||Lava.t("Malformed class name locator: "+t)}},Lava.define("Lava.mixin.Observable",{isObservable:!0,_listeners:{},on:function(e,t,i,a){return this._addListener(e,t,i,a,this._listeners)},_addListener:function(e,t,i,a,n){Lava.schema.DEBUG&&!i&&Lava.t("Listener was created without a context");var s={event_name:e,fn:t,fn_original:t,context:i,listener_args:a};return null!=n[e]?n[e].push(s):n[e]=[s],s},removeListener:function(e){this._removeListener(e,this._listeners)},_removeListener:function(e,t){var i,a=t[e.event_name];a&&(i=a.indexOf(e),-1!=i&&(a.splice(i,1),0==a.length&&(t[e.event_name]=null)))},_fire:function(e,t){Lava.schema.DEBUG&&void 0===e&&Lava.t(),null!=this._listeners[e]&&this._callListeners(this._listeners[e],t)},_callListeners:function(e,t){for(var i,a=e.slice(),n=0,s=e.length;s>n;n++)i=a[n],i.fn.call(i.context,this,t,i.listener_args)},_hasListeners:function(e){return null!=this._listeners[e]}}),Lava.define("Lava.mixin.Properties",{Extends:"Lava.mixin.Observable",isProperties:!0,_properties:{},_property_listeners:{},init:function(e){for(var t in e)this._properties[t]=e[t]},get:function(e){return this._properties[e]},isset:function(e){return e in this._properties},set:function(e,t){this._properties[e]!==t&&this._set(e,t)},_set:function(e,t){this._properties[e]=t,this.firePropertyChangedEvents(e)},setProperties:function(e){Lava.schema.DEBUG&&e&&e.isProperties&&Lava.t("setProperties expects a plain JS object as an argument, not a class");for(var t in e)this.set(t,e[t])},getProperties:function(){var e={};return Firestorm.extend(e,this._properties),e},firePropertyChangedEvents:function(e){this._fire("property_changed",{name:e}),this._firePropertyChanged(e)},onPropertyChanged:function(e,t,i,a){return this._addListener(e,t,i,a,this._property_listeners)},removePropertyListener:function(e){this._removeListener(e,this._property_listeners)},_firePropertyChanged:function(e){Lava.schema.DEBUG&&null==e&&Lava.t("firePropertyChanged: property_name is null"),null!=this._property_listeners[e]&&this._callListeners(this._property_listeners[e])}}),Lava.define("Lava.mixin.Refreshable",{Extends:"Lava.mixin.Observable",isRefreshable:!0,level:0,_refresh_ticket:null,_last_refresh_id:0,_refresh_cycle_count:0,_value:null,refresh:function(e,t){if(this._refresh_ticket=null,this._last_refresh_id==e){if(this._refresh_cycle_count++,this._refresh_cycle_count>Lava.schema.system.REFRESH_INFINITE_LOOP_THRESHOLD&&!t)return!0}else this._last_refresh_id=e,this._refresh_cycle_count=0;return this._doRefresh(),!1},_doRefresh:function(){},_queueForRefresh:function(){this._refresh_ticket||(this._refresh_ticket=Lava.ScopeManager.scheduleScopeRefresh(this,this.level))},debugAssertClean:function(){this._refresh_ticket&&Lava.t("Refreshable::debugAssertClean() failed")},isWaitingRefresh:function(){return!!this._refresh_ticket},suspendRefreshable:function(){this._refresh_ticket&&(Lava.ScopeManager.cancelScopeRefresh(this._refresh_ticket,this.level),this._refresh_ticket=null)}}),Lava.define("Lava.animator.Integer",{property_name:null,from:0,delta:0,unit:null,init:function(e){this.property_name=e.property,this.from=e.from||0,this.delta=e.delta,this.unit=e.unit||"px"},animate:function(e,t){var i=this.from+this.delta*t;Firestorm.Element.setStyle(e,this.property_name,Math.floor(i)+this.unit)}}),Lava.define("Lava.animator.Color",{property_name:null,from:null,to:null,delta:null,init:function(e){this.property_name=e.property,this.from=e.from||[0,0,0],this.to=e.to||[0,0,0],this.delta=[this.to[0]-this.from[0],this.to[1]-this.from[1],this.to[2]-this.from[2]]},animate:function(e,t){var i=[Math.floor(this.from[0]+this.delta[0]*t),Math.floor(this.from[1]+this.delta[1]*t),Math.floor(this.from[2]+this.delta[2]*t)];Firestorm.Element.setStyle(e,this.property_name,"rgb("+i.join(",")+")")}}),Lava.define("Lava.animation.Abstract",{Extends:"Lava.mixin.Observable",_started_time:0,_end_time:0,_duration:0,_target:null,_is_running:!1,_is_reversed:!1,_config:null,_transition:null,guid:null,init:function(e,t){this.guid=Lava.guid++,e.duration&&(this._duration=e.duration),this._target=t,this._transition=e.transition||Lava.transitions[e.transition_name||"linear"],this._config=e},onTimer:function(){Lava.t("This method is assigned dynamically in constructor")},_finish:function(){this._is_running=!1,this._fire("complete")},safeStart:function(e){this._is_running||this.start(e)},reverseDirection:function(){this._is_reversed||this._mirror()},resetDirection:function(){this._is_reversed&&this._mirror()},_mirror:function(){if(this._is_reversed=!this._is_reversed,this._is_running){var e=(new Date).getTime(),t=2*e-this._started_time;e>this._end_time?(this._started_time=this._end_time,this._end_time=this._started_time+this._duration):(this._end_time=t,this._started_time=t-this._duration),this._afterMirror(e)}},_afterMirror:function(){},isRunning:function(){return this._is_running},getStartedTime:function(){return this._started_time},getEndTime:function(){return this._end_time},getDuration:function(){return this._duration},isReversed:function(){return this._is_reversed},getTarget:function(){return this._target},setTarget:function(e){this._target=e}}),Lava.define("Lava.animation.Standard",{Extends:"Lava.animation.Abstract",Shared:"_shared",_shared:{call_animators:[function(){},function(e){this._animators[0].animate(this._target,e)},function(e){this._animators[0].animate(this._target,e),this._animators[1].animate(this._target,e)},function(e){this._animators[0].animate(this._target,e),this._animators[1].animate(this._target,e),this._animators[2].animate(this._target,e)},function(e){this._animators[0].animate(this._target,e),this._animators[1].animate(this._target,e),this._animators[2].animate(this._target,e),this._animators[3].animate(this._target,e)}]},_percent:0,_animators:[],init:function(e,t){this.Abstract$init(e,t);var i,a=0,n=0;if("animators"in e)for(n=e.animators.length;n>a;a++)i=e.animators[a],this._animators.push(new Lava.animator[i.type](i));this._shared.call_animators.length<=n&&(this._callAnimators=this._shared.call_animators[n]),this.onTimer=this._animateDirect},_callAnimators:function(e){for(var t=0,i=this._animators.length;i>t;t++)this._animators[t].animate(this._target,e)},_animateDirect:function(e){e<this._end_time?this._callAnimators(this._transition((e-this._started_time)/this._duration)):(this._callAnimators(this._transition(1)),this._finish())},_animateReverse:function(e){e<this._end_time?this._callAnimators(this._transition(1-(e-this._started_time)/this._duration)):(this._callAnimators(this._transition(0)),this._finish())},start:function(e){var t=(new Date).getTime();this._started_time=e||t,this._end_time=this._started_time+this._duration,t<this._end_time?(this._is_running=!0,Lava.Cron.acceptTask(this),this.onTimer(t)):this.onTimer(this._end_time)},stop:function(){this._is_running=!1},_mirror:function(){this.onTimer=this._is_reversed?this._animateDirect:this._animateReverse,this.Abstract$_mirror()},finish:function(){this._is_running&&this.onTimer(this._end_time)},setDuration:function(e){this._duration=e,this._end_time=this._started_time+e}}),Lava.define("Lava.animation.Collapse",{Extends:"Lava.animation.Standard",_shared:{default_config:{transition_name:"outQuad",animators:[{type:"Integer",property:"height",delta:0}]}},_property:"height",DURATION_BIAS:200,init:function(e,t){var i={};Firestorm.extend(i,this._shared.default_config),Firestorm.extend(i,e),Lava.schema.DEBUG&&!i.animators[0].property&&Lava.t("Collapse: malformed animation config"),this._property=i.animators[0].property,this.Standard$init(i,t)},start:function(e){Firestorm.Element.setStyle(this._target,this._property,"auto");var t=Firestorm.Element.getSize(this._target)["width"==this._property?"x":"y"];this._animators[0].delta=t,this.setDuration(this.DURATION_BIAS+Math.floor(t)),this.Standard$start(e)},_finish:function(){this._is_reversed||Firestorm.Element.setStyle(this._target,this._property,"auto"),this.Standard$_finish()}}),Lava.define("Lava.animation.Toggle",{Extends:"Lava.animation.Standard",_finish:function(){Firestorm.Element.setStyle(this._target,"display",this._is_reversed?"none":"block"),this.Standard$_finish()}}),Lava.define("Lava.animation.Emulated",{Extends:"Lava.animation.Abstract",isEmulated:!0,_timeout:null,init:function(e,t){this.Abstract$init(e,t);var i=this;this.onTimer=function(){i._onTimeout()}},_onTimeout:function(){this._timeout=null,this._end(),this._finish()},_end:function(){},_cancelTimeout:function(){this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null)},start:function(){this._is_running&&this.stop(),this._is_running=!0,this._start(),this._timeout=window.setTimeout(this.onTimer,this._duration)},_start:function(){},stop:function(){this._is_running&&(this._is_running=!1,this._cancelTimeout())},_mirror:function(){this._is_running&&(this.stop(),this._reverse(),this._is_running=!0,this._timeout=window.setTimeout(this.onTimer,this._duration)),this._is_reversed=!this._is_reversed},_reverse:function(){},finish:function(){this._is_running&&(this._cancelTimeout(),this._onTimeout())}}),Lava.define("Lava.animation.BootstrapCollapse",{Extends:"Lava.animation.Emulated",_duration:350,_property:"height",_property_value:0,init:function(e,t){this.Emulated$init(e,t),e.property&&(this._property=e.property)},_start:function(){var e=Firestorm.Element;this._is_reversed?(this._property_value=e.getSize(this._target)["width"==this._property?"x":"y"],e.setStyle(this._target,this._property,""+this._property_value),this._target.offsetHeight,e.addClass(this._target,"collapsing"),e.removeClasses(this._target,["collapse","in"]),e.setStyle(this._target,this._property,"0")):(e.removeClass(this._target,"collapse"),e.setStyle(this._target,this._property,"auto"),this._property_value=e.getSize(this._target)["width"==this._property?"x":"y"],e.setStyle(this._target,this._property,"0"),this._target.offsetHeight,e.addClass(this._target,"collapsing"),e.setStyle(this._target,this._property,""+this._property_value))},_end:function(){var e=Firestorm.Element;this._is_reversed?(e.removeClass(this._target,"collapsing"),e.addClass(this._target,"collapse")):(e.removeClass(this._target,"collapsing"),e.addClasses(this._target,["collapse","in"]),e.setStyle(this._target,this._property,"auto"))},_reverse:function(){this._is_reversed?Firestorm.Element.setStyle(this._target,this._property,""+this._property_value):Firestorm.Element.setStyle(this._target,this._property,"0")}}),Lava.define("Lava.system.Serializer",{Shared:["_complex_types","_callback_map"],_complex_types:{array:!0,object:!0,"function":!0,regexp:!0},_callback_map:{string:"_serializeString",array:"_serializeArray",object:"_serializeObject","function":"_serializeFunction","boolean":"_serializeBoolean",number:"_serializeNumber",regexp:"_serializeRegexp","null":"_serializeNull",undefined:"_serializeUndefined"},_check_property_names:!0,_pad:"	",init:function(e){e&&e.check_property_names===!1&&(this._check_property_names=!1),this._serializeFunction=e&&e.pretty_print_functions?this._serializeFunction_PrettyPrint:this._serializeFunction_Normal},serialize:function(e){return this._serializeValue(e,"")},_serializeValue:function(e,t){var i,a=Firestorm.getType(e);return!Lava.schema.DEBUG||a in this._callback_map||Lava.t("Unsupported type for serialization: "+a),i=this[this._callback_map[a]](e,t)},_serializeArray:function(e,t){var i,a=[],n=0,s=e.length,r=t+"	";if(0==s)i="[]";else if(1==s)i="["+this._serializeValue(e[n],t)+"]";else{for(;s>n;n++)a.push(this._serializeValue(e[n],r));i="[\n	"+t+a.join(",\n	"+t)+"\n"+t+"]"}return i},_serializeString:function(e){return Firestorm.String.quote(e)},_serializeObject:function(e,t){var i,a,n,s=[],r=t+"	",o=!1,l=null,_=!0;for(i in e){if(null!==l){l=null;break}_=!1,l=i}if(l&&(a=Firestorm.getType(e[l]),a in this._complex_types&&(o=!0)),_)n="{}";else if(l&&!o)n="{"+this._serializeObjectProperty(l,e[l],r)+"}";else{for(i in e)s.push(this._serializeObjectProperty(i,e[i],r));n="{\n	"+t+s.join(",\n	"+t)+"\n"+t+"}"}return n},_serializeObjectProperty:function(e,t,i){var a=Firestorm.getType(t);return!this._check_property_names||Lava.VALID_PROPERTY_NAME_REGEX.test(e)&&-1==Lava.JS_KEYWORDS.indexOf(e)||(e=Firestorm.String.quote(e)),e+": "+this[this._callback_map[a]](t,i)},_serializeFunction:function(){Lava.t()},_serializeFunction_Normal:function(e){var t=e+"";return"function anonymous"==t.substr(0,18)&&(t="function"+t.substr(18)),t},_serializeFunction_PrettyPrint:function(e,t){var i,a,n=this._serializeFunction_Normal(e),s=n.split(/\r?\n/),r=s[s.length-1],o=1,l=s.length;if(/^\t*\}$/.test(r)){if(r.length>1)for(i=r.substr(0,r.length-1),a=i.length;l>o;o++)0==s[o].indexOf(i)&&(s[o]=s[o].substr(a));s.pop(),n=s.join("\r\n	"+t)+"\r\n"+t+r}return n},_serializeBoolean:function(e){return""+e},_serializeNumber:function(e){return""+e},_serializeRegexp:function(e){return""+e},_serializeNull:function(){return"null"},_serializeUndefined:function(){return"undefined"}}),Lava.define("Lava.system.CollectionAbstract",{Extends:"Lava.mixin.Properties",isCollection:!0,_data_uids:[],_data_values:[],_data_names:[],_count:0,guid:null,_setLength:function(e){this._count=e,this.firePropertyChangedEvents("length")},isEmpty:function(){return 0==this._count},getCount:function(){return this._count},get:function(e){return"length"==e?this._count:null},getUIDs:function(){return this._data_uids.slice()},getValues:function(){return this._data_values.slice()},getNames:function(){return this._data_names.slice()},getValuesHash:function(){for(var e={},t=0;t<this._count;t++)e[this._data_uids[t]]=this._data_values[t];return e},getUIDToIndexMap:function(){for(var e={},t=0;t<this._count;t++)e[this._data_uids[t]]=t;return e},getValueByLocalUID:function(e){var t=this._data_uids.indexOf(e);return-1!=t?this._data_values[t]:null},getUIDAt:function(e){return this._data_uids[e]},getValueAt:function(e){return this._data_values[e]},getNameAt:function(e){return this._data_names[e]},containsValue:function(e){return-1!=this._data_values.indexOf(e)},containsLocalUID:function(e){return-1!=this._data_uids.indexOf(e)},indexOfValue:function(e){return this._data_values.indexOf(e)},indexOfUID:function(e){return this._data_uids.indexOf(e)},set:function(){Lava.t("set on Enumerable is not permitted")},pop:function(){var e=this._data_uids.pop(),t=this._data_values.pop(),i=this._data_names.pop(),a=this._count-1;return this._setLength(a),this._fire("items_removed",{uids:[e],values:[t],names:[i]}),this._fire("collection_changed"),t},removeValue:function(e){var t=!1,i=this._data_values.indexOf(e);return-1!=i&&(this.removeAt(i),t=!0),t},swap:function(e,t){(e>this._count||t>this._count)&&Lava.t("Index is out of range (2)");var i=Firestorm.Array.swap;i(this._data_uids,e,t),i(this._data_values,e,t),i(this._data_names,e,t),this._fire("collection_changed")},each:function(e){for(var t=this._data_values.slice(),i=this._data_uids.slice(),a=this._data_names.slice(),n=0,s=this._count;s>n&&e(t[n],a[n],i[n],n)!==!1;n++);},filter:function(e){for(var t=0,i=this._count,a=this._createHelperStorage(),n=this._createHelperStorage();i>t;t++)e(this._data_values[t],this._data_names[t],this._data_uids[t],t)?a.push(this._data_uids[t],this._data_values[t],this._data_names[t]):n.push(this._data_uids[t],this._data_values[t],this._data_names[t]);this._assignStorage(a),this._setLength(this._data_uids.length),n.uids.length&&this._fire("items_removed",n.getObject()),this._fire("collection_changed")},sort:function(e,t){this._sort(e||Lava.DEFAULT_LESS,this._data_values,t)},sortByNames:function(e,t){this._sort(e||Lava.DEFAULT_LESS,this._data_names,t)},_sort:function(e,t,i){var a,n=[],s=0;for(a=function(i,a){return e(t[i],t[a])};s<this._count;s++)n.push(s);n=Lava.algorithms.sorting[i||Lava.schema.DEFAULT_STABLE_SORT_ALGORITHM](n,a),this.reorder(n)},reorder:function(e){var t,i=0,a=this._createHelperStorage(),n={};if(Lava.schema.DEBUG&&e.length!=this._count)throw"reorder: new item count is less than current";for(;i<this._count;i++)t=e[i],a.push(this._data_uids[t],this._data_values[t],this._data_names[t]),Lava.schema.DEBUG&&(t in n&&Lava.t("Malformed index array"),n[t]=null);this._assignStorage(a),this._fire("collection_changed")},removeRange:function(e,t){0>=t&&Lava.t("Invalid item count supplied for removeRange"),e+t>=this._count+1&&Lava.t("Index is out of range");var i=this._data_uids.splice(e,t),a=this._data_values.splice(e,t),n=this._data_names.splice(e,t);return this._setLength(this._count-t),this._fire("items_removed",{uids:i,values:a,names:n}),this._fire("collection_changed"),a},removeAll:function(){return this._count>0?this.removeRange(0,this._count):[]},removeAt:function(e){return this.removeRange(e,1)[0]},shift:function(){return this.removeRange(0,1)[0]},_createHelperStorage:function(){return{uids:[],values:[],names:[],push:function(e,t,i){this.uids.push(e),this.values.push(t),this.names.push(i)},getObject:function(){return{uids:this.uids,values:this.values,names:this.names}}}},_assignStorage:function(e){this._data_uids=e.uids,this._data_values=e.values,this._data_names=e.names},destroy:function(){this._fire("destroy")}}),Lava.define("Lava.system.Enumerable",{Extends:"Lava.system.CollectionAbstract",isEnumerable:!0,_uid:1,init:function(e){if(this.guid=Lava.guid++,e){var t,i=0,a=0;if(Array.isArray(e))for(i=e.length;i>a;a++)this._push(this._uid++,e[a],null);else if(e.isCollection)for(this._data_names=e.getNames(),this._data_values=e.getValues(),i=this._data_values.length;i>a;a++)this._data_uids.push(this._uid++);else{e.isProperties&&(e=e.getProperties());for(t in e)this._push(this._uid++,e[t],t)}this._count=this._data_uids.length}},refreshFromDataSource:function(e){Lava.schema.DEBUG&&"object"!=typeof e&&Lava.t("Wrong argument passed to updateFromSourceObject"),Array.isArray(e)?this._updateFromArray(e,[]):e.isCollection?this._updateFromEnumerable(e):this._updateFromObject(e.isProperties?e.getProperties():e)},_updateFromArray:function(e,t){var i=0,a=e.length,n={uids:this._data_uids,values:this._data_values,names:this._data_names};for(this._data_uids=[],this._data_values=[],this._data_names=[];a>i;i++)this._push(this._uid++,e[i],t[i]||null);this._setLength(a),this._fire("items_removed",n),this._fire("items_added",{uids:this._data_uids.slice(),values:this._data_values.slice(),names:this._data_names.slice()}),this._fire("collection_changed")},_updateFromEnumerable:function(e){this._updateFromArray(e.getValues(),e.getNames())},_updateFromObject:function(e){for(var t,i,a=0,n=this._createHelperStorage(),s=this._createHelperStorage(),r=this._createHelperStorage();a<this._count;a++)t=this._data_names[a],null!=t&&t in e?e[t]===this._data_values[a]?n.push(this._data_uids[a],this._data_values[a],this._data_names[a]):(s.push(this._data_uids[a],this._data_values[a],t),i=this._uid++,n.push(i,e[t],t),r.push(i,e[t],t)):s.push(this._data_uids[a],this._data_values[a],this._data_names[a]);for(t in e)-1==this._data_names.indexOf(t)&&(i=this._uid++,n.push(i,e[t],t),r.push(i,e[t],t));this._assignStorage(n),this._setLength(this._data_uids.length),s.uids.length&&this._fire("items_removed",s.getObject()),r.uids.length&&this._fire("items_added",r.getObject()),this._fire("collection_changed")},_push:function(e,t,i){this._data_uids.push(e),this._data_values.push(t),this._data_names.push(i)},replaceAt:function(e,t,i){e>this._count&&Lava.t("Index is out of range");var a=this._data_uids[e],n=this._data_values[e],s=this._data_names[e],r=this._uid++;this._data_uids[e]=r,this._data_values[e]=t,i&&(this._data_names[e]=i),this._fire("items_removed",{uids:[a],values:[n],names:[s]}),this._fire("items_added",{uids:[r],values:[t],names:[this._data_names[e]]}),this._fire("collection_changed")},push:function(e,t){var i=this._count,a=this._uid++;return this._push(a,e,t||null),this._setLength(i+1),this._fire("items_added",{uids:[a],values:[e],names:[t||null]}),this._fire("collection_changed"),this._count},includeValue:function(e,t){var i=!1,a=this._data_values.indexOf(e);return-1==a&&(this.push(e,t),i=!0),i},insertRange:function(e,t,i){e>=this._count&&Lava.t("Index is out of range");var a=0,n=t.length,s=[],r=[];if(i)n!=i.length&&Lava.t("If names array is provided, it must be equal length with values array."),r=i;else for(;n>a;a++)r.push(null);for(;n>a;a++)s.push(this._uid++);0==e?(this._data_uids=s.concat(this._data_uids),this._data_values=t.concat(this._data_values),this._data_names=r.concat(this._data_names)):e==this._count-1?(this._data_uids=this._data_uids.concat(s),this._data_values=this._data_values.concat(t),this._data_names=this._data_names.concat(r)):(this._data_uids=this._data_uids.slice(0,e).concat(s).concat(this._data_uids.slice(e)),this._data_values=this._data_values.slice(0,e).concat(t).concat(this._data_values.slice(e)),this._data_names=this._data_names.slice(0,e).concat(r).concat(this._data_names.slice(e))),this._setLength(this._count+n),this._fire("items_added",{uids:s,values:t,names:r}),this._fire("collection_changed")},append:function(e,t){this.insertRange(this._count,e,t)},insertAt:function(e,t,i){this.insertRange(e,[t],[i])},unshift:function(e,t){this.insertRange(0,[e],[t])}}),Lava.define("Lava.system.DataView",{Extends:"Lava.system.CollectionAbstract",isDataView:!0,_data_source:null,init:function(e){this.guid=Lava.guid++,e&&this.refreshFromDataSource(e)},refresh:function(){this._data_names=this._data_source.getNames(),this._data_values=this._data_source.getValues(),this._data_uids=this._data_source.getUIDs(),this._count=this._data_uids.length,this._fire("collection_changed")},setDataSource:function(e){Lava.schema.DEBUG&&!e.isCollection&&Lava.t("Wrong argument supplied for DataView constructor"),this._data_source=e},refreshFromDataSource:function(e){this.setDataSource(e),this.refresh()},getDataSource:function(){return this._data_source}}),Lava.define("Lava.system.Template",{Shared:["_block_handlers_map"],isTemplate:!0,_widget:null,_parent_view:null,_config:null,_count:0,_content:[],_is_inDOM:!1,guid:null,_block_handlers_map:{string:"_createDirect",view:"_createView",widget:"_createView",include:"_createInclude",static_value:"_createStaticValue",static_eval:"_createStaticEval",static_tag:"_createStaticTag"},init:function(e,t,i,a){this.guid=Lava.guid++,this._parent_view=i,this._widget=t,this._config=e,this._createChildren(this._content,e,[],a),this._count=this._content.length},_createChildren:function(e,t,i,a){for(var n,s,r=0,o=t.length;o>r;r++)n=t[r],s=typeof n,"object"==s&&(s=n.type),!Lava.schema.DEBUG||s in this._block_handlers_map||Lava.t("Unsupported template item type: "+s),this[this._block_handlers_map[s]](e,n,i,a)
},_createDirect:function(e,t){e.push(t)},_createView:function(e,t,i,a){var n=Lava.ClassManager.getConstructor(t["class"],"Lava.view"),s=new n(t,this._widget,this._parent_view,this,a);s.template_index=e.push(s)-1},_createInclude:function(e,t,i,a){-1!=i.indexOf(t.name)&&Lava.t("Infinite include recursion");var n=Lava.view_manager.getInclude(this._parent_view,t);Lava.schema.DEBUG&&null==n&&Lava.t("Include not found: "+t.name),i.push(t.name),this._createChildren(e,n,i,a),i.pop()},_createStaticValue:function(e,t){var i,a=t.resource_id,n=Lava.view_manager.locateTarget(this._widget,a.locator_type,a.locator);Lava.schema.RESOURCES_ENABLED||Lava.t("static_value: resources are disabled"),Lava.schema.DEBUG&&!n&&Lava.t("Resource owner not found: "+a.locator_type+"="+a.locator),i=n.getResource(a.name),Lava.schema.DEBUG&&!i&&Lava.t("static_value: resource not found: "+a.locator_type+"="+a.locator),Lava.schema.DEBUG&&-1==["string","number","boolean"].indexOf(Firestorm.getType(i.value))&&Lava.t("static_value: resource has wrong type"),e.push(i.value)},_createStaticEval:function(e,t){var i=new Lava.scope.Argument(t.argument,this._view,this._widget);i.isWaitingRefresh()&&(Lava.schema.DEBUG&&Lava.t("static_eval wrong usage: created argument is dirty"),Lava.logError("static_eval wrong usage: created argument is dirty")),e.push(i.getValue+""),i.destroy()},_createStaticTag:function(e,t,i,a){var n,s,r,o,l,_,c=t.resource_id,h="<"+t.name,u=[],d=Lava.isVoidTag(t.name);if(Lava.schema.RESOURCES_ENABLED&&(n=Lava.view_manager.locateTarget(this._widget,c.locator_type,c.locator),Lava.schema.DEBUG&&!n&&Lava.t("Resource owner not found: "+c.locator_type+"="+c.locator),s=n.getResource(c.name)),Lava.schema.DEBUG&&!Lava.schema.RESOURCES_ENABLED&&Lava.t("Unable to render a static container: resources are disabled"),Lava.schema.DEBUG&&!s&&Lava.t("Static container, resources not found: "+c.name),Lava.schema.DEBUG&&"container"!=s.type&&Lava.t("Malformed/invalid container resource: "+c.locator_type+"="+c.locator),o=s.value.static_properties,l=s.value.static_classes,_=s.value.static_styles,o&&(h+=Lava.parsers.Common.renderTagAttributes(o)),l&&(h+=' class="'+l.join(" ")+'"'),_){for(r in _)u.push(r+":"+_);h+=' style="'+u.join(";")+'"'}t.template?(Lava.schema.DEBUG&&d&&Lava.t(),e.push(h+">"),this._createChildren(e,t.template,i,a),e.push("</"+t.name+">")):(h+=d?"/>":"></"+t.name+">",e.push(h))},_broadcast:function(e){for(var t=0;t<this._count;t++)this._content[t].isView&&this._content[t][e]()},render:function(){for(var e="",t=0,i=this._content;t<this._count;t++)"string"==typeof i[t]?e+=i[t]:"function"==typeof i[t]?Lava.t("Not implemented"):e+=i[t].render();return e},broadcastRemove:function(){this._is_inDOM&&(this._is_inDOM=!1,this._broadcast("broadcastRemove"))},broadcastInDOM:function(){this._is_inDOM=!0,this._broadcast("broadcastInDOM")},batchSetProperty:function(e,t){for(var i=0;i<this._count;i++)this._content[i].isView&&this._content[i].set(e,t)},batchSetProperties:function(e){for(var t=0;t<this._count;t++)this._content[t].isView&&this._content[t].setProperties(e)},getFirstView:function(){return this._seekForwards(0)},getLastView:function(){return this._seekBackwards(this._count-1)},getPreviousView:function(e){return this._seekBackwards(e.template_index-1)},getNextView:function(e){return this._seekForwards(e.template_index+1)},_seekForwards:function(e){for(var t=null;e<this._count;){if(this._content[e].isView){t=this._content[e];break}e++}return t},_seekBackwards:function(e){for(var t=null;e>=0;){if(this._content[e].isView){t=this._content[e];break}e--}return t},getViewsByLabel:function(e){for(var t=[],i=0;i<this._count;i++)this._content[i].isView&&this._content[i].label==e&&t.push(this._content[i]);return t},getWidgetsByName:function(e){for(var t=[],i=0;i<this._count;i++)this._content[i].isWidget&&this._content[i].name==e&&t.push(this._content[i]);return t},getCount:function(){return this._count},getAt:function(e){return this._content[e]},isInDOM:function(){return this._is_inDOM},destroy:function(){this._broadcast("destroy"),this._content=null}}),Lava.define("Lava.system.ViewManager",{Extends:"Lava.mixin.Observable",_dirty_views:[],_is_refreshing:!1,_views_by_id:{},_views_by_guid:{},_global_role_targets:{},_global_event_targets:{},_old_mouseover_target:null,_old_mouseover_view_stack:[],_new_mouseover_target:null,_new_mouseover_view_stack:[],_event_usage_counters:{},_events_listeners:{mouseover:null,mouseout:null},_cancel_bubble:!1,_nested_dispatch_count:0,_refresh_id:0,init:function(){for(var e=Lava.schema.system.DEFAULT_EVENTS,t=0,i=e.length;i>t;t++)this._event_usage_counters[e[t]]=1,this._initEvent(e[t])},scheduleViewRefresh:function(e){e.depth in this._dirty_views?this._dirty_views[e.depth].push(e):this._dirty_views[e.depth]=[e]},refresh:function(){if(Lava.Core.isProcessingEvent())return void Lava.logError("ViewManager::refresh() must not be called inside event listeners");if(this._is_refreshing)return void Lava.logError("ViewManager: recursive call to refresh()");if(Lava.ScopeManager.refresh(),this._dirty_views.length){this._is_refreshing=!0,Lava.ScopeManager.lock(),this._refresh_id++;do{var e,t=this._dirty_views;this._dirty_views=[],e=this._refreshCycle(t)}while(this._dirty_views.length&&!e);Lava.ScopeManager.unlock(),this._is_refreshing=!1}},_refreshCycle:function(e){var t,i,a,n,s=0,r=!1;for(t=e.length;t>s;s++)if(s in e)for(i=e[s],a=0,n=i.length;n>a;a++)i[a].refresh(this._refresh_id)&&(Lava.logError("ViewManager: view was refreshed several times in one refresh loop. Aborting."),r=!0);return r},isRefreshing:function(){return this._is_refreshing},registerView:function(e){this._views_by_guid[e.guid]=e,e.id&&(Lava.schema.DEBUG&&e.id in this._views_by_id&&Lava.t("Duplicate view id: "+e.id),this._views_by_id[e.id]=e)},unregisterView:function(e){delete this._views_by_guid[e.guid],e.id&&delete this._views_by_id[e.id]},getViewById:function(e){return this._views_by_id[e]},getViewByGuid:function(e){return this._views_by_guid[e]},_locateWidgetById:function(e,t){return Lava.schema.DEBUG&&!t&&Lava.t(),this._views_by_id[t]},_locateWidgetByGuid:function(e,t){return Lava.schema.DEBUG&&!t&&Lava.t(),this._views_by_guid[t]},_locateWidgetByName:function(e,t){for(Lava.schema.DEBUG&&!t&&Lava.t();e&&e.name!=t;)e=e.getParentWidget();return e},_locateWidgetByLabel:function(e,t){if(Lava.schema.DEBUG&&!t&&Lava.t(),"root"==t)for(;e.getParentWidget();)e=e.getParentWidget();else for(;e&&e.label!=t;)e=e.getParentWidget();return e},locateTarget:function(e,t,i){return this["_locateWidgetBy"+t](e,i)},_dispatchCallback:function(e,t,i,a,n){var s,r,o,l,_,c,h=0,u=t.length,d=0;for(this._nested_dispatch_count++;u>h;h++)if(s=t[h],r=s.name,l="arguments"in s?this._evalTargetArguments(e,s):null,o=null,"locator_type"in s)o=this["_locateWidgetBy"+s.locator_type](e.getWidget(),s.locator),o?o.isWidget?i(o,r,e,l,a)||Lava.logError("ViewManager: targeted widget did not handle the role or event: "+r):Lava.logError("ViewManager: callback target is not a widget"):Lava.logError("ViewManager: callback target (widget) not found. Type: "+s.locator_type+", locator: "+s.locator),this._cancel_bubble=!1;else{o=e.getWidget();do i(o,r,e,l,a),o=o.getParentWidget();while(o&&!this._cancel_bubble);if(this._cancel_bubble){this._cancel_bubble=!1;continue}if(r in n)for(_=n[r].slice(),c=_.length;c>d;d++)if(i(_[d],r,e,l,a),this._cancel_bubble){this._cancel_bubble=!1;break}}this._nested_dispatch_count--},_callRegisterViewInRole:function(e,t,i,a){return e.handleRole(t,i,a)},dispatchRoles:function(e,t){this._dispatchCallback(e,t,this._callRegisterViewInRole,null,this._global_role_targets)},_callHandleEvent:function(e,t,i,a,n){return e.handleEvent(n.event_name,n.event_object,t,i,a)},_dispatchViewEvent:function(e,t,i){var a=e.getContainer().getEventTargets(t);a&&this.dispatchEvent(e,t,i,a)},dispatchEvent:function(e,t,i,a){this._dispatchCallback(e,a,this._callHandleEvent,{event_name:t,event_object:i},this._global_event_targets)},_evalTargetArguments:function(e,t){for(var i=[],a=0,n=t.arguments.length;n>a;a++)t.arguments[a].type==Lava.TARGET_ARGUMENT_TYPES.VALUE?i.push(t.arguments[a].data):(t.arguments[a].type!=Lava.TARGET_ARGUMENT_TYPES.BIND&&Lava.t(),i.push(e.evalPathConfig(t.arguments[a].data)));return i},getInclude:function(e,t){var i=e.getWidget(),a="arguments"in t?this._evalTargetArguments(e,t):null;return"locator_type"in t&&(i=this["_locateWidgetBy"+t.locator_type](i,t.locator),i&&i.isWidget||Lava.t()),i.getInclude(t.name,a)},addGlobalEventTarget:function(e,t){this._addTarget(this._global_event_targets,e,t)},removeGlobalEventTarget:function(e,t){this._removeTarget(this._global_event_targets,e,t)},addGlobalRoleTarget:function(e,t){this._addTarget(this._global_role_targets,e,t)},removeGlobalRoleTarget:function(e,t){this._removeTarget(this._global_role_targets,e,t)},_addTarget:function(e,t,i){t in e?-1==e[t].indexOf(i)?e[t].push(i):Lava.logError("[ViewManager] Duplicate target: "+t):e[t]=[i]},_removeTarget:function(e,t,i){t in e||Lava.t("Trying to remove a global event target for nonexistent event");var a=e[t].indexOf(i);-1!==a&&e[t].splice(a,1)},getViewByElement:function(e){var t=Firestorm.Element.getProperty(e,"id"),i=null;return t&&0==t.indexOf(Lava.ELEMENT_ID_PREFIX)&&(i=this.getViewByGuid(t.substr(Lava.ELEMENT_ID_PREFIX.length))),i},getViewsByLabel:function(e){var t=[];for(var i in this._views_by_guid)this._views_by_guid[i].label==e&&t.push(this._views_by_guid[i]);return t},handleMouseMovement:function(e,t){var i,a,n,s,r="mouseover"==e?t.target:t.relatedTarget,o=r?this._buildElementStack(r):[],l=[];if(this._new_mouseover_target!==r){if(this._fire("mouseover_stack_changed",o),r)for(n=0,s=o.length;s>n;n++)i=this.getViewByElement(o[n]),i&&(a=i.getContainer(),a.isElementContainer&&l.push(i));this._old_mouseover_target=this._new_mouseover_target,this._new_mouseover_target=r,this._old_mouseover_view_stack=this._new_mouseover_view_stack,this._new_mouseover_view_stack=l}if("mouseout"==e)for(n=0,s=this._old_mouseover_view_stack.length;s>n;n++)-1==this._new_mouseover_view_stack.indexOf(this._old_mouseover_view_stack[n])&&this._dispatchViewEvent(this._old_mouseover_view_stack[n],"mouseleave",t),this._dispatchViewEvent(this._old_mouseover_view_stack[n],"mouseout",t);else for(n=0,s=this._new_mouseover_view_stack.length;s>n;n++)this._dispatchViewEvent(this._new_mouseover_view_stack[n],"mouseover",t),-1==this._old_mouseover_view_stack.indexOf(this._new_mouseover_view_stack[n])&&this._dispatchViewEvent(this._new_mouseover_view_stack[n],"mouseenter",t)},_buildElementStack:function(e){for(var t=window.document,i=[];e&&e!=t;)i.push(e),e=e.parentNode;return Lava.schema.DEBUG&&Object.freeze&&Object.freeze(i),i},onDOMEvent:function(e,t){var i,a,n=t.target,s=e+"_stack_changed",r=n?this._buildElementStack(n):[],o=0,l=r.length;for(this._fire(s,r);l>o;o++)i=this.getViewByElement(r[o]),i&&(a=i.getContainer(),a.isElementContainer&&a.getEventTargets(e)&&this.dispatchEvent(i,e,t,a.getEventTargets(e)))},lendEvent:function(e){Lava.schema.DEBUG&&-1!=["mouseenter","mouseleave","mouseover","mouseout"].indexOf(e)&&Lava.t("The following events: mouseenter, mouseleave, mouseover and mouseout are served by common alias - mouse_events"),this._event_usage_counters[e]?this._event_usage_counters[e]++:(this._event_usage_counters[e]=1,this._initEvent(e))},_initEvent:function(e){"mouse_events"==e?(this._events_listeners.mouseover=Lava.Core.addGlobalHandler("mouseover",this.handleMouseMovement,this),this._events_listeners.mouseout=Lava.Core.addGlobalHandler("mouseout",this.handleMouseMovement,this)):this._events_listeners[e]=Lava.Core.addGlobalHandler(e,this.onDOMEvent,this)},releaseEvent:function(e){return 0==this._event_usage_counters[e]?void Lava.logError("ViewManager: trying to release an event with zero usage."):(this._event_usage_counters[e]--,void(0==this._event_usage_counters[e]&&this._shutdownEvent(e)))},isEventRouted:function(e){return this._event_usage_counters[e]>0},_shutdownEvent:function(e){"mouse_events"==e?(Lava.Core.removeGlobalHandler(this._events_listeners.mouseover),this._events_listeners.mouseover=null,Lava.Core.removeGlobalHandler(this._events_listeners.mouseout),this._events_listeners.mouseout=null):(Lava.Core.removeGlobalHandler(this._events_listeners[e]),this._events_listeners[e]=null)},cancelBubble:function(){return this._nested_dispatch_count?void(this._cancel_bubble=!0):void Lava.logError("Call to cancelBubble outside of dispatch cycle")},destroy:function(){for(var e in this._events_listeners)this._events_listeners[e]&&(Lava.Core.removeGlobalHandler(this._events_listeners[e]),this._events_listeners[e]=null,this._event_usage_counters[e]=0)}}),Lava.define("Lava.system.App",{Extends:"Lava.mixin.Observable",_modules:{},getModule:function(e){if(!(e in this._modules)){var t=Lava.schema.modules[e],i=t.type||Lava.schema.data.DEFAULT_MODULE_CLASS,a=Lava.ClassManager.getConstructor(i,"Lava.data");this._modules[e]=new a(this,t,e),this._modules[e].initFields()}return this._modules[e]},fireGlobalEvent:function(e,t){this._fire(e,t)},destroy:function(){for(var e in this._modules)this._modules[e].destroy()}}),Lava.define("Lava.system.Sugar",{_root_map:{include:"_parseInclude",storage:"_parseStorage",union:"_parseUnion",storage_object:"_parseStorageObject"},_union_handlers:{include:"_parseInclude"},_root_attributes_handlers:{expressions_option:"_parseRootExpressionsOptionAttribute",targets_option:"_parseRootTargetsOptionAttribute",property:"_parseRootPropertyAttribute","switch":"_parseRootSwitchAttribute",option:"_parseRootOptionAttribute",id:"_parseRootIdAttribute"},parse:function(e,t,i){var a,n,s=Lava.parsers.Common.createDefaultWidgetConfig(),r=t.x;if(s["extends"]=i,t.content&&(Lava.isVoidTag(t.name)||!e.content_schema?(a=Lava.parsers.Common.asBlocks(t.content),a=this._applyTopDirectives(a,s),Lava.schema.DEBUG&&a.length&&Lava.t("Widget is not allowed to have any content: "+t.name)):(!Lava.schema.DEBUG||e.content_schema.type in this._root_map||Lava.t("Unknown type of content in sugar: "+e.content_schema.type),this[this._root_map[e.content_schema.type]](e.content_schema,t,s,e.content_schema.name))),t.attributes&&this._parseRootAttributes(e,t,s),r){if(Lava.schema.DEBUG&&r)for(n in r)-1==["label","roles","resource_id","controller"].indexOf(n)&&Lava.t("Control attribute is not allowed on sugar: "+n);"label"in r&&this.setViewConfigLabel(s,r.label),"roles"in r&&(s.roles=Lava.parsers.Common.parseTargets(r.roles)),"resource_id"in r&&(s.resource_id=Lava.parsers.Common.parseResourceId(r.resource_id)),"controller"in r&&(s.real_class=r.controller)}return s},_applyTopDirectives:function(e,t){for(var i=0,a=e.length,n=[];a>i;i++){if("directive"!=e[i].type){n=e.slice(i);break}Lava.parsers.Directives.processDirective(e[i],t,!0)&&Lava.t("Directive inside sugar has returned a value: "+e[i].name)}return n},_parseInclude:function(e,t,i,a){Lava.schema.DEBUG&&!a&&Lava.t("Sugar: name for include is not provided"),Lava.store(i,"includes",a,t.content?Lava.parsers.Common.compileTemplate(t.content,i):[])},_parseStorage:function(e,t,i){var a=Lava.parsers.Common.asBlocks(t.content);a=this._applyTopDirectives(a,i),a.length&&Lava.parsers.Storage.parse(i,a)},_parseUnion:function(e,t,i){var a,n,s=Lava.parsers.Common.asBlocks(t.content),r=0,o=e.tag_roles,l=[];for(s=this._applyTopDirectives(s,i),a=s.length;a>r;r++)s[r].name in o?(n=o[s[r].name],this[this._union_handlers[n.type]](n,s[r],i,n.name||s[r].name)):l.push(s[r]);l.length&&Lava.parsers.Storage.parse(i,l)},_parseStorageObject:function(e,t,i){var a=Lava.parsers.Common.asBlocks(t.content);a=this._applyTopDirectives(a,i),a.length&&Lava.parsers.Storage.parse(i,[{type:"tag",name:e.name,content:a}])},_parseRootAttributes:function(e,t,i){var a,n,s={};for(a in t.attributes)Lava.schema.DEBUG&&"id"!=a&&!e.attribute_mappings&&Lava.t("Sugar schema is missing attribute mappings for: "+a),n="id"==a?{type:"id"}:e.attribute_mappings[a],n?this[this._root_attributes_handlers[n.type]](i,t.attributes[a],n,n.name||a):s[a]=t.attributes[a];Firestorm.Object.isEmpty(s)||(Lava.schema.DEBUG&&!e.root_resource_name&&Lava.t("Sugar: unknown attribute: "+a+", for widget: "+t.name),this._storeAttributesAsResource(i,s,e.root_resource_name))},_storeAttributesAsResource:function(e,t,i){var a={type:"container_stack",value:[]},n=a.value;e.resources||(e.resources={}),e.resources["default"]||(e.resources["default"]={}),"class"in t&&(n.push({name:"add_classes",value:t["class"].trim().split(/\s+/)}),delete t["class"]),"style"in t&&(n.push({name:"add_styles",value:Lava.parsers.Common.parseStyleAttribute(t.style)}),delete t.style),Firestorm.Object.isEmpty(t)||n.push({name:"add_properties",value:Firestorm.Object.copy(t)}),Lava.resources.putResourceValue(e.resources["default"],i,a)},_parseRootIdAttribute:function(e,t){Lava.schema.DEBUG&&(!Lava.isValidId(t)||"id"in e)&&Lava.t(),e.id=t},_parseRootOptionAttribute:function(e,t,i,a){Lava.store(e,"options",a,Lava.valueToType(i,t))},_parseRootSwitchAttribute:function(e,t,i,a){Lava.store(e,"options",a,""==t?!0:Lava.types.Boolean.fromString(t))},_parseRootPropertyAttribute:function(e,t,i,a){Lava.store(e,"properties",a,Lava.valueToType(i,t))},_parseRootTargetsOptionAttribute:function(e,t,i,a){Lava.store(e,"options",a,Lava.parsers.Common.parseTargets(t))},_parseRootExpressionsOptionAttribute:function(e,t,i,a){Lava.store(e,"options",a,Lava.ExpressionParser.parse(t,Lava.ExpressionParser.SEPARATORS.SEMICOLON))}}),Lava.define("Lava.system.PopoverManager",{_mouseover_stack_changed_listener:null,_tooltip_target:null,_attribute_name:"data-tooltip",_mousemove_listener:null,_tooltip:null,DEFAULT_TOOLTIP_WIDGET:"Tooltip",enable:function(){this._mouseover_stack_changed_listener||(Lava.view_manager.lendEvent("mouse_events"),this._mouseover_stack_changed_listener=Lava.view_manager.on("mouseover_stack_changed",this._onMouseoverStackChanged,this),this._tooltip||(this._tooltip=Lava.createWidget(this.DEFAULT_TOOLTIP_WIDGET)),this._tooltip.inject(document.body,"Bottom"))},disable:function(){this._mouseover_stack_changed_listener&&(Lava.view_manager.releaseEvent("mouse_events"),Lava.view_manager.removeListener(this._mouseover_stack_changed_listener),this._mouseover_stack_changed_listener=null,this._mousemove_listener&&(Lava.Core.removeGlobalHandler(this._mousemove_listener),this._mousemove_listener=null),this._tooltip.set("is_visible",!1),this._tooltip.remove())},isEnabled:function(){return null!=this._mouseover_stack_changed_listener},_onMouseoverStackChanged:function(e,t){for(var i,a=null,n=0,s=t.length;s>n;n++)if(Firestorm.Element.hasAttribute(t[n],this._attribute_name)){a=t[n];break}a!=this._tooltip_target&&(this._tooltip_target?a||(Lava.Core.removeGlobalHandler(this._mousemove_listener),this._mousemove_listener=null,this._tooltip.set("is_visible",!1)):(Lava.schema.DEBUG&&this._mousemove_listener&&Lava.t(),this._mousemove_listener=Lava.Core.addGlobalHandler("mousemove",this._onMouseMove,this),this._tooltip.set("is_visible",!0)),a&&(i=Firestorm.Element.getAttribute(a,this._attribute_name).replace(/\r?\n/g,"<br/>"),this._tooltip.set("html",i),this._tooltip.set("is_visible",!(!i&&Lava.schema.popover_manager.HIDE_EMPTY_TOOLTIPS))),this._tooltip_target=a)},_onMouseMove:function(e,t){this._tooltip.set("x",t.page.x),this._tooltip.set("y",t.page.y)},destroy:function(){this.isEnabled()&&this.disable()}}),Lava.define("Lava.system.FocusManager",{Extends:"Lava.mixin.Observable",_focused_element:null,_focus_target:null,_focus_acquired_listener:null,_focus_lost_listener:null,_focus_listener:null,_blur_listener:null,enable:function(){this._focus_acquired_listener||(this._focus_acquired_listener=Lava.app.on("focus_acquired",this._onFocusTargetAcquired,this),this._focus_lost_listener=Lava.app.on("focus_lost",this.clearFocusedTarget,this),this._focus_listener=Lava.Core.addGlobalHandler("blur",this._onElementBlurred,this),this._blur_listener=Lava.Core.addGlobalHandler("focus",this._onElementFocused,this))},disable:function(){this._focus_acquired_listener&&(Lava.app.removeListener(this._focus_acquired_listener),Lava.app.removeListener(this._focus_lost_listener),Lava.Core.removeGlobalHandler(this._focus_listener),Lava.Core.removeGlobalHandler(this._blur_listener),this._focus_acquired_listener=this._focused_element=this._focus_target=null)},isEnabled:function(){return null!=this._focus_acquired_listener},getFocusedTarget:function(){return this._focus_target},getFocusedElement:function(){return this._focused_element},_setTarget:function(e){this._focus_target!=e&&(this._focus_target=e,this._fire("focus_target_changed",e))},_onElementBlurred:function(){this._setTarget(null),this._focused_element=null},_onElementFocused:function(e,t){this._focused_element!=t.target&&(this._setTarget(null),this._focused_element=t.target)},_onFocusTargetAcquired:function(e,t){this._setTarget(t.target),this._focused_element=t.element},clearFocusedTarget:function(){this._setTarget(null)},blur:function(){this._focused_element&&(this._focused_element.blur(),this._focused_element=document.activeElement||null),this._setTarget(null)},destroy:function(){this.isEnabled()&&this.disable()}}),Lava.define("Lava.data.field.Abstract",{Extends:"Lava.mixin.Observable",_name:null,_module:null,_config:null,_properties_by_guid:null,_is_nullable:!1,init:function(e,t,i,a){this._module=e,this._name=t,this._config=i,this._properties_by_guid=a,"is_nullable"in i&&(this._is_nullable=i.is_nullable)},onModuleFieldsCreated:function(){},isValidValue:function(e){return void 0!==e&&(null!==e||this._is_nullable)},getInvalidReason:function(e){var t=null;return void 0===e?t="Undefined is not a valid value":null!=e||this._is_nullable||(t="Cannot assign null to non-nullable field"),t},isNullable:function(){return this._is_nullable},initNewRecord:function(){},"import":function(){},"export":function(){Lava.t("Abstract function call: export")},getValue:function(){Lava.t("Abstract function call: getValue")},setValue:function(){Lava.t("Abstract function call: setValue")},_fireFieldChangedEvents:function(e){this._fire("changed",{record:e}),e.firePropertyChangedEvents(this._name)},_getImportValue:function(e,t){return Lava.schema.data.VALIDATE_IMPORT_DATA&&!this.isValidValue(t[this._name])&&Lava.t("Invalid value in import data ("+this._name+"): "+t[this._name]),t[this._name]},isLess:function(e,t){return this._properties_by_guid[e.guid][this._name]<this._properties_by_guid[t.guid][this._name]},isEqual:function(e,t){return this._properties_by_guid[e.guid][this._name]==this._properties_by_guid[t.guid][this._name]},destroy:function(){this._properties_by_guid=this._module=null}}),Lava.define("Lava.data.field.Basic",{Extends:"Lava.data.field.Abstract",_default:null,init:function(e,t,i,a){this.Abstract$init(e,t,i,a),"default"in i&&(this._default=i["default"]),this._is_nullable||null!=this._default||Lava.t("Non-nullable Basic fields must have a default value"),Lava.schema.DEBUG&&!this.isValidValue(this._default)&&Lava.t("Field was configured with invalid default value. Module: "+this._module.getName()+", field name: "+this._name)},onModuleFieldsCreated:function(e){e[this._name]=this._default},"import":function(e,t,i){this._name in i&&(t[this._name]=this._getImportValue(t,i))},"export":function(e,t){t[this._name]=this._properties_by_guid[e.guid][this._name]},getValue:function(e,t){return t[this._name]},setValue:function(e,t,i){t[this._name]!==i&&(this.isValidValue(i)||Lava.t("[Field name="+this._name+"] Invalid field value: "+i+". Reason: "+this.getInvalidReason(i)),t[this._name]=i,this._fireFieldChangedEvents(e))}}),Lava.define("Lava.data.field.Collection",{Extends:"Lava.data.field.Abstract",isCollectionField:!0,_target_module:null,_target_record_field_name:null,_target_record_field:null,_record_removed_listener:null,_record_added_listener:null,_collections_by_record_guid:{},_collection_listeners_by_guid:{},_collection_guid_to_record:{},init:function(e,t,i,a){this.Abstract$init(e,t,i,a),Lava.schema.DEBUG&&!i.record_field&&Lava.t("Missing corresponding Record field. Record fields are used by Collection fields."),this._target_record_field_name=i.record_field},onModuleFieldsCreated:function(){this._target_module="this"==this._config.module?this._module:this._module.getApp().getModule(this._config.module),this._target_record_field=this._target_module.getField(this._target_record_field_name),this._record_removed_listener=this._target_record_field.on("removed_child",this._onRecordRemoved,this),this._record_added_listener=this._target_record_field.on("added_child",this._onRecordAdded,this),this._target_record_field.isRecordField||Lava.t("CollectionField: mirror field is not Record field"),this._target_record_field.getReferencedModule()!==this._module&&Lava.t("CollectionField: module mismatch with mirror Record field")},_onRecordRemoved:function(e,t){var i=t.collection_owner;i.guid in this._collections_by_record_guid&&(Lava.suspendListener(this._collection_listeners_by_guid[i.guid].removed),this._collections_by_record_guid[i.guid].removeValue(t.child),Lava.resumeListener(this._collection_listeners_by_guid[i.guid].removed))},_onRecordAdded:function(e,t){var i=t.collection_owner;i.guid in this._collections_by_record_guid&&(Lava.suspendListener(this._collection_listeners_by_guid[i.guid].added),this._collections_by_record_guid[i.guid].includeValue(t.child),Lava.suspendListener(this._collection_listeners_by_guid[i.guid].added))},isValidValue:function(){return!1},getInvalidReason:function(){return"Collection field does not support setValue"},"import":function(e,t,i){if(i[this._name]){Lava.schema.data.VALIDATE_IMPORT_DATA&&!Array.isArray(i[this._name])&&Lava.t("Invalid value in import data");for(var a=0,n=this._target_module.loadRecords(i[this._name]),s=n.length;s>a;a++)n[a].set(this._target_record_field_name,e)}},"export":function(){},getValue:function(e){var t,i=e.guid;return i in this._collections_by_record_guid||(t=new Lava.system.Enumerable(this._target_record_field.getCollection(e)),this._collections_by_record_guid[i]=t,this._collection_listeners_by_guid[i]={added:t.on("items_added",this._onCollectionRecordsAdded,this),removed:t.on("items_removed",this._onCollectionRecordsRemoved,this)},this._collection_guid_to_record[t.guid]=e),this._collections_by_record_guid[i]},_onCollectionRecordsAdded:function(e,t){this._setCollectionOwner(t.values,this._collection_guid_to_record[e.guid])},_onCollectionRecordsRemoved:function(e,t){this._setCollectionOwner(t.values,null)},_setCollectionOwner:function(e,t){for(var i,a=0,n=e.length;n>a;a++)i=e[a],i.set(this._target_record_field_name,t)},getCount:function(e){return this._target_record_field.getCollectionCount(e)},setValue:function(){Lava.t("Trying to set Collection field value")},isLess:function(e,t){return this._target_record_field.getCollectionCount(e)<this._target_record_field.getCollectionCount(t)},isEqual:function(e,t){return this._target_record_field.getCollectionCount(e)==this._target_record_field.getCollectionCount(t)},destroy:function(){var e;for(e in this._collections_by_record_guid)this._collections_by_record_guid[e].destroy();this._target_record_field.removeListener(this._record_removed_listener),this._target_record_field.removeListener(this._record_added_listener),this._target_module=this._collections_by_record_guid=this._collection_listeners_by_guid=this._collection_guid_to_record=this._target_record_field=null,this.Abstract$destroy()}}),Lava.define("Lava.data.field.Integer",{Extends:"Lava.data.field.Basic",VALID_VALUE_REGEX:/^(\-|\+)?([1-9]\d*|0)$/,isValidValue:function(e){return null===e&&this._is_nullable||"number"==typeof e&&this.VALID_VALUE_REGEX.test(e)},getInvalidReason:function(e){var t=this.Basic$getInvalidReason(e);return t||("number"!=typeof e?t="Value is not a number":this.VALID_VALUE_REGEX.test(e)&&(t="Value is not an integer")),t}}),Lava.define("Lava.data.field.Id",{Extends:"Lava.data.field.Abstract",VALID_VALUE_REGEX:/^[1-9]\d*$/,_is_nullable:!0,init:function(e,t,i,a){Lava.schema.DEBUG&&("is_nullable"in i||"default"in i)&&Lava.t("Standard ID field can not be configured as nullable or have a default value"),this.Abstract$init(e,t,i,a)},onModuleFieldsCreated:function(e){e[this._name]=null},isValidValue:function(e){return null===e&&this._is_nullable||"number"==typeof e&&this.VALID_VALUE_REGEX.test(e)},getInvalidReason:function(e){var t=this.Abstract$getInvalidReason(e);return t||("number"!=typeof e?t="Value is not a number":this.VALID_VALUE_REGEX.test(e)&&(t="Valid values for ID field are positive integers")),t},"import":function(e,t,i){this._name in i?t[this._name]=this._getImportValue(t,i):Lava.t("Import record must have an ID")},"export":function(e,t){t[this._name]=this._properties_by_guid[e.guid][this._name]},getValue:function(e,t){return t[this._name]},setValue:function(){Lava.t("Standard id field must not be set")}}),Lava.define("Lava.data.field.ForeignKey",{Extends:"Lava.data.field.Basic",isForeignKey:!0,_collections_by_foreign_id:{},_default:0,initNewRecord:function(e,t){this._registerByForeignKey(e,t[this._name]),this.Basic$initNewRecord(e,t)},"import":function(e,t,i){this._registerByForeignKey(e,i[this._name]||t[this._name]),this.Basic$import(e,t,i)},_registerByForeignKey:function(e,t){t in this._collections_by_foreign_id?this._collections_by_foreign_id[t].push(e):this._collections_by_foreign_id[t]=[e]},setValue:function(e,t,i){Firestorm.Array.exclude(this._collections_by_foreign_id[t[this._name]],e),this._registerByForeignKey(e,i),this.Basic$setValue(e,t,i)},getCollection:function(e){return e in this._collections_by_foreign_id?this._collections_by_foreign_id[e].slice():[]},destroy:function(){this._collections_by_foreign_id=null,this.Basic$destroy()}}),Lava.define("Lava.data.field.Record",{Extends:"Lava.data.field.Abstract",isRecordField:!0,_referenced_module:null,_collections_by_foreign_guid:{},_foreign_key_field_name:null,_foreign_key_field:null,_foreign_key_changed_listener:null,_external_id_field:null,_external_id_changed_listener:null,_external_records_loaded_listener:null,EMPTY_FOREIGN_ID:0,_is_nullable:!0,init:function(e,t,i,a){this.Abstract$init(e,t,i,a),this._referenced_module="this"==i.module?e:e.getApp().getModule(i.module)},onModuleFieldsCreated:function(e){this._config.foreign_key_field&&(Lava.schema.DEBUG&&!this._referenced_module.hasField("id")&&Lava.t("field/Record: the referenced module must have an ID field"),this._foreign_key_field_name=this._config.foreign_key_field,this._foreign_key_field=this._module.getField(this._foreign_key_field_name),Lava.schema.DEBUG&&!this._foreign_key_field.isForeignKey&&Lava.t(),this._foreign_key_changed_listener=this._foreign_key_field.on("changed",this._onForeignKeyChanged,this),this._external_id_field=this._referenced_module.getField("id"),this._external_id_changed_listener=this._external_id_field.on("changed",this._onExternalIdCreated,this),this._external_records_loaded_listener=this._referenced_module.on("records_loaded",this._onReferencedModuleRecordsLoaded,this)),e[this._name]=null},_onReferencedModuleRecordsLoaded:function(e,t){for(var i,a,n,s,r=t.records,o=r.length,l=0;o>l;l++)for(i=this._foreign_key_field.getCollection(r[l].get("id")),a=i.length,n=0;a>n;n++)s=i[n],this._properties_by_guid[s.guid][this._name]=r[l],this._fireFieldChangedEvents(s)},_onExternalIdCreated:function(e,t){var i,a,n=t.record,s=n.get("id"),r=0;if(n.guid in this._collections_by_foreign_guid&&(i=this._collections_by_foreign_guid[n.guid],this._foreign_key_field)){for(Lava.suspendListener(this._foreign_key_changed_listener),a=i.length;a>r;r++)i[r].set(this._foreign_key_field_name,s);Lava.resumeListener(this._foreign_key_changed_listener)}},_onForeignKeyChanged:function(e,t){var i=t.record,a=this._properties_by_guid[i.guid];null!=a[this._name]&&this._unregisterRecord(i,a[this._name]),a[this._foreign_key_field_name]?this._registerByReferencedId(i,a,a[this._foreign_key_field_name]):a[this._name]=null,this._fireFieldChangedEvents(i)},isValidValue:function(e){return null===e&&this._is_nullable||void 0!==e&&e.isRecord&&e.getModule()===this._referenced_module
},getInvalidReason:function(e){var t=this.Abstract$getInvalidReason(e);return t||(e.isRecord?e.getModule()===this._referenced_module&&(t="Value is from different module than this field refers to"):t="Value is not record"),t},initNewRecord:function(e,t){this._foreign_key_field&&t[this._foreign_key_field_name]&&this._registerByReferencedId(e,t,t[this._foreign_key_field_name])},"import":function(e,t,i){var a;this._foreign_key_field&&(a=i[this._foreign_key_field_name]||t[this._foreign_key_field_name],a&&this._registerByReferencedId(e,t,a))},_registerByReferencedId:function(e,t,i){t[this._name]=this._referenced_module.getRecordById(i)||null,t[this._name]&&this._registerRecord(e,t[this._name])},"export":function(){},getValue:function(e,t){return t[this._name]},setValue:function(e,t,i){this.isValidValue(i)||Lava.t("Field/Record: assigned value is not valid. Reason: "+this.getInvalidReason(i)),null!=t[this._name]&&this._unregisterRecord(e,t[this._name]),t[this._name]=i,null!=i&&this._registerRecord(e,i),this._foreign_key_field&&(Lava.suspendListener(this._foreign_key_changed_listener),null!=i?e.set(this._foreign_key_field_name,i.get("id")):e.set(this._foreign_key_field_name,this.EMPTY_FOREIGN_ID),Lava.resumeListener(this._foreign_key_changed_listener)),this._fireFieldChangedEvents(e)},_unregisterRecord:function(e,t){Firestorm.Array.exclude(this._collections_by_foreign_guid[t.guid],e)||Lava.t(),this._fire("removed_child",{collection_owner:t,child:e})},_registerRecord:function(e,t){var i=t.guid;i in this._collections_by_foreign_guid?(Lava.schema.DEBUG&&-1!=this._collections_by_foreign_guid[i].indexOf(e)&&Lava.t("Duplicate record"),this._collections_by_foreign_guid[i].push(e)):this._collections_by_foreign_guid[i]=[e],this._fire("added_child",{collection_owner:t,child:e})},getCollection:function(e){return e.guid in this._collections_by_foreign_guid?this._collections_by_foreign_guid[e.guid].slice():[]},getCollectionCount:function(e){var t=this._collections_by_foreign_guid[e.guid];return t?t.length:0},getReferencedModule:function(){return this._referenced_module},_getComparisonValue:function(e){!Lava.schema.DEBUG||e.guid in this._properties_by_guid||Lava.t("isLess: record does not belong to this module");var t=this._properties_by_guid[e.guid][this._name];return t?t.get("id"):void 0},isLess:function(e,t){return this._getComparisonValue(e)<this._getComparisonValue(t)},isEqual:function(e,t){return this._getComparisonValue(e)==this._getComparisonValue(t)},destroy:function(){this._config.foreign_key_field&&(this._foreign_key_field.removeListener(this._foreign_key_changed_listener),this._external_id_field.removeListener(this._external_id_changed_listener)),this._referenced_module.removeListener(this._external_records_loaded_listener),this._referenced_module=this._collections_by_foreign_guid=this._foreign_key_field=this._external_id_field=null,this.Abstract$destroy()}}),Lava.define("Lava.data.field.Boolean",{Extends:"Lava.data.field.Basic",_default:!1,isValidValue:function(e){return null===e&&this._is_nullable||"boolean"==typeof e},getInvalidReason:function(e){var t=this.Basic$getInvalidReason(e);return t||"boolean"==typeof e||(t="Value is not boolean type"),t}}),Lava.define("Lava.data.field.Guid",{Extends:"Lava.data.field.Abstract","export":function(e,t){t.guid=e.guid},getValue:function(e){return e.guid},setValue:function(){Lava.t("Guid field is read only")}}),Lava.define("Lava.data.ModuleAbstract",{Extends:"Lava.mixin.Observable",_config:null,_fields:{},_records:[],_records_by_guid:{},_properties_by_guid:{},_record_constructor:null,_createFields:function(e){var t,i,a;for(t in e.fields)i=e.fields[t].type||Lava.schema.data.DEFAULT_FIELD_TYPE,a=Lava.ClassManager.getConstructor(i,"Lava.data.field"),this._fields[t]=new a(this,t,e.fields[t],this._properties_by_guid)},initFields:function(){var e,t={};for(e in this._fields)this._fields[e].onModuleFieldsCreated(t);this._createRecordProperties=Function("return "+Lava.serializer.serialize(t))},_createRecordProperties:function(){Lava.t("Module requires initialization")},getAllRecords:function(){return this._records.slice()},getCount:function(){return this._records.length},destroy:function(){var e;for(e in this._fields)this._fields[e].destroy();this._records=this._records_by_guid=this._properties_by_guid=this._fields=null}}),Lava.define("Lava.data.Module",{Extends:"Lava.data.ModuleAbstract",_app:null,_name:null,_records_by_id:{},_has_id:!1,init:function(e,t,i){this._app=e,this._config=t,this._name=i,this._createFields(t),this._record_constructor=Lava.ClassManager.getConstructor(t.record_class||Lava.schema.data.DEFAULT_RECORD_CLASS,"Lava.data"),"id"in this._fields&&(this._has_id=!0,this._fields.id.on("changed",this._onRecordIdChanged,this))},_onRecordIdChanged:function(e,t){var i=t.record.get("id");i in this._records_by_id&&Lava.t("Duplicate record id in module "+this._name),this._records_by_id[i]=t.record},hasField:function(e){return e in this._fields},getField:function(e){return this._fields[e]},getRecordById:function(e){return this._records_by_id[e]},getRecordByGuid:function(e){return this._records_by_guid[e]},getApp:function(){return this._app},safeLoadRecord:function(e){var t;return Lava.schema.DEBUG&&!e.id&&Lava.t("safeLoadRecord: import data must have an id"),t=e.id in this._records_by_id?this._records_by_id[e.id]:this.loadRecord(e)},loadRecord:function(e){var t=this._createRecordInstance(e);return this._fire("records_loaded",{records:[t]}),t},createRecord:function(){var e=this._createRecordInstance();return this._fire("records_created",{records:[e]}),e},_createRecordInstance:function(e){var t=this._createRecordProperties(),i=new this._record_constructor(this,this._fields,t,e);return t.id&&(t.id in this._records_by_id&&Lava.t("Duplicate record id in module "+this._name),this._records_by_id[t.id]=i),this._records.push(i),this._properties_by_guid[i.guid]=t,this._records_by_guid[i.guid]=i,i},loadRecords:function(e){for(var t=0,i=e.length,a=[];i>t;t++)a.push(this._createRecordInstance(e[t]));return this._fire("records_loaded",{records:a}),a},destroy:function(){this._records_by_id=null,this.ModuleAbstract$destroy()}}),Lava.define("Lava.data.Record",{Implements:"Lava.mixin.Properties",isRecord:!0,_properties:null,_module:null,_fields:null,guid:null,init:function(e,t,i,a){this.guid=Lava.guid++,this._module=e,this._fields=t,this._properties=i;var n;if(void 0!==a)for(n in t)t[n]["import"](this,i,a);else for(n in t)t[n].initNewRecord(this,i)},get:function(e){return!Lava.schema.DEBUG||e in this._fields||Lava.t("[Record] No such field: "+e),this._fields[e].getValue(this,this._properties)},set:function(e,t){!Lava.schema.DEBUG||e in this._fields||Lava.t("[Record] No such field: "+e),this._fields[e].setValue(this,this._properties,t)},getModule:function(){return this._module},"export":function(){var e={};for(var t in this._fields)this._fields[t]["export"](this,e);return e}}),Lava.define("Lava.data.MetaRecord",{Extends:"Lava.data.Record",isMetaRecord:!0,ext_guid:0,_original_record:null,init:function(e,t,i,a,n){this.Record$init(e,t,i,a),n&&(this._original_record=n)},getOriginalRecord:function(){return this._original_record}}),Lava.define("Lava.data.MetaStorage",{Extends:"Lava.data.ModuleAbstract",Implements:"Lava.mixin.Properties",init:function(e){"id"in e.fields&&Lava.t("Id field in MetaStorage is not permitted"),this._config=e,this._createFields(e),this.initFields();var t;if(Lava.schema.DEBUG)for(t in this._fields)(this._fields[t].isCollectionField||this._fields[t].isRecordField)&&Lava.t("Standard Collection and Record fields will not work inside the MetaStorage");this._record_constructor=Lava.ClassManager.getConstructor("MetaRecord","Lava.data")},get:function(e){return this._properties[e]},set:function(){Lava.t("MetaStorage: set operation is not permitted")},createMetaRecord:function(e,t,i){e in this._properties&&Lava.t("MetaRecord already exists");var a=this._createRecordProperties(),n=new this._record_constructor(this,this._fields,a,t,i);return n.ext_guid=e,this._records.push(n),this._properties_by_guid[n.guid]=a,this._records_by_guid[n.guid]=n,this._properties[e]=n,this.firePropertyChangedEvents(e),n}}),Lava.define("Lava.scope.Abstract",{Extends:"Lava.mixin.Refreshable",isValueContainer:!0,_data_bindings_by_property:{},_data_segments:{},getDataBinding:function(e){return e in this._data_bindings_by_property||(this._data_bindings_by_property[e]=new Lava.scope.DataBinding(this,e)),this._data_bindings_by_property[e]},getSegment:function(e){return Lava.schema.DEBUG&&!e.guid&&Lava.t("Only PropertyBinding and DataBinding may be used as name source for segments"),e.guid in this._data_segments||(this._data_segments[e.guid]=new Lava.scope.Segment(this,e)),this._data_segments[e.guid]},destroy:function(){var e;for(e in this._data_bindings_by_property)this._data_bindings_by_property[e].destroy();for(e in this._data_segments)this._data_segments[e].destroy();this.suspendRefreshable()}}),Lava.define("Lava.scope.Argument",{Extends:"Lava.mixin.Refreshable",isValueContainer:!0,_view:null,_widget:null,_evaluator:null,guid:null,_binds:[],_binds_count:0,_bind_changed_listeners:[],_modifier_descriptors:[],init:function(e,t,i){this.guid=Lava.guid++,this._view=t,this._widget=i,this._evaluator=e.evaluator;var a,n,s=0,r=e.binds;if(r){for(a=r.length;a>s;s++)n=r[s].isDynamic?t.locateViewByPathConfig(r[s]).getDynamicScope(t,r[s]):t.getScopeByPathConfig(r[s]),this._binds.push(n),this._bind_changed_listeners.push(n.on("changed",this.onBindingChanged,this)),this.level<n.level&&(this.level=n.level);this.level++}if("modifiers"in e)for(s=0,a=e.modifiers.length;a>s;s++)this._modifier_descriptors.push({widget:this.getWidgetByModifierConfig(e.modifiers[s]),callback_name:e.modifiers[s].callback_name});this._binds_count=this._binds.length,this._value=this._evaluate()},getWidgetByModifierConfig:function(e){var t=this._widget.locateViewByPathConfig(e);return Lava.schema.DEBUG&&!t.isWidget&&Lava.t("Tried to call a modifier from non-widget view"),t},onBindingChanged:function(){this._queueForRefresh()},_evaluate:function(){var e=null;if(Lava.schema.DEBUG)e=this._evaluator();else try{e=this._evaluator()}catch(t){Lava.logException(t)}return e},getValue:function(){return this._value},_doRefresh:function(){var e,t=this._evaluate();t!==this._value&&(e={old_value:this._value},this._value=t,this._fire("changed",e))},_callModifier:function(e,t){return this._modifier_descriptors[e].widget.callModifier(this._modifier_descriptors[e].callback_name,t)},_callActiveModifier:function(){},_callGlobalModifier:function(e,t){return!Lava.schema.DEBUG||e in Lava.modifiers||Lava.t("Unknown global modifier: "+e),Lava.modifiers[e].apply(Lava.modifiers,t)},destroy:function(){for(var e=0,t=this._bind_changed_listeners.length;t>e;e++)this._binds[e].removeListener(this._bind_changed_listeners[e]);this._bind_changed_listeners=null,this.suspendRefreshable()}}),Lava.define("Lava.scope.Binding",{_scope:null,_widget:null,_property_name:null,_scope_changed_listener:null,_widget_property_changed_listener:null,init:function(e,t){this._widget=t,this._property_name=e.property_name,this._scope=t.getScopeByPathConfig(e.path_config),e.from_widget?this._scope.setValue(this._widget.get(this._property_name)):(this._widget.set(this._property_name,this._scope.getValue()),this._scope_changed_listener=this._scope.on("changed",this.onScopeChanged,this)),this._scope.isSetValue||Lava.t("Binding: bound scope does not implement setValue"),this._widget_property_changed_listener=t.onPropertyChanged(this._property_name,this.onWidgetPropertyChanged,this)},onScopeChanged:function(){this._scope.isConnected()&&(Lava.suspendListener(this._widget_property_changed_listener),this._scope_changed_listener&&Lava.suspendListener(this._scope_changed_listener),this._widget.set(this._property_name,this._scope.getValue()),Lava.resumeListener(this._widget_property_changed_listener),this._scope_changed_listener&&Lava.resumeListener(this._scope_changed_listener))},onWidgetPropertyChanged:function(){Lava.suspendListener(this._widget_property_changed_listener),this._scope_changed_listener&&Lava.suspendListener(this._scope_changed_listener),this._scope.setValue(this._widget.get(this._property_name)),Lava.resumeListener(this._widget_property_changed_listener),this._scope_changed_listener&&Lava.resumeListener(this._scope_changed_listener)},destroy:function(){this._scope_changed_listener&&this._scope.removeListener(this._scope_changed_listener),this._widget.removePropertyListener(this._widget_property_changed_listener)}}),Lava.define("Lava.scope.DataBinding",{Extends:"Lava.scope.Abstract",isSetValue:!0,guid:null,_property_name:null,_value_container:null,_container_changed_listener:null,_property_changed_listener:null,_enumerable_changed_listener:null,_property_container:null,_is_connected:!1,init:function(e,t){this.guid=Lava.guid++,this._value_container=e,this._property_name=t,this.level=e.level+1,this._container_changed_listener=e.on("changed",this.onParentDataSourceChanged,this),this._refreshValue(),Lava.schema.DEBUG&&Lava.ScopeManager.debugTrackScope(this)},_refreshValue:function(){var e=this._value_container.getValue(),t=null,i=!1;null!=e&&(e.isCollection&&/^\d+$/.test(this._property_name)?(null==this._enumerable_changed_listener&&(this._enumerable_changed_listener=e.on("collection_changed",this.onValueChanged,this),this._property_container=e),t=e.getValueAt(+this._property_name)):e.isProperties?(null==this._property_changed_listener&&(this._property_changed_listener=e.onPropertyChanged(this._property_name,this.onValueChanged,this),this._property_container=e),t=e.get(this._property_name)):t=e[this._property_name],i=!0),(t!==this._value||this._is_connected!=i)&&(this._value=t,this._is_connected=i,this._fire("changed"))},isConnected:function(){return this._is_connected},onParentDataSourceChanged:function(){this._property_changed_listener&&this._value_container.getValue()!=this._property_container&&(this._property_changed_listener&&this._property_container.removePropertyListener(this._property_changed_listener),this._enumerable_changed_listener&&this._property_container.removeListener(this._enumerable_changed_listener),this._property_changed_listener=null,this._enumerable_changed_listener=null,this._property_container=null),this._queueForRefresh()},_doRefresh:function(){this._refreshValue()},onValueChanged:function(){this._queueForRefresh()},setValue:function(e){var t=this._value_container.getValue();t&&(this._property_changed_listener?(Lava.suspendListener(this._property_changed_listener),t.set(this._property_name,e),Lava.resumeListener(this._property_changed_listener)):this._enumerable_changed_listener?(Lava.suspendListener(this._enumerable_changed_listener),t.replaceAt(+this._property_name,e),Lava.resumeListener(this._enumerable_changed_listener)):t.isProperties?t.set(this._property_name,e):t[this._property_name]=e,this._queueForRefresh())},getValue:function(){return this._value},destroy:function(){this._value_container.removeListener(this._container_changed_listener),this._property_changed_listener&&this._property_container.removePropertyListener(this._property_changed_listener),this._enumerable_changed_listener&&this._property_container.removeListener(this._enumerable_changed_listener),this._property_container=null,Lava.schema.DEBUG&&Lava.ScopeManager.debugStopTracking(this),this.Abstract$destroy()}}),Lava.define("Lava.scope.Foreach",{Extends:"Lava.mixin.Refreshable",isValueContainer:!0,_argument:null,_argument_changed_listener:null,_view:null,_widget:null,guid:null,_observable_listener:null,_observable:null,_own_collection:!1,_config:null,_binds:null,_bind_changed_listeners:null,init:function(e,t,i,a){var n,s,r,o=0;if(this.guid=Lava.guid++,this._argument=e,this._view=t,this._widget=i,this.level=e.level+1,a&&(Lava.schema.DEBUG&&-1==["Enumerable","DataView"].indexOf(a.own_enumerable_mode)&&Lava.t("Unknown value in own_enumerable_mode option: "+a.own_enumerable_mode),"DataView"==a.own_enumerable_mode?(this._refreshDataSource=this._refreshDataSource_DataView,this._value=new Lava.system.DataView):(this._refreshDataSource=this._refreshDataSource_Enumerable,this._value=new Lava.system.Enumerable),this._own_collection=!0,a.depends))for(s=a.depends,this._binds=[],this._bind_changed_listeners=[],n=s.length;n>o;o++)r=s[o].isDynamic?t.locateViewByPathConfig(s[o]).getDynamicScope(t,s[o]):t.getScopeByPathConfig(s[o]),this._binds.push(r),this._bind_changed_listeners.push(r.on("changed",this._onDependencyChanged,this));this._argument_changed_listener=this._argument.on("changed",this.onDataSourceChanged,this),this.refreshDataSource()},_onDependencyChanged:function(){this._queueForRefresh()},_refreshDataSource:function(e){e.isCollection?(this._own_collection&&(this._value.destroy(),this._own_collection=!1,this._value=null),this._value!=e&&(this._value=e,this._fire("new_enumerable"))):this._own_collection?this._value.refreshFromDataSource(e):this._createCollection(e)},_refreshDataSource_Enumerable:function(e){Lava.schema.DEBUG&&!e.isCollection&&Lava.t("Argument result must be Enumerable"),this._value.refreshFromDataSource(e)},_refreshDataSource_DataView:function(e){Lava.schema.DEBUG&&!e.isCollection&&Lava.t("Argument result must be Enumerable"),this._value.getDataSource()!=e&&this._fire("new_enumerable"),this._value.refreshFromDataSource(e)},refreshDataSource:function(){var e=this._argument.getValue();e?(this._refreshDataSource(e),null==this._observable_listener&&(e.isCollection?(this._observable_listener=e.on("collection_changed",this._onObservableChanged,this),this._observable=e):e.isProperties&&(this._observable_listener=e.on("property_changed",this._onObservableChanged,this),this._observable=e))):this._own_collection?this._value.removeAll():this._createCollection(null),this._fire("after_refresh"),this._fire("changed")},createsOwnEnumerable:function(){return this._config.own_enumerable_mode},_createCollection:function(e){this._value=new Lava.system.Enumerable(e),this._own_collection=!0,this._fire("new_enumerable")},_flushObservable:function(){this._observable.removeListener(this._observable_listener),this._observable_listener=null,this._observable=null},onDataSourceChanged:function(){this._observable_listener&&this._flushObservable(),this._queueForRefresh()},_onObservableChanged:function(){this._queueForRefresh()},_doRefresh:function(){this.refreshDataSource()},getValue:function(){return this._value},destroy:function(){if(this._binds){for(var e=0,t=this._binds.length;t>e;e++)this._binds[e].removeListener(this._bind_changed_listeners[e]);this._binds=this._bind_changed_listeners=null}this._argument.removeListener(this._argument_changed_listener),this._observable_listener&&this._flushObservable(),this._own_collection&&this._value.destroy(),this.suspendRefreshable()}}),Lava.define("Lava.scope.PropertyBinding",{Extends:"Lava.scope.Abstract",isSetValue:!0,guid:null,_property_name:null,_view:null,_property_changed_listener:null,_assign_argument:null,init:function(e,t,i){this.guid=Lava.guid++,this._view=e,this._property_name=t,i?(this._assign_argument=new Lava.scope.Argument(i,e,e.getWidget()),this._assign_argument.on("changed",this.onAssignChanged,this),this._value=this._assign_argument.getValue(),e.set(this._property_name,this._value),this.level=this._assign_argument.level+1):(this.level=e.depth||0,this._value=e.get(this._property_name),this._property_changed_listener=e.onPropertyChanged(t,this.onContainerPropertyChanged,this)),Lava.schema.DEBUG&&Lava.ScopeManager.debugTrackScope(this)},isConnected:function(){return!0},onAssignChanged:function(){this._view.set(this._property_name,this._assign_argument.getValue()),this._queueForRefresh()},onContainerPropertyChanged:function(){this._queueForRefresh()},getValue:function(){return this._value},setValue:function(e){Lava.suspendListener(this._property_changed_listener),this._view.set(this._property_name,e),Lava.resumeListener(this._property_changed_listener),this._queueForRefresh()},_doRefresh:function(){var e=this._view.get(this._property_name);e!==this._value&&(this._value=e,this._fire("changed"))},destroy:function(){this._assign_argument?this._assign_argument.destroy():this._view.removePropertyListener(this._property_changed_listener),Lava.schema.DEBUG&&Lava.ScopeManager.debugStopTracking(this),this.Abstract$destroy()}}),Lava.define("Lava.scope.Segment",{Extends:"Lava.scope.Abstract",isSetValue:!0,_container:null,_name_source_container:null,_name_source_changed_listener:null,_property_name:null,_data_binding:null,_data_binding_changed_listener:null,init:function(e,t){Lava.schema.DEBUG&&!t.isValueContainer&&Lava.t(),Lava.schema.DEBUG&&!t.guid&&Lava.t("Name source for segments must be either PropertyBinding or DataBinding"),this._container=e,this._property_name=t.getValue(),this._refreshDataBinding(),e.isRefreshable&&(this.level=e.level),this.level=this.level>t.level?this.level:t.level,this.level++,this._name_source_container=t,this._name_source_changed_listener=t.on("changed",this.onPropertyNameChanged,this),this._value=this._data_binding.getValue(),Lava.schema.DEBUG&&Lava.ScopeManager.debugTrackScope(this)},isConnected:function(){return this._data_binding||Lava.t(),this._data_binding.isConnected()},_refreshDataBinding:function(){this._data_binding=this._container.getDataBinding(this._property_name),this._data_binding_changed_listener=this._data_binding.on("changed",this.onDataBindingChanged,this)},_destroyDataBinding:function(){this._data_binding.removeListener(this._data_binding_changed_listener),this._data_binding=null,this._data_binding_changed_listener=null},onDataBindingChanged:function(){this._queueForRefresh()},_doRefresh:function(){null==this._data_binding&&this._refreshDataBinding();var e=this._data_binding.getValue();e!==this._value&&(this._value=e,this._fire("changed"))},onPropertyNameChanged:function(){this._property_name=this._name_source_container.getValue(),this._destroyDataBinding(),this._queueForRefresh()},getValue:function(){return this._value},setValue:function(e){this._data_binding&&this._data_binding.setValue(e)},destroy:function(){this._name_source_container.removeListener(this._name_source_changed_listener),this._data_binding_changed_listener&&this._data_binding.removeListener(this._data_binding_changed_listener),Lava.schema.DEBUG&&Lava.ScopeManager.debugStopTracking(this),this.Abstract$destroy()}}),Lava.define("Lava.view.container.Element",{isElementContainer:!0,_id:null,_view:null,_config:null,_widget:null,_tag_name:null,_static_classes:[],_class_bindings:null,_class_bindings_values:{},_static_styles:{},_style_bindings:null,_static_properties:{},_property_bindings:null,_events:{},_is_inDOM:!1,_element:null,_is_void:!1,_is_element_owner:!0,init:function(e,t,i){var a="ios"==Firestorm.Environment.platform;Lava.ClassManager.patch(this,"Element","addEventTarget",a?"addEventTarget_IOS":"addEventTarget_Normal"),Lava.ClassManager.patch(this,"Element","informInDOM",a?"informInDOM_IOS":"informInDOM_Normal"),this.init_Normal(e,t,i),Lava.ClassManager.patch(this,"Element","init","init_Normal")},init_Normal:function(e,t,i){var a,n,s,r,o,l;this._id=Lava.ELEMENT_ID_PREFIX+e.guid,this._view=e,this._config=t,this._widget=i,this._tag_name=t.tag_name,this._is_void=Lava.isVoidTag(this._tag_name),Lava.schema.RESOURCES_ENABLED&&t.resource_id&&(n=Lava.view_manager.locateTarget(i,t.resource_id.locator_type,t.resource_id.locator),Lava.schema.DEBUG&&!n&&Lava.t("[Element container] resource owner not found: "+t.resource_id.locator_type+"="+t.resource_id.locator),s=n.getResource(t.resource_id.name)),Lava.schema.RESOURCES_ENABLED&&s?(Lava.schema.DEBUG&&"container"!=s.type&&Lava.t("Element container: received resource type is not container: "+s.type),r=s.value.static_classes,o=s.value.static_properties,l=s.value.static_styles):(r=t.static_classes,o=t.static_properties,l=t.static_styles),Lava.schema.DEBUG&&o&&"id"in o&&Lava.t("Element container: id must not be set via resources or be in config.static_properties"),r&&(this._static_classes=r.slice());for(a in l)this._static_styles[a]=l[a];for(a in o)this._static_properties[a]=o[a];for(a in t.events)this._events[a]=Firestorm.clone(t.events[a]);this._property_bindings=this._createArguments(t.property_bindings,e,this._onPropertyBindingChanged),this._style_bindings=this._createArguments(t.style_bindings,e,this._onStyleBindingChanged),this._class_bindings=this._createArguments(t.class_bindings,e,this._onClassBindingChanged);for(a in this._class_bindings)this._class_bindings_values[a]=this._toClassNames(this._class_bindings[a].getValue()||"")},getEventTargets:function(e){return this._events[e]},addEventTarget:function(){Lava.t()},addEventTarget_IOS:function(e,t){!this._is_inDOM||"click"!=e||e in this._events||(this.getDOMElement().onclick=Lava.noop),this.addEventTarget_Normal(e,t)},addEventTarget_Normal:function(e,t){e in this._events?this._events[e].push(t):this._events[e]=[t]},setProperty:function(e,t){this.storeProperty(e,t),this._is_inDOM&&this.syncProperty(e)},storeProperty:function(e,t){Lava.schema.DEBUG&&"id"==e&&Lava.t(),Lava.schema.DEBUG&&e in this._property_bindings&&Lava.t("Property is bound to an argument and cannot be set directly: "+e),this._static_properties[e]=t},getProperty:function(e){return this._static_properties[e]},syncProperty:function(e){Firestorm.Element.setProperty(this.getDOMElement(),e,this._static_properties[e])},addClass:function(e,t){!Lava.schema.DEBUG||e&&-1==e.indexOf(" ")||Lava.t("addClass: expected one class name, got: "+e),Firestorm.Array.include(this._static_classes,e)&&this._is_inDOM&&!t&&Firestorm.Element.addClass(this.getDOMElement(),e)},removeClass:function(e,t){Firestorm.Array.exclude(this._static_classes,e)&&this._is_inDOM&&!t&&Firestorm.Element.removeClass(this.getDOMElement(),e)},addClasses:function(e,t){Lava.schema.DEBUG&&"string"==typeof e&&Lava.t();for(var i=0,a=e.length;a>i;i++)this.addClass(e[i],t)},hasStaticClass:function(e){return-1!=this._static_classes.indexOf(e)},syncClasses:function(){Firestorm.Element.setClass(this.getDOMElement(),this._renderClasses())},setStyle:function(e,t,i){null==t?this.removeStyle(e,i):(this._static_styles[e]=t,this._is_inDOM&&!i&&Firestorm.Element.setStyle(this.getDOMElement(),e,t))},removeStyle:function(e,t){e in this._static_styles&&(delete this._static_styles[e],this._is_inDOM&&!t&&Firestorm.Element.setStyle(this.getDOMElement(),e,null))},getStyle:function(e){return this._static_styles[e]},syncStyles:function(){Firestorm.Element.setProperty(this.getDOMElement(),"style",this._renderStyles())},_createArguments:function(e,t,i){var a,n={};for(var s in e)a=new Lava.scope.Argument(e[s],t,this._widget),n[s]=a,a.on("changed",i,this,{name:s});return n},_onPropertyBindingChanged:function(e,t,i){if(this._is_inDOM){var a=e.getValue();null!=a&&a!==!1?(a===!0&&(a=i.name),Firestorm.Element.setProperty(this.getDOMElement(),i.name,a)):Firestorm.Element.removeProperty(this.getDOMElement(),i.name)}},_onStyleBindingChanged:function(e,t,i){var a=this._style_bindings[i.name].getValue()||"";this._is_inDOM&&Firestorm.Element.setStyle(this.getDOMElement(),i.name,(""+a).trim())},_toClassNames:function(e){var t=[];return Lava.schema.view.VALIDATE_CLASS_NAMES&&this.assertClassStringValid(e),""!=e&&(t=e.split(/\s+/)),t},_onClassBindingChanged:function(e,t,i){var a=this._toClassNames((""+e.getValue()).trim());this._is_inDOM&&(Firestorm.Element.removeClasses(this.getDOMElement(),this._class_bindings_values[i.name]),Firestorm.Element.addClasses(this.getDOMElement(),a)),this._class_bindings_values[i.name]=a},assertStyleValid:function(e){/\"\<\>/.test(e)&&Lava.t("Invalid symbols in style value: "+e+". Please, use single quotes for string values and manually escape special characters.")},assertClassStringValid:function(e){/\'\"\<\>\&\./.test(e)&&Lava.t("Invalid class names: "+e)},_renderClasses:function(){var e,t,i=this._static_classes.clone();for(e in this._class_bindings)i.push(this._class_bindings[e].getValue());return t=i.join(" "),Lava.schema.view.VALIDATE_CLASS_NAMES&&this.assertClassStringValid(t),t},_renderStyles:function(){var e,t,i=[];for(e in this._static_styles)i.push(e+":"+this._static_styles[e]);for(e in this._style_bindings)t=this._style_bindings[e].getValue(),null!=t&&i.push(e+":"+(""+t).trim());return t=i.join(";"),Lava.schema.view.VALIDATE_STYLES&&this.assertStyleValid(t),t},_renderAttribute:function(e,t){var i="";return t===!0?i=" "+e+'="'+e+'"':null!=t&&t!==!1&&(i=" "+e+'="'+this.escapeAttributeValue(t+"")+'"'),i},_renderOpeningTag:function(){var e,t=this._renderClasses(),i=this._renderStyles(),a="";for(e in this._static_properties)a+=this._renderAttribute(e,this._static_properties[e]);for(e in this._property_bindings)a+=this._renderAttribute(e,this._property_bindings[e].getValue());return t&&(a+=' class="'+t+'"'),i&&(a+=' style="'+i+'"'),"<"+this._tag_name+' id="'+this._id+'" '+a},wrap:function(e){return Lava.schema.DEBUG&&this._is_void&&Lava.t("Trying to wrap content in void tag"),this._renderOpeningTag()+">"+e+"</"+this._tag_name+">"},renderVoid:function(){return Lava.schema.DEBUG&&!this._is_void&&Lava.t("Trying to render non-void container as void"),this._renderOpeningTag()+"/>"},setHTML:function(e){this._is_inDOM||Lava.t("setHTML: element is not in DOM"),this._is_void&&Lava.t("setHTML on void tag"),Firestorm.Element.setProperty(this.getDOMElement(),"html",e)},appendHTML:function(e){Firestorm.DOM.insertHTMLBottom(this.getDOMElement(),e)},prependHTML:function(e){Firestorm.DOM.insertHTMLTop(this.getDOMElement(),e)},insertHTMLAfter:function(e){Firestorm.DOM.insertHTMLAfter(this.getDOMElement(),e)},insertHTMLBefore:function(e){Firestorm.DOM.insertHTMLBefore(this.getDOMElement(),e)},informInDOM:function(){Lava.t()},informInDOM_IOS:function(){this.informInDOM_Normal(),this.getDOMElement().onclick=Lava.noop},informInDOM_Normal:function(){this._is_inDOM=!0,this._element=null},informRemove:function(){this._is_inDOM=!1,this._element=null},getDOMElement:function(){return!this._element&&this._is_inDOM&&(this._element=Firestorm.getElementById(this._id)),this._element},getStartElement:function(){return this.getDOMElement()},getEndElement:function(){return this.getDOMElement()},getId:function(){return this._id},isInDOM:function(){return this._is_inDOM},isVoid:function(){return this._is_void},release:function(){this._element=null},_withArguments:function(e,t){var i;for(i in this._property_bindings)this._property_bindings[i][e](t);for(i in this._style_bindings)this._style_bindings[i][e](t);for(i in this._class_bindings)this._class_bindings[i][e](t)},captureExistingElement:function(e){var t,i=Firestorm.Element;this._is_inDOM&&Lava.t("Can not set duplicate id attribute on elements"),i.getProperty(e,"id")&&Lava.t("Target element already has an ID, and could be owned by another container"),i.getProperty(e,"tag").toLowerCase()!=this._tag_name&&Lava.t("Captured tag name differs from the container's tag name"),i.setProperty(e,"id",this._id),this._is_inDOM=!0,this._element=e;for(t in this._static_properties)i.setProperty(e,t,this._static_properties[t]);for(t in this._property_bindings)i.setProperty(e,t,this._property_bindings[t].getValue());this.syncClasses(),this.syncStyles(),this._is_element_owner=!1},releaseElement:function(){this.setHTML(""),Firestorm.Element.removeProperty(this.getDOMElement(),"id"),this.informRemove(),this._is_element_owner=!0},isElementOwner:function(){return this._is_element_owner},escapeAttributeValue:function(e){return Firestorm.String.escape(e,Firestorm.String.ATTRIBUTE_ESCAPE_REGEX)},remove:function(){this._is_inDOM||Lava.t("remove: container is not in DOM"),Firestorm.Element.destroy(this.getDOMElement())},destroy:function(){var e;for(e in this._property_bindings)this._property_bindings[e].destroy();for(e in this._style_bindings)this._style_bindings[e].destroy();for(e in this._class_bindings)this._class_bindings[e].destroy()}}),Lava.define("Lava.view.container.CheckboxElement",{Extends:"Lava.view.container.Element",_IE_click_callback:null,init:function(e,t,i){var a="ie"==Firestorm.Environment.browser_name,n=a?"init_IE":"Element$init";
Lava.ClassManager.patch(this,"CheckboxElement","informInDOM",a?"informInDOM_IE":"Element$informInDOM"),Lava.ClassManager.patch(this,"CheckboxElement","informRemove",a?"informRemove_IE":"Element$informRemove"),this[n](e,t,i),Lava.ClassManager.patch(this,"CheckboxElement","init",n)},init_IE:function(e,t,i){this.Element$init(e,t,i);var a=this;this._IE_click_callback=function(){a._events.compatible_changed&&Lava.view_manager.dispatchEvent(a._view,"compatible_changed",null,a._events.compatible_changed)}},informInDOM:function(){Lava.t()},informRemove:function(){Lava.t()},informInDOM_IE:function(){this.Element$informInDOM();var e=this.getDOMElement();Firestorm.Element.addListener(e,"click",this._IE_click_callback)},informRemove_IE:function(){var e=this.getDOMElement();Firestorm.Element.removeListener(e,"click",this._IE_click_callback),this.Element$informRemove()}}),Lava.define("Lava.view.container.TextInputElement",{Extends:"Lava.view.container.Element",_OldIE_refresh_callback:null,_OldIE_property_change_callback:null,init:function(e,t,i){var a=Firestorm.Environment.capabilities[Firestorm.CAPABILITY_NAMES.NEEDS_INPUT_EVENT_SHIM],n=a?"init_IE":"Element$init";Lava.ClassManager.patch(this,"TextInputElement","informInDOM",a?"informInDOM_OldIE":"Element$informInDOM"),Lava.ClassManager.patch(this,"TextInputElement","informRemove",a?"informRemove_OldIE":"Element$informRemove"),this[n](e,t,i),Lava.ClassManager.patch(this,"TextInputElement","init",n)},init_IE:function(e,t,i){this.Element$init(e,t,i);var a=this;this._OldIE_refresh_callback=function(){a._sendRefreshValue()},this._OldIE_property_change_callback=function(e){"value"==e.propertyName&&a._sendRefreshValue()}},informInDOM:function(){Lava.t()},informRemove:function(){Lava.t()},informInDOM_OldIE:function(){this.Element$informInDOM();var e=this.getDOMElement();Firestorm.Element.addListener(e,"onpropertychange",this._OldIE_property_change_callback),Firestorm.Element.addListener(e,"selectionchange",this._OldIE_refresh_callback),Firestorm.Element.addListener(e,"keyup",this._OldIE_refresh_callback),Firestorm.Element.addListener(e,"keydown",this._OldIE_refresh_callback)},informRemove_OldIE:function(){var e=this.getDOMElement();Firestorm.Element.removeListener(e,"onpropertychange",this._OldIE_property_change_callback),Firestorm.Element.removeListener(e,"selectionchange",this._OldIE_refresh_callback),Firestorm.Element.removeListener(e,"keyup",this._OldIE_refresh_callback),Firestorm.Element.removeListener(e,"keydown",this._OldIE_refresh_callback),this.Element$informRemove()},_sendRefreshValue:function(){this._events.compatible_changed&&Lava.view_manager.dispatchEvent(this._view,"compatible_changed",null,this._events.compatible_changed)}}),Lava.define("Lava.view.container.Morph",{isMorphContainer:!0,_view:null,_widget:null,_is_inDOM:!1,_start_script_id:null,_end_script_id:null,_start_element:null,_end_element:null,init:function(e,t,i){this._view=e,this._widget=i,this._start_script_id="c"+e.guid+"s",this._end_script_id="c"+e.guid+"e"},_getElements:function(){for(var e=document.getElementById(this._start_script_id),t=document.getElementById(this._end_script_id);""===e.parentNode.tagName;)e=e.parentNode;e.parentNode!==t.parentNode&&t.parentNode.insertBefore(e,t.parentNode.firstChild),this._start_element=e,this._end_element=t},getStartElement:function(){return null==this._start_element&&this._getElements(),this._start_element},getEndElement:function(){return null==this._end_element&&this._getElements(),this._end_element},wrap:function(e){return this._start_element=this._end_element=null,"<script id='"+this._start_script_id+"' type='x'></script>"+e+"<script id='"+this._end_script_id+"' type='x'></script>"},setHTML:function(e){this._is_inDOM||Lava.t("setHTML: container is not in DOM"),Firestorm.DOM.clearInnerRange(this.getStartElement(),this.getEndElement()),Firestorm.DOM.insertHTMLBefore(this.getEndElement(),e)},remove:function(){this._is_inDOM||Lava.t("remove: container is not in DOM"),Firestorm.DOM.clearOuterRange(this.getStartElement(),this.getEndElement())},appendHTML:function(e){Firestorm.DOM.insertHTMLBefore(this.getEndElement(),e)},prependHTML:function(e){Firestorm.DOM.insertHTMLAfter(this.getStartElement(),e)},insertHTMLAfter:function(e){Firestorm.DOM.insertHTMLAfter(this.getEndElement(),e)},insertHTMLBefore:function(e){Firestorm.DOM.insertHTMLBefore(this.getStartElement(),e)},informInDOM:function(){this._is_inDOM=!0},informRemove:function(){this._start_element=this._end_element=null,this._is_inDOM=!1},release:function(){this._start_element=this._end_element=null},refresh:function(){},isInDOM:function(){return this._is_inDOM},getWidget:function(){return this._widget},getView:function(){return this._view},destroy:function(){}}),Lava.define("Lava.view.container.Emulated",{isEmulatedContainer:!0,_view:null,_widget:null,_is_inDOM:!1,init:function(e,t,i){this._view=e,this._widget=i,"options"in t&&("appender"in t.options&&(Lava.schema.DEBUG&&!this["_append"+t.options.appender]&&Lava.t("[Emulated container] wrong appender: "+t.options.appender),this.appendHTML=this["_append"+t.options.appender]),"prepender"in t.options&&(Lava.schema.DEBUG&&!this["_append"+t.options.prepender]&&Lava.t("[Emulated container] wrong prepender: "+t.options.prepender),this.prependHTML=this["_append"+t.options.prepender]))},wrap:function(e){return e},setHTML:function(){this._is_inDOM||Lava.t("setHTML: container is not in DOM"),Lava.t("call to setHTML() in emulated container")},remove:function(){this._is_inDOM||Lava.t("remove: container is not in DOM"),Lava.t("call to remove() in emulated container")},_appendBottom:function(e){this._view.getParentView().getContainer().appendHTML(e)},_appendTop:function(e){this._view.getParentView().getContainer().prependHTML(e)},_appendAfterPrevious:function(e){this._view.getTemplate().getPreviousView(this._view).getContainer().insertHTMLAfter(e)},_appendBeforeNext:function(e){this._view.getTemplate().getNextView(this._view).getContainer().insertHTMLBefore(e)},appendHTML:function(){Lava.t("appendHTML is not supported or not configured")},prependHTML:function(){Lava.t("prependHTML is not supported or not configured")},insertHTMLBefore:function(e){this.prependHTML(e)},insertHTMLAfter:function(e){this.appendHTML(e)},informInDOM:function(){this._is_inDOM=!0},informRemove:function(){this._is_inDOM=!1},refresh:function(){},isInDOM:function(){return this._is_inDOM},getWidget:function(){return this._widget},getView:function(){return this._view},release:function(){},destroy:function(){}}),Lava.define("Lava.view.refresher.Standard",{Extends:"Lava.mixin.Observable",_config:null,_view:null,_container:null,_remove_queue:{},_current_templates:[],init:function(e,t,i){this._config=e,this._view=t,this._container=i,e.get_start_element_callback&&(this._getStartElement=e.get_start_element_callback),e.get_end_element_callback&&(this._getEndElement=e.get_end_element_callback)},prepareRemoval:function(e){for(var t=0,i=e.length;i>t;t++)this._remove_queue[e[t].guid]=e[t]},refresh:function(e){var t,i=1,a=e.length,n=e[0];if(n)for(delete this._remove_queue[n.guid],n.isInDOM()||(this._insertFirstTemplate(n),this._fire("insertion_complete",n));a>i;i++)delete this._remove_queue[e[i].guid],e[i].isInDOM()?this._moveTemplate(e[i],n,e):(this._insertTemplate(e[i],n,i),this._fire("insertion_complete",e[i])),n=e[i];for(t in this._remove_queue)this._remove_queue[t].isInDOM()&&(this._removeTemplate(this._remove_queue[t]),this._fire("removal_complete",this._remove_queue[t]));this._remove_queue={}},_insertFirstTemplate:function(e){this._view.getContainer().prependHTML(e.render()),e.broadcastInDOM(),this._current_templates.unshift(e)},_moveTemplate:function(e,t,i){var a=this._current_templates.indexOf(e)-1,n=null;for(Lava.schema.DEBUG&&-2==a&&Lava.t();a>-1&&-1==i.indexOf(this._current_templates[a]);)a--;if(a>-1&&(n=this._current_templates[a]),t!=n){Firestorm.DOM.moveRegionAfter(this._getEndElement(t),this._getStartElement(e),this._getEndElement(e)),Firestorm.Array.exclude(this._current_templates,e);var s=this._current_templates.indexOf(t);Lava.schema.DEBUG&&-1==s&&Lava.t(),this._current_templates.splice(s+1,0,e)}},_getStartElement:function(e){return e.getFirstView().getContainer().getDOMElement()},_getEndElement:function(e){return e.getLastView().getContainer().getDOMElement()},render:function(e){for(var t,i=0,a=e.length;a>i;i++)delete this._remove_queue[e[i].guid];for(t in this._remove_queue)this._remove_queue[t].isInDOM()&&(this._remove_queue[t].broadcastRemove(),this._fire("removal_complete",this._remove_queue[t]));return this._current_templates=e,this._remove_queue={},this._render()},_render:function(){for(var e="",t=0,i=this._current_templates.length;i>t;t++)e+=this._current_templates[t].render();return e},_insertTemplate:function(e,t){Firestorm.DOM.insertHTMLAfter(this._getEndElement(t),e.render()),e.broadcastInDOM();var i=this._current_templates.indexOf(t);Lava.schema.DEBUG&&-1==i&&Lava.t(),this._current_templates.splice(i+1,0,e)},_removeTemplate:function(e){var t=this._getStartElement(e),i=this._getEndElement(e);e.broadcastRemove(),t==i?Firestorm.Element.destroy(t):Firestorm.DOM.clearOuterRange(t,i),Firestorm.Array.exclude(this._current_templates,e)},hasAnimations:function(){return!1},isAnimationEnabled:function(){return!1},broadcastInDOM:function(){this._broadcast("broadcastInDOM")},broadcastRemove:function(){this._broadcast("broadcastRemove")},_broadcast:function(e){for(var t=0,i=this._current_templates.length;i>t;t++)this._current_templates[t][e]()},destroy:function(){this._current_templates=this._remove_queue=null}}),Lava.define("Lava.view.refresher.Animated",{Extends:"Lava.view.refresher.Standard",_is_animation_enabled:!0,_animations_by_template_guid:{},_templates_by_animation_guid:{},refresh:function(e){this.isAnimationEnabled()?this._refreshAnimated(e):this.Standard$refresh(e)},_refreshAnimated:function(e){for(var t,i=0,a=e.length,n=null;a>i;i++)delete this._remove_queue[e[i].guid],this._animateInsertion(e[i],n,i,e),n=e[i];for(t in this._remove_queue)this._animateRemoval(this._remove_queue[t]);this._remove_queue={}},render:function(e){return this._finishAnimations(),this.Standard$render(e)},enableAnimation:function(){this._is_animation_enabled=!0},disableAnimation:function(){this._is_animation_enabled=!1,this._finishAnimations()},isAnimationEnabled:function(){return this._is_animation_enabled},_finishAnimations:function(){for(var e in this._animations_by_template_guid)this._animations_by_template_guid[e].finish();this._animations_by_template_guid={},this._templates_by_animation_guid={}},hasAnimations:function(){return!Firestorm.Object.isEmpty(this._animations_by_template_guid)},_animateInsertion:function(e,t,i,a){var n=this._animations_by_template_guid[e.guid];Lava.schema.DEBUG&&n&&!e.isInDOM()&&Lava.t(),e.isInDOM()?t&&this._moveTemplate(e,t,a):(t?this._insertTemplate(e,t,i):this._insertFirstTemplate(e),n=this._createAnimation(e,i)),n&&(n.resetDirection(),n.safeStart())},_animateRemoval:function(e){var t=this._animations_by_template_guid[e.guid];!t&&e.isInDOM()&&(t=this._createAnimation(e)),t&&(t.reverseDirection(),t.safeStart())},_onAnimationComplete:function(e){var t=this._templates_by_animation_guid[e.guid];e.isReversed()?(this._onRemovalComplete(e,t),this._fire("removal_complete",t)):(this._onInsertionComplete(e,t),this._fire("insertion_complete",t)),delete this._templates_by_animation_guid[e.guid],delete this._animations_by_template_guid[t.guid]},_getAnimationTarget:function(e){return e.getFirstView().getContainer().getDOMElement()},_onRemovalComplete:function(e,t){this._removeTemplate(t)},_onInsertionComplete:function(){},_createAnimation:function(){Lava.t("Abstract function call: _createAnimation")},broadcastRemove:function(){this._finishAnimations(),this.Standard$broadcastRemove()},destroy:function(){this._finishAnimations(),this.Standard$destroy()}}),Lava.define("Lava.view.refresher.Collapse",{Extends:"Lava.view.refresher.Animated",ANIMATION_NAME:"Lava.animation.Collapse",_createAnimation:function(e){var t,i,a=this._getAnimationTarget(e);return t=Lava.ClassManager.getConstructor(this.ANIMATION_NAME,"Lava.animation"),i=new t({},a),i.on("complete",this._onAnimationComplete,this),this._templates_by_animation_guid[i.guid]=e,this._animations_by_template_guid[e.guid]=i,i}}),Lava.define("Lava.view.Abstract",{Extends:"Lava.mixin.Properties",isView:!0,guid:null,id:null,label:null,depth:0,template_index:0,_widget:null,_parent_view:null,_parent_with_container:null,_container:null,_config:null,_template:null,_is_inDOM:!1,_is_dirty:!1,_is_queued_for_refresh:!1,_property_bindings_by_property:{},_data_segments:{},_last_refresh_id:0,_refresh_cycle_count:0,init:function(e,t,i,a,n){var s,r,o;this.guid=Lava.guid++,Lava.schema.DEBUG&&e.id&&!Lava.isValidId(e.id)&&Lava.t(),"id"in e&&(this.id=e.id),"label"in e&&(this.label=e.label),Lava.view_manager.registerView(this),this._config=e,this._widget=t,this._template=a,i&&(this._parent_view=i,this._parent_with_container=i.getContainer()?i:i.getParentWithContainer(),this.depth=i.depth+1),this._initMembers(n);for(s in e.assigns)e.assigns[s].once?(r=new Lava.scope.Argument(e.assigns[s],this,this._widget),this.set(s,r.getValue()),r.destroy()):(s in this._property_bindings_by_property&&Lava.t("Error initializing assign: property binding already created"),this._property_bindings_by_property[s]=new Lava.scope.PropertyBinding(this,s,e.assigns[s]));"container"in e&&(o=Lava.ClassManager.getConstructor(e.container.type,"Lava.view.container"),this._container=new o(this,e.container,t)),this._postInit(),"roles"in e&&Lava.view_manager.dispatchRoles(this,e.roles)},getContainer:function(){return this._container},getParentWithContainer:function(){return this._parent_with_container},getParentView:function(){return this._parent_view},getWidget:function(){return this._widget},isInDOM:function(){return this._is_inDOM},getTemplate:function(){return this._template},setId:function(e){Lava.schema.DEBUG&&!Lava.isValidId(e)&&Lava.t(),Lava.view_manager.unregisterView(this),this.id=e,Lava.view_manager.registerView(this)},_initMembers:function(e){for(var t in e)this.set(t,e[t])},_postInit:function(){},getViewByDepth:function(e){for(var t=this;e>0;)t=t.getParentView(),t||Lava.t("Error evaluating depth: parent view does not exist"),e--;return t},trySetDirty:function(){this._is_inDOM&&(this._container?(this._is_dirty=!0,this._is_queued_for_refresh||(Lava.view_manager.scheduleViewRefresh(this),this._is_queued_for_refresh=!0)):this._parent_with_container&&this._parent_with_container.trySetDirty())},_broadcastToChildren:function(){},broadcastInDOM:function(){this._is_inDOM=!0,this._is_dirty=!1,this._container&&this._container.informInDOM(),this._broadcastToChildren("broadcastInDOM")},broadcastRemove:function(){this._is_inDOM&&(this._is_inDOM=!1,this._is_dirty=!1,this._container&&this._container.informRemove(),this._broadcastToChildren("broadcastRemove"))},render:function(){var e,t=this._renderContent();return e=this._container?this._container.wrap(t):t},_renderContent:function(){Lava.t("_renderContent must be overridden in inherited classes")},refresh:function(e){if(Lava.schema.DEBUG&&!this._container&&Lava.t("Refresh on a view without container"),this._is_queued_for_refresh=!1,this._is_inDOM&&this._is_dirty){if(this._last_refresh_id==e){if(this._refresh_cycle_count++,this._refresh_cycle_count>Lava.schema.system.REFRESH_INFINITE_LOOP_THRESHOLD)return Lava.view_manager.scheduleViewRefresh(this),this._is_queued_for_refresh=!0,!0}else this._last_refresh_id=e,this._refresh_cycle_count=0;this._refresh(),this._is_dirty=!1}return!1},_refresh:function(){this._container.setHTML(this._renderContent()),this._broadcastToChildren("broadcastInDOM")},locateViewByLabel:function(e){Lava.schema.DEBUG&&!e&&Lava.t();var t=this;if("root"==e)for(t=this._widget;t.getParentWidget();)t=t.getParentWidget();else if("parent"==e)t=this._parent_view;else if("widget"==e)t=this._widget;else if("this"!=e)for(;t&&t.label!=e;)t=t.getParentView();return t},locateViewByName:function(e){Lava.schema.DEBUG&&!e&&Lava.t();for(var t=this._widget;t&&t.name!=e;)t=t.getParentWidget();return t},locateViewById:function(e){return Lava.schema.DEBUG&&!e&&Lava.t(),Lava.view_manager.getViewById(e)},locateViewByGuid:function(e){return Lava.schema.DEBUG&&!e&&Lava.t(),Lava.view_manager.getViewByGuid(e)},locateViewByPathConfig:function(e){var t=this["locateViewBy"+e.locator_type](e.locator);return Lava.schema.DEBUG&&!t&&Lava.t("View not found. "+e.locator_type+":"+e.locator),"depth"in e&&(t=t.getViewByDepth(e.depth)),t},locateViewWithProperty:function(e){for(var t=this;t&&!t.isset(e);)t=t.getParentView();return t},getScopeByPathConfig:function(e){var t,i,a,n=0,s=e.tail;if("property_name"in e?(t="locator_type"in e?this.locateViewByPathConfig(e):this,t=t.locateViewWithProperty(e.property_name),Lava.schema.DEBUG&&!t&&Lava.t("Property not found: "+e.property_name),a=t.getDataBinding(e.property_name)):(!Lava.schema.DEBUG||"locator_type"in e||Lava.t("Malformed scope path (1)"),Lava.schema.DEBUG&&!s&&Lava.t("Malformed scope path (2)"),a=this.locateViewByPathConfig(e),Lava.schema.DEBUG&&!a&&Lava.t("View not found. "+e.locator_type+": "+e.locator+", depth:"+e.depth)),s)for(i=s.length;i>n;n++)a="object"==typeof s[n]?a.getSegment(this.getScopeByPathConfig(s[n])):a.getDataBinding(s[n]);return a},evalPathConfig:function(e){var t,i,a,n,s=0,r=e.tail;if("property_name"in e?(t="locator_type"in e?this.locateViewByPathConfig(e):this,t=t.locateViewWithProperty(e.property_name),a=t.get(e.property_name)):(!Lava.schema.DEBUG||"locator_type"in e||Lava.t("Malformed scope path (1)"),Lava.schema.DEBUG&&!r&&Lava.t("Malformed scope path (2)"),a=this.locateViewByPathConfig(e),Lava.schema.DEBUG&&!a&&Lava.t("View not found. "+e.locator_type+": "+e.locator+", depth:"+e.depth)),r)for(i=r.length;i>s&&(n="object"==typeof r[s]?this.evalPathConfig(r[s]):r[s],a=a.isCollection&&/^\d+$/.test(n)?a.getValueAt(+n):a.isProperties?a.get(n):a[n],a);s++);return a},getDataBinding:function(e){return e in this._property_bindings_by_property||(this._property_bindings_by_property[e]=new Lava.scope.PropertyBinding(this,e)),this._property_bindings_by_property[e]},getSegment:function(e){return Lava.schema.DEBUG&&!e.guid&&Lava.t("Only PropertyBinding and DataBinding may be used as name source for segments"),e.guid in this._data_segments||(this._data_segments[e.guid]=new Lava.scope.Segment(this,e)),this._data_segments[e.guid]},destroy:function(){var e;this._fire("destroy"),Lava.view_manager.unregisterView(this),this._container&&this._container.destroy();for(e in this._property_bindings_by_property)this._property_bindings_by_property[e].destroy();for(e in this._data_segments)this._data_segments[e].destroy();this._is_inDOM=!1}}),Lava.define("Lava.view.View",{Extends:"Lava.view.Abstract",_content:null,_postInit:function(){Lava.schema.DEBUG&&("argument"in this._config||"else_template"in this._config||"elseif_arguments"in this._config)&&Lava.t("Standard View does not support arguments and elseif/else blocks")},render:function(){var e;return e=this._container?this._container.isElementContainer&&this._container.isVoid()?this._container.renderVoid():this._container.wrap(this._renderContent()):this._renderContent()},_refresh:function(){this._container.isVoid()||(this._container.setHTML(this._renderContent()),this._broadcastToChildren("broadcastInDOM"))},_renderContent:function(){return this._getContent().render()},_broadcastToChildren:function(e){null!=this._content&&this._content[e]()},_getContent:function(){return null==this._content&&(this._content=new Lava.system.Template(this._config.template||[],this._widget,this)),this._content},destroy:function(){this._content&&(this._content.destroy(),this._content=null),this.Abstract$destroy()}}),Lava.define("Lava.view.Expression",{Extends:"Lava.view.Abstract",_argument:null,_argument_changed_listener:null,_escape:!0,_postInit:function(){!Lava.schema.DEBUG||"argument"in this._config||Lava.t("Expression view requires an argument"),this._escape=!this._config.escape_off,this._argument=new Lava.scope.Argument(this._config.argument,this,this._widget),this._argument_changed_listener=this._argument.on("changed",this._onValueChanged,this)},_onValueChanged:function(){this.trySetDirty()},_renderContent:function(){Lava.schema.DEBUG&&this._argument.isWaitingRefresh()&&Lava.t("Rendering a view in dirty state");var e="",t=this._argument.getValue();return null!=t&&void 0!==t&&(e=this._escape?this.escapeArgumentValue(""+t):""+t),e},escapeArgumentValue:function(e){return Firestorm.String.escape(e,Firestorm.String.HTML_ESCAPE_REGEX)},destroy:function(){this._argument.destroy(),this._argument=null,this.Abstract$destroy()}}),Lava.define("Lava.view.Foreach",{Extends:"Lava.view.Abstract",_argument:null,_foreach_scope:null,_foreach_scope_changed_listener:null,_current_count:0,_current_uids:[],_current_hash:{},_current_templates:[],_as:null,_refresher:null,_properties:{count:0},_requires_refresh_children:!0,init:function(e,t,i,a,n){this.Abstract$init(e,t,i,a,n),this.set("count",this._foreach_scope.getValue().getCount())},_initMembers:function(e){!Lava.schema.DEBUG||"argument"in this._config||Lava.t("Foreach view requires an argument"),Lava.schema.DEBUG&&!this._config.as&&Lava.t("Foreach view requires 'as' hash parameter"),Lava.schema.DEBUG&&!this._config.template&&Lava.t("Foreach view must not be empty"),this.Abstract$_initMembers(e),this._argument=new Lava.scope.Argument(this._config.argument,this,this._widget),this._foreach_scope=new Lava.scope.Foreach(this._argument,this,this._widget,this._config.scope),this._foreach_scope_changed_listener=this._foreach_scope.on("changed",this._onDataSourceChanged,this),this._foreach_scope.on("new_enumerable",this._onEnumerableChanged,this),this._as=this._config.as},_postInit:function(){this._config.refresher&&this.createRefresher(this._config.refresher)},createRefresher:function(e){Lava.schema.DEBUG&&(this._refresher||this._current_count)&&Lava.t("Foreach: refresher is already created or createRefresher() was called outside of init()"),Lava.schema.DEBUG&&!this._container&&Lava.t("View/Foreach: refresher needs container to work");var t=Lava.ClassManager.getConstructor(e.type,"Lava.view.refresher");this._refresher=new t(e,this,this._container),this._refresher.on("removal_complete",this._onRemovalComplete,this),this._refresh=this._refresh_Refresher,this._removeTemplates=this._removeTemplates_Refresher,this._renderContent=this._renderContent_Refresher,this._broadcastToChildren=this._broadcastToChildren_Refresher},getRefresher:function(){return this._refresher},_onEnumerableChanged:function(){for(var e=0,t=[];e<this._current_count;e++)t.push(this._current_hash[this._current_uids[e]]);t.length&&this._removeTemplates(t),this._current_count=0,this._current_hash={},this._current_uids=[],this._current_templates=[],this.set("count",0)},_removeTemplates:function(e){for(var t=0,i=e.length;i>t;t++)e[t].destroy()},_removeTemplates_Refresher:function(e){this._refresher.prepareRemoval(e)},_refreshChildren:function(){for(var e,t,i,a=this._foreach_scope.getValue(),n=a.getUIDs(),s=a.getUIDToIndexMap(),r=a.getCount(),o=0,l=[],_=[];o<this._current_count;o++)e=this._current_uids[o],e in s||(l.push(this._current_hash[e]),delete this._current_hash[e]);for(o=0;r>o;o++)e=n[o],i={foreach_index:o,foreach_name:a.getNameAt(s[e])},i[this._as]=a.getValueAt(s[e]),e in this._current_hash?(t=this._current_hash[e],t.batchSetProperties(i)):(t=new Lava.system.Template(this._config.template,this._widget,this,i),this._current_hash[e]=t),_.push(t);l.length&&this._removeTemplates(l),this._current_count=r,this._current_uids=n,this._current_templates=_,this._requires_refresh_children=!1},_onDataSourceChanged:function(){this.set("count",this._foreach_scope.getValue().getCount()),this._requires_refresh_children=!0,this.trySetDirty()},_onRemovalComplete:function(e,t){t.destroy()},_renderContent:function(){Lava.schema.DEBUG&&(this._argument.isWaitingRefresh()||this._foreach_scope.isWaitingRefresh())&&Lava.t("Rendering a view in dirty state");var e="",t=0;for(this._requires_refresh_children&&this._refreshChildren();t<this._current_count;t++)e+=this._current_templates[t].render();return e},_renderContent_Refresher:function(){return Lava.schema.DEBUG&&(this._argument.isWaitingRefresh()||this._foreach_scope.isWaitingRefresh())&&Lava.t("Rendering a view in dirty state"),this._requires_refresh_children&&this._refreshChildren(),this._refresher.render(this._current_templates)},_refresh:function(){this._requires_refresh_children&&this._refreshChildren(),this._container.setHTML(this._renderContent()),this._broadcastToChildren("broadcastInDOM")},_refresh_Refresher:function(){this._requires_refresh_children&&this._refreshChildren(),this._refresher.refresh(this._current_templates)},_broadcastToChildren:function(e){for(var t in this._current_hash)this._current_hash[t][e]()},_broadcastToChildren_Refresher:function(e){this._refresher[e]()},getScope:function(){return this._foreach_scope},destroy:function(){var e;this._refresher&&this._refresher.destroy();for(e in this._current_hash)this._current_hash[e].destroy();this._foreach_scope.destroy(),this._argument.destroy(),this.Abstract$destroy(),this._refresher=this._current_templates=this._current_hash=this._foreach_scope=this._argument=null}}),Lava.define("Lava.view.If",{Extends:"Lava.view.Abstract",_arguments:[],_argument_changed_listeners:[],_count_arguments:0,_active_argument_index:-1,_content:[],_else_content:null,_refresher:null,_active_template:null,_postInit:function(){!Lava.schema.DEBUG||"argument"in this._config||Lava.t("If view requires an argument");var e,t=0,i=new Lava.scope.Argument(this._config.argument,this,this._widget);if(this._argument_changed_listeners.push(i.on("changed",this._onArgumentChanged,this)),this._arguments.push(i),"elseif_arguments"in this._config)for(e=this._config.elseif_arguments.length;e>t;t++)i=new Lava.scope.Argument(this._config.elseif_arguments[t],this,this._widget),this._argument_changed_listeners.push(i.on("changed",this._onArgumentChanged,this)),this._arguments.push(i);this._count_arguments=this._arguments.length,this._refreshActiveArgumentIndex(),this._config.refresher&&this.createRefresher(this._config.refresher)},createRefresher:function(e){Lava.schema.DEBUG&&(this._refresher||this._current_count)&&Lava.t("If: refresher is already created or createRefresher() was called outside of init()"),Lava.schema.DEBUG&&!this._container&&Lava.t("View/If: refresher needs container to work");var t=Lava.ClassManager.getConstructor(e.type,"Lava.view.refresher");this._refresher=new t(e,this,this._container),this._refresher.on("removal_complete",this._onRemovalComplete,this),this._refresh=this._refresh_Refresher,this._removeTemplate=this._removeTemplate_Refresher,this._renderContent=this._renderContent_Refresher,this._broadcastToChildren=this._broadcastToChildren_Refresher},_onRemovalComplete:function(e,t){this._destroyTemplate(t)},getRefresher:function(){return this._refresher},_refreshActiveArgumentIndex:function(){this._active_argument_index=-1;for(var e=0;e<this._count_arguments;e++)if(this._arguments[e].getValue()){this._active_argument_index=e;break}},_getActiveTemplate:function(){var e=null,t=this._active_argument_index;return-1!=t?(this._content[t]||(this._content[t]=0==t?new Lava.system.Template(this._config.template||[],this._widget,this,{if_index:t}):new Lava.system.Template(this._config.elseif_templates[t-1]||[],this._widget,this,{if_index:t})),e=this._content[t]):"else_template"in this._config&&(null==this._else_content&&(this._else_content=new Lava.system.Template(this._config.else_template||[],this._widget,this)),e=this._else_content),e},_onArgumentChanged:function(){var e=this._active_argument_index;this._refreshActiveArgumentIndex(),this._active_argument_index!=e&&(this._active_template&&this._is_inDOM&&this._removeTemplate(this._active_template),this.trySetDirty(),this._active_template=null)},_destroyTemplate:function(e){var t=this._content.indexOf(e);-1==t?(Lava.schema.DEBUG&&e!=this._else_content&&Lava.t(),this._else_content=null):this._content[t]=null,e.destroy()},_removeTemplate:function(e){this._destroyTemplate(e)},_removeTemplate_Refresher:function(e){this._refresher.prepareRemoval([e])},_renderContent:function(){if(Lava.schema.DEBUG)for(var e=0;e<this._count_arguments;e++)this._arguments[e].isWaitingRefresh()&&Lava.t("Rendering a view in dirty state");return this._active_template=this._getActiveTemplate(),this._active_template?this._active_template.render():""},_renderContent_Refresher:function(){return Lava.schema.DEBUG&&-1!=this._active_argument_index&&this._arguments[this._active_argument_index].isWaitingRefresh()&&Lava.t(),this._active_template=this._getActiveTemplate(),this._refresher.render(this._active_template?[this._active_template]:[])},_broadcastToChildren:function(e){this._active_template&&this._active_template[e]()},_broadcastToChildren_Refresher:function(e){this._refresher[e]()},_refresh:function(){this._container.setHTML(this._renderContent()),this._broadcastToChildren("broadcastInDOM")},_refresh_Refresher:function(){this._active_template||(this._active_template=this._getActiveTemplate()),this._refresher.refresh(this._active_template?[this._active_template]:[])},destroy:function(){var e=0;for(this._refresher&&this._refresher.destroy();e<this._count_arguments;e++)this._arguments[e].destroy(),this._content[e]&&this._content[e].destroy();this._else_content&&this._else_content.destroy(),this._refresher=this._content=this._else_content=this._arguments=this._active_template=this._argument_changed_listeners=null,this.Abstract$destroy()}}),Lava.define("Lava.view.Include",{Extends:"Lava.view.Abstract",_argument:null,_argument_changed_listener:null,_content:null,_postInit:function(){!Lava.schema.DEBUG||"argument"in this._config||Lava.t("Include view requires an argument"),this._argument=new Lava.scope.Argument(this._config.argument,this,this._widget),this._argument_changed_listener=this._argument.on("changed",this._onValueChanged,this)},_onValueChanged:function(){this._content&&this._content.destroy(),this._content=null,this.trySetDirty()},render:function(){Lava.schema.DEBUG&&this._argument.isWaitingRefresh()&&Lava.t("Rendering a view in dirty state");var e;return e=this._container?this._container.wrap(this._renderContent()):this._renderContent()},_renderContent:function(){return this._getContent().render()},_refresh:function(){this._container.setHTML(this._renderContent()),this._broadcastToChildren("broadcastInDOM")},_broadcastToChildren:function(e){null!=this._content&&this._content[e]()},_getContent:function(){if(null==this._content){var e=this._argument.getValue();Lava.schema.DEBUG&&e&&!Array.isArray(e)&&Lava.t("Include view expects to receive a template from it's argument"),this._content=new Lava.system.Template(this._argument.getValue()||this._config.template||[],this._widget,this)}return this._content},destroy:function(){this._content&&this._content.destroy(),this._argument.destroy(),this._argument_changed_listener=this._argument=this._content=null,this.Abstract$destroy()}}),Lava.define("Lava.widget.Standard",{Extends:"Lava.view.View",Shared:["_property_descriptors","_event_handlers","_role_handlers","_include_handlers","_modifiers"],isWidget:!0,name:"widget",_property_descriptors:{},_acquired_events:[],_event_handlers:{},_role_handlers:{},_include_handlers:{},_bindings:{},_resources:{},_parent_widget:null,_modifiers:{translate:"translate",ntranslate:"ntranslate"},init:function(e,t,i,a,n){var s,r,o;if(Lava.schema.DEBUG&&!e.is_extended&&Lava.t("Widget was created with partial (unextended) config"),Lava.schema.DEBUG){for(s in this._property_descriptors)s in this._properties||Lava.t("All widget properties must have a default value");if(e.default_events)for(o=0,r=e.default_events.length;r>o;o++)Lava.view_manager.isEventRouted(e.default_events[o])||Lava.t("Event is not routed: "+e.default_events[o])}this._parent_widget=t,this.View$init(e,this,i,a,n);
for(s in e.bindings)this._bindings[s]=new Lava.scope.Binding(e.bindings[s],this)},_initMembers:function(e){this.View$_initMembers(e);for(var t in this._config.properties)this.set(t,this._config.properties[t]);Lava.schema.RESOURCES_ENABLED&&this._initResources(this._config)},_initResources:function(e){var t,i,a,n=Lava.schema.LOCALE;"resources_cache"in e&&(a=e.resources_cache[n]),"resource_id"in e&&(t=this["locateViewBy"+e.resource_id.locator_type](e.resource_id.locator),!Lava.schema.DEBUG||t&&t.isWidget||Lava.t("Resource root not found: "+e.resource_id.locator_type+"="+e.resource_id.locator),i=t.getResource(e.resource_id.name,Lava.schema.LOCALE),i&&(Lava.schema.DEBUG&&"component"!=i.type&&Lava.t("resource value is not a component"),a=a?Lava.resources.mergeResources(i.value,a):i.value)),a&&(this._resources[n]=a,Lava.resources.mergeRootContainerStacks(a))},getInclude:function(e,t){var i=null;return i=e in this._include_handlers?this[this._include_handlers[e]](t):this._config.includes[e]},handleEvent:function(e,t,i,a,n){var s=!1;return i in this._event_handlers&&(this[this._event_handlers[i]](e,t,a,n),s=!0),s},inject:function(e,t){this._is_inDOM&&Lava.t("inject: widget is already in DOM"),Lava.schema.DEBUG&&this._parent_view&&Lava.t("Widget: only top-level widgets can be inserted into DOM"),Lava.schema.DEBUG&&!this._container&&Lava.t("Widget: root widgets must have a container"),Lava.ScopeManager.refresh(),Lava.ScopeManager.lock(),Firestorm.DOM.insertHTML(e,this.render(),t||"Top"),Lava.ScopeManager.unlock(),this.broadcastInDOM()},injectIntoExistingElement:function(e){this._is_inDOM&&Lava.t("inject: widget is already in DOM"),Lava.schema.DEBUG&&this._parent_view&&Lava.t("Widget: only top-level widgets can be inserted into DOM"),Lava.schema.DEBUG&&!this._container&&Lava.t("Widget: root widgets must have a container"),Lava.schema.DEBUG&&!this._container.isElementContainer&&Lava.t("injectIntoExistingElement expects an element containers"),Lava.ScopeManager.refresh(),Lava.ScopeManager.lock(),this._container.captureExistingElement(e),this._container.setHTML(this._renderContent()),Lava.ScopeManager.unlock(),this._is_inDOM=!0,this._is_dirty=!1,this._broadcastToChildren("broadcastInDOM")},remove:function(){this._is_inDOM||Lava.t("remove: widget is not in DOM"),Lava.schema.DEBUG&&!this._container&&Lava.t("remove: widget doesn't have a container"),this._is_inDOM=!1,this._is_dirty=!1,this._broadcastToChildren("broadcastRemove"),this._container.isElementContainer&&!this._container.isElementOwner()?this._container.releaseElement():this._container.remove()},callModifier:function(e,t){return!Lava.schema.DEBUG||e in this._modifiers||Lava.t("Unknown widget modifier: "+e),this[this._modifiers[e]].apply(this,t)},callActiveModifier:function(){Lava.t("Alpha version. This functionality may be removed later.")},getParentWidget:function(){return this._parent_widget},handleRole:function(e,t,i){var a=!1;return e in this._role_handlers&&(this[this._role_handlers[e]](t,i),a=!0),a},set:function(e,t){var i;e in this._property_descriptors&&(i=this._property_descriptors[e],Lava.schema.DEBUG&&i.is_readonly&&Lava.t("Trying to set readonly property: "+e),Lava.schema.widget.VALIDATE_PROPERTY_TYPES&&(null===t?i.is_nullable||Lava.t("Trying to assign NULL to non-nullable property"):i.type&&!Lava.types[i.type].isValidValue(t,i)&&Lava.t("Assigned value does not match the property type: "+i.type))),this._properties[e]!==t&&(i&&i.setter?(Lava.schema.DEBUG&&"_"!=i.setter[0]&&Lava.t("Widget property setters must not be public: "+i.setter),this[i.setter](t,e)):this._set(e,t))},get:function(e){return e in this._property_descriptors&&this._property_descriptors[e].getter?this[this._property_descriptors[e].getter](e):this.View$get(e)},getPackageConstructor:function(e){return Lava.ClassManager.getPackageConstructor(this.Class.path,e)},getResource:function(e,t){return t=t||Lava.schema.LOCALE,t in this._resources&&e in this._resources[t]?this._resources[t][e]:null},getDynamicScope:function(){Lava.t("Not implemented: getDynamicScope")},translate:function(e,t,i){var a,n=this.getResource(e,i||Lava.schema.LOCALE);return n?(Lava.schema.DEBUG&&"string"!=n.type&&Lava.t("[translate] resource is not a string: "+e),a=t?n.value.replace(/\{(\d+)\}/g,function(e,i){return t[i]||""}):n.value):(a="",Lava.logError("Resource string not found: "+e)),a},ntranslate:function(e,t,i,a){var n,s,r=this.getResource(e,a||Lava.schema.LOCALE),o=Lava.locales[Lava.schema.LOCALE].pluralize(t||0);return r?(Lava.schema.DEBUG&&"plural_string"!=r.type&&Lava.t("[ntranslate] resource is not a plural_string: "+e),n=r.value[o],Lava.schema.DEBUG&&null==n&&Lava.t("[ntranslate] requested plural string is missing one of it's plural forms:"+e),s=i?n.replace(/\{(\d+)\}/g,function(e,t){return i[t]||""}):n):(s="",Lava.logError("Resource string not found: "+e)),s},destroy:function(){var e;for(e in this._bindings)this._bindings[e].destroy();this._bindings=this._resources=null,this.View$destroy()}}),Lava.define("Lava.widget.input.InputAbstract",{Extends:"Lava.widget.Standard",_property_descriptors:{name:{type:"String",is_nullable:!0},value:{type:"String",is_nullable:!0},is_disabled:{type:"Boolean"},is_required:{type:"Boolean"},is_readonly:{type:"Boolean"},is_valid:{type:"Boolean",is_readonly:!0}},_properties:{name:null,value:null,is_disabled:!1,is_required:!1,is_readonly:!1,is_valid:!0},_event_handlers:{_focused:"_onInputFocused",_blurred:"_onInputBlurred"},_role_handlers:{_input_view:"_handleInputView",label:"_handleLabel"},_type:null,_input_container:null,init:function(e,t,i,a,n){this.Standard$init(e,t,i,a,n),Lava.view_manager.dispatchRoles(this,[{name:"form_field"}])},_handleInputView:function(e){this._input_container=e.getContainer(),!this._input_container.getProperty("type")&&this._type&&this._input_container.storeProperty("type",this._type),Lava.view_manager.cancelBubble()},getMainContainer:function(){return this._input_container},_onInputFocused:function(e,t,i){Lava.app.fireGlobalEvent("focus_acquired",{target:this,element:i.getContainer().getDOMElement()})},_onInputBlurred:function(){Lava.app.fireGlobalEvent("focus_lost")},focus:function(){this._input_container&&this._input_container.isInDOM()&&this._input_container.getDOMElement().focus()},toQueryString:function(){return this._properties.name&&!this._properties.is_disabled&&null!=this._properties.value?encodeURIComponent(this._properties.name)+"="+encodeURIComponent(this._properties.value):""},_setValidity:function(e){this._properties.is_valid!=e&&this._set("is_valid",e)},_handleLabel:function(e){e.getContainer().setProperty("for",Lava.ELEMENT_ID_PREFIX+this.guid)},destroy:function(){this._input_container=null,this.Standard$destroy()}}),Lava.define("Lava.widget.input.TextAbstract",{Extends:"Lava.widget.input.InputAbstract",_property_descriptors:{value:{type:"String",setter:"_setValue"}},_properties:{value:""},_event_handlers:{value_changed:"_refreshValue",input:"_onTextInput"},_setValue:function(e){this._set("value",e),this._input_container&&this._input_container.setProperty("value",this._valueToElementProperty(e))},_valueToElementProperty:function(e){return e},_refreshValue:function(){var e=this._input_container.getDOMElement().value;this._properties.value!=e&&(this._set("value",e),this._input_container.storeProperty("value",this._properties.value))},_onTextInput:function(){this._refreshValue()}}),Lava.define("Lava.widget.input.TextArea",{Extends:"Lava.widget.input.TextAbstract",name:"textarea",_renderContent:function(){return Firestorm.String.escape(this._properties.value,Firestorm.String.TEXTAREA_ESCAPE_REGEX)}}),Lava.define("Lava.widget.input.Text",{Extends:"Lava.widget.input.TextAbstract",name:"text_input",_type:"text",_handleInputView:function(e,t){this.TextAbstract$_handleInputView(e,t),this._input_container.storeProperty("value",this._properties.value)}}),Lava.define("Lava.widget.input.Password",{Extends:"Lava.widget.input.Text",_type:"password"}),Lava.define("Lava.widget.input.RadioAbstract",{Extends:"Lava.widget.input.InputAbstract",_property_descriptors:{is_checked:{type:"Boolean",setter:"_setIsChecked"}},_properties:{is_checked:!1},_event_handlers:{checked_changed:"_onCheckedChanged"},_handleInputView:function(e,t){this.InputAbstract$_handleInputView(e,t),this._input_container.storeProperty("checked",this._properties.is_checked?"checked":null)},_setIsChecked:function(e){this._set("is_checked",e),this._input_container&&this._input_container.setProperty("checked",this._properties.is_checked?"checked":null)},_onCheckedChanged:function(){this.set("is_checked",this._input_container.getDOMElement().checked),this._fire("checked_changed")},toQueryString:function(){return this._properties.name&&this._properties.is_checked?this._properties.name+"="+(this._properties.value||"on"):""}}),Lava.define("Lava.widget.input.CheckBox",{Extends:"Lava.widget.input.RadioAbstract",name:"checkbox",_type:"checkbox",_property_descriptors:{is_indeterminate:{type:"Boolean",setter:"_setIsIndeterminate"}},_properties:{is_indeterminate:!1},_refreshIndeterminate:function(){this._input_container&&this._input_container.getDOMElement()&&(this._input_container.getDOMElement().indeterminate=this._properties.is_indeterminate)},broadcastInDOM:function(){this.RadioAbstract$broadcastInDOM(),this._refreshIndeterminate()},_refresh:function(){this.RadioAbstract$_refresh(),this._refreshIndeterminate()},_setIsChecked:function(e,t){this.RadioAbstract$_setIsChecked(e,t),this._setIsIndeterminate(!1)},_setIsIndeterminate:function(e){this._properties.is_indeterminate!=e&&this._set("is_indeterminate",e),this._refreshIndeterminate()},_onCheckedChanged:function(){this.RadioAbstract$_onCheckedChanged(),this.set("is_indeterminate",!1)}}),Lava.define("Lava.widget.input.Radio",{Extends:"Lava.widget.input.RadioAbstract",name:"radio",_type:"radio",broadcastInDOM:function(){this.RadioAbstract$broadcastInDOM(),this._input_container&&this.set("is_checked",this._input_container.getDOMElement().checked)}}),Lava.define("Lava.widget.input.Submit",{Extends:"Lava.widget.input.InputAbstract",name:"submit",_type:"submit",_event_handlers:{clicked:"_onClicked"},_onClicked:function(e,t){this._fire("clicked"),t.preventDefault()}}),Lava.define("Lava.widget.input.SelectAbstract",{Extends:"Lava.widget.input.InputAbstract",name:"select",_properties:{optgroups:null},_event_handlers:{value_changed:"_onValueChanged"},_modifiers:{isValueSelected:"isValueSelected"},broadcastInDOM:function(){this.InputAbstract$broadcastInDOM(),this._refreshValue()},_onValueChanged:function(){this._refreshValue()},_refresh:function(){this.InputAbstract$_refresh(),this._refreshValue()},_refreshValue:function(){Lava.t("Abstract function call: _refreshValue")}}),Lava.define("Lava.widget.input.Select",{Extends:"Lava.widget.input.SelectAbstract",_property_descriptors:{value:{type:"String",setter:"_setValue"}},_refreshValue:function(){var e=this._input_container.getDOMElement();e.selectedIndex,this.set("value",e.value)},_setValue:function(e){var t;this._input_container&&(t=this._input_container.getDOMElement(),t.value=e,e!=t.value&&(Lava.logError("[Select] nonexistent value assigned: "+e),e=t.value)),this._set("value",e)},isValueSelected:function(e){return e==this._properties.value}}),Lava.define("Lava.widget.input.MultipleSelect",{Extends:"Lava.widget.input.SelectAbstract",name:"select",_property_descriptors:{value:{type:"Array",setter:"_setValue"}},_properties:{value:[]},_handleInputView:function(e,t){this.SelectAbstract$_handleInputView(e,t),this._input_container.storeProperty("multiple",!0)},_refreshValue:function(){for(var e,t=this._input_container.getDOMElement(),i=t.selectedOptions||t.options,a=[],n=0,s=i.length,r=!1;s>n;n++)i[n].selected&&(e=i[n].value||i[n].text,a.push(e),-1==this._properties.value.indexOf(e)&&(r=!0));(r||this._properties.value.length!=a.length)&&this._set("value",a)},_setValue:function(e){var t,i,a,n,s=0;if(this._input_container)for(t=this._input_container.getDOMElement(),i=t.options,a=i.length;a>s;s++)n=i[s].value||i[s].text,i[s].selected=-1!=e.indexOf(n);this._set("value",e)},isValueSelected:function(e){return-1!=this._properties.value.indexOf(e)},toQueryString:function(){var e=[],t=this._properties.name,i=this._properties.value,a=0,n=i.length;if(this._properties.name&&!this._properties.is_disabled)for(;n>a;a++)e.push(encodeURIComponent(t)+"="+encodeURIComponent(i[a]));return e.join("&")}}),Lava.define("Lava.widget.input.Numeric",{Extends:"Lava.widget.input.Text",_property_descriptors:{value:{type:"Number",setter:"_setValue"},input_value:{type:"String",is_readonly:!0}},_properties:{value:0,input_value:""},_type:"number",_data_type:"Number",init:function(e,t,i,a,n){this.Text$init(e,t,i,a,n),e.options&&(e.options.type&&("text"!=e.options.type&&Lava.t('Numeric input: the only recognized "type" option value in "text"'),this._type=e.options.type),e.options.data_type&&(this._data_type=e.options.data_type))},_valueToElementProperty:function(e){return e+""},_refreshValue:function(){var e=this._input_container.getDOMElement().value,t=Lava.types[this._data_type].isValidString(e);this._properties.input_value!=e&&this._set("input_value",e),t&&(this._properties.value!=e&&(this._set("value",e),this._input_container.storeProperty("value",e)),this._setValidity(!0)),this._setValidity(t)},_setValue:function(e,t){this.Text$_setValue(e,t),this._setValidity(!0)}}),Lava.define("Lava.widget.FieldGroup",{Extends:"Lava.widget.Standard",name:"field_group",_role_handlers:{form_field:"_handleFieldRole",form_group:"_handleGroupRole"},_event_handlers:{form_submit:"_onSubmit"},_fields:[],_groups:[],_submit_fields:[],_handleGroupRole:function(e){this._groups.push(e)},_handleFieldRole:function(e){"submit"==e.name?(this._submit_fields.push(e),e.on("clicked",this._onSubmit,this),e.on("destroy",this._onFieldDestroyed,this,this._submit_fields)):(this._fields.push(e),e.on("destroy",this._onFieldDestroyed,this,this._fields)),Lava.view_manager.cancelBubble()},_onSubmit:function(){},getFields:function(){return this._fields.slice()},getSubmitFields:function(){return this._submit_fields.slice()},toQueryString:function(){for(var e,t=0,i=this._fields.length,a=[];i>t;t++)e=this._fields[t].toQueryString(),e&&a.push(e);return a.join("&")},_onFieldDestroyed:function(e,t,i){Firestorm.Array.exclude(i,e)}}),Lava.define("Lava.widget.Accordion",{Extends:"Lava.widget.Standard",name:"accordion",_property_descriptors:{is_enabled:{type:"Boolean",setter:"_setIsEnabled"}},_properties:{_panels:null,is_enabled:!0},_role_handlers:{panel:"_handlePanelRole"},_panels:null,_panel_widgets:[],_active_panels:[],_listeners_by_panel_guid:{},init:function(e,t,i,a,n){this._panels=new Lava.system.Enumerable,this._properties._panels=this._panels,this.Standard$init(e,t,i,a,n)},_initMembers:function(e){var t,i,a;if(this.Standard$_initMembers(e),this._config.storage&&this._config.storage.panels)for(t=this._config.storage.panels,i=0,a=t.length;a>i;i++)this.addPanel({is_expanded:t[i].is_expanded||!1,title_template:t[i].title,content_template:t[i].content})},addPanel:function(e){Lava.schema.DEBUG&&e.isProperties&&Lava.t("Wrong argument to addPanel. Plain object expected.");var t=new Lava.mixin.Properties({is_expanded:!1,title_template:null,content_template:null});return t.setProperties(e),this._panels.push(t),t},getPanelObjects:function(){return this._panels.getValues()},getPanelWidgets:function(){return this._panel_widgets.slice()},_handlePanelRole:function(e){this.registerPanel(e)},registerPanel:function(e){var t=!this._config.options||!this._config.options.keep_new_panels_expanded;e.get("is_expanded")&&(this._active_panels.length&&t&&this._properties.is_enabled?e.set("is_expanded",!1):this._active_panels.push(e)),this._panel_widgets.push(e),this._listeners_by_panel_guid[e.guid]={destroy:e.on("destroy",this._onPanelDestroy,this,null,!0),expanding:e.on("expanding",this._onPanelExpanding,this),collapsing:e.on("collapsing",this._onPanelCollapsing,this)}},_removePanel:function(e){Firestorm.Array.exclude(this._panel_widgets,e),Firestorm.Array.exclude(this._active_panels,e),delete this._listeners_by_panel_guid[e.guid]},unregisterPanel:function(e){var t=this._listeners_by_panel_guid[e.guid];t&&(e.removeListener(t.destroy),e.removeListener(t.expanding),e.removeListener(t.collapsing),this._removePanel(e))},_onPanelExpanding:function(e){var t,i,a=0;if(this._properties.is_enabled){for(t=this._active_panels.slice(),a=0,i=t.length;i>a;a++)t[a].set("is_expanded",!1);this._active_panels=[e]}else this._active_panels.push(e);this._fire("panel_expanding",{panel:e})},_onPanelCollapsing:function(e){Firestorm.Array.exclude(this._active_panels,e),this._fire("panel_collapsing",{panel:e})},_setIsEnabled:function(e,t){var i,a=[],n=0;if(e&&this._active_panels.length>1){for(i=this._active_panels.length-1,a=this._active_panels.slice(0,i);i>n;n++)a[n].set("is_expanded",!1);this._active_panels=[this._active_panels[i]]}this._set(t,e)},_onPanelDestroy:function(e){this._removePanel(e)},removeNativePanels:function(){this._panels.removeAll()},removeAllPanels:function(){for(var e=this._panel_widgets.slice(),t=0,i=e.length;i>t;t++)this.unregisterPanel(e[t]);this._panels.removeAll()},removePanel:function(e){this._panels.removeValue(e)},destroy:function(){this.removeAllPanels(),this._panels.destroy(),this._panels=this._properties._panels=null,this.Standard$destroy()}}),Lava.define("Lava.widget.Tabs",{Extends:"Lava.widget.Standard",name:"tabs",_properties:{_tabs:null,active_tab:null},_property_descriptors:{active_tab:{setter:"_setActiveTab"}},_event_handlers:{header_click:"_onTabHeaderClicked"},_tab_objects:null,init:function(e,t,i,a,n){this._tab_objects=new Lava.system.Enumerable,this._properties._tabs=this._tab_objects,this.Standard$init(e,t,i,a,n)},_initMembers:function(e){var t,i,a,n;if(this.Standard$_initMembers(e),this._config.storage&&this._config.storage.tabs)for(t=this._config.storage.tabs,i=0,a=t.length;a>i;i++)n=t[i],this.addTab({name:n.name||"",is_enabled:"is_enabled"in n?n.is_enabled:!0,is_hidden:"is_hidden"in n?n.is_hidden:!1,is_active:"is_active"in n?n.is_active:!1,title_template:n.title,content_template:n.content})},_onTabHeaderClicked:function(e,t,i,a){var n=a[0];n.get("is_enabled")&&this._setActiveTab(n),i.getContainer().getDOMElement().blur(),t.preventDefault()},addTab:function(e){Lava.schema.DEBUG&&e.isProperties&&Lava.t("Wrong argument to addTab. Plain object expected.");var t=new Lava.mixin.Properties({guid:Lava.guid++,name:"",is_enabled:!0,is_hidden:!1,is_active:!1,title_template:null,content_template:null});return t.setProperties(e),Lava.schema.DEBUG&&t.get("is_active")&&(!t.get("is_enabled")||t.get("is_hidden"))&&Lava.t("Tabs: added tab cannot be active and disabled/hidden at the same time"),null==this._properties.active_tab&&t.get("is_enabled")&&!t.get("is_hidden")&&this._setActiveTab(t),t.get("is_active")&&this._properties.active_tab!=t&&(this._properties.active_tab&&this._properties.active_tab.set("is_active",!1),this._set("active_tab",t)),this._tab_objects.push(t),t.onPropertyChanged("is_enabled",this._onTabStateChanged,this),t.onPropertyChanged("is_hidden",this._onTabStateChanged,this),t.onPropertyChanged("is_active",this._onTabIsActiveChanged,this),t},_onTabIsActiveChanged:function(e){e.get("is_active")?this._setActiveTab(e):this._properties.active_tab==e&&this._setActiveTab(null)},_setActiveTab:function(e){var t=this._properties.active_tab;t!=e&&(this._set("active_tab",e),e&&e.set("is_active",!0),t&&t.set("is_active",!1))},_onTabStateChanged:function(e){!e.get("is_active")||e.get("is_enabled")&&!e.get("is_hidden")||this._fixActiveTab()},getTabObjects:function(){return this._tab_objects.getValues()},removeTab:function(e){this._tab_objects.removeValue(e),this._properties.active_tab==e&&this._fixActiveTab()},_fixActiveTab:function(){var e=null;this._tab_objects.each(function(t){var i=null;return t.get("is_enabled")&&!t.get("is_hidden")&&(e=t,i=!1),i}),this._setActiveTab(e)},removeAllTabs:function(){for(var e=this._tab_objects.getValues(),t=0,i=e.length;i>t;t++)this.removeTab(e[t]);this._setActiveTab(null)},reorderTabs:function(e){this._tab_objects.reorder(e)},sortTabs:function(e){this._tab_objects.sort(e)},destroy:function(){this.removeAllTabs(),this._tab_objects.destroy(),this._tab_objects=this._properties._tab_objects=null,this.Standard$destroy()}}),Lava.define("Lava.widget.Collapsible",{Extends:"Lava.widget.Standard",name:"collapsible",_property_descriptors:{is_expanded:{type:"Boolean",setter:"_setExpanded"},is_animation_enabled:{type:"Boolean"}},_properties:{is_expanded:!0,is_animation_enabled:!0,content:""},_role_handlers:{_container_view:"_handleContainerView"},_panel_container:null,_animation:null,_default_display:null,TOGGLE_ANIMATION_CLASS:"Toggle",_refreshAnimation:function(e){var t,i=this._panel_container.getDOMElement();this._animation||(t=this._properties.is_animation_enabled?this._config.options.animation:{"class":this.TOGGLE_ANIMATION_CLASS},this._animation=new Lava.animation[t["class"]](t,i),this._animation.on("complete",this._onAnimationComplete,this)),this._animation.setTarget(i),e?this._animation.resetDirection():this._animation.reverseDirection(),this._animation.safeStart()},_onAnimationComplete:function(){this._animation.isReversed()?(this._fire("collapsed"),this._panel_container.setStyle("display","none")):this._fire("expanded")},_setExpanded:function(e,t){var i="none";this._set(t,e),(this._is_inDOM&&this._properties.is_animation_enabled||e)&&(i=this._default_display),this._panel_container&&this._panel_container.setStyle("display",i),this._is_inDOM&&(this._fire(e?"expanding":"collapsing"),this._properties.is_animation_enabled&&this._panel_container?this._refreshAnimation(e):this._fire(e?"expanded":"collapsed"))},_handleContainerView:function(e){this._panel_container=e.getContainer(),this._default_display=this._panel_container.getStyle("display")||null,this._properties.is_expanded||this._panel_container.setStyle("display","none")},getMainContainer:function(){return this._panel_container}}),Lava.define("Lava.widget.CollapsiblePanel",{Extends:"Lava.widget.Collapsible",name:"collapsible_panel",_property_descriptors:{is_locked:{type:"Boolean"}},_properties:{is_locked:!1,title:""},_event_handlers:{header_click:"_onHeaderClick"},_onHeaderClick:function(){this._properties.is_locked||this.set("is_expanded",!this._properties.is_expanded)}}),Lava.define("Lava.widget.CollapsiblePanelExt",{Extends:"Lava.widget.Standard",name:"collapsible_panel",_property_descriptors:{is_expanded:{type:"Boolean"},is_locked:{type:"Boolean"},is_animation_enabled:{type:"Boolean",setter:"_setAnimationEnabled"}},_properties:{is_expanded:!0,is_locked:!1,is_animation_enabled:!0,title:"",content:""},_event_handlers:{header_click:"_onHeaderClick"},_role_handlers:{_content_if:"_handleContentIf"},_content_refresher:null,_handleContentIf:function(e){var t=e.getRefresher();t.on("insertion_complete",this._onInsertionComplete,this),t.on("removal_complete",this._onRemovalComplete,this),this._properties.is_animation_enabled||t.disableAnimation(),this._content_refresher=t},_onInsertionComplete:function(){this._fire("expanded")},_onRemovalComplete:function(){this._fire("collapsed")},_onHeaderClick:function(){this._properties.is_locked||(this.set("is_expanded",!this._properties.is_expanded),this._fire(this._properties.is_expanded?"expanding":"collapsing"))},_setAnimationEnabled:function(e,t){this._set(t,e),this._content_refresher&&(e?this._content_refresher.enableAnimation():this._content_refresher.disableAnimation())}}),Lava.define("Lava.widget.DropDown",{Extends:"Lava.widget.Standard",name:"dropdown",_property_descriptors:{is_open:{type:"Boolean",setter:"_setIsOpen"}},_properties:{is_open:!1},_event_handlers:{trigger_click:"_onTriggerClick"},_role_handlers:{trigger:"_registerTrigger",target:"_registerTarget"},_trigger:null,_target:null,_click_listener:null,init:function(e,t,i,a,n){this.Standard$init(e,t,i,a,n),Lava.app.on("close_popups",this._onClosePopups,this)},_onClosePopups:function(){this.set("is_open",!1)},_onTriggerClick:function(e,t){this._properties.is_open?this.set("is_open",!1):(Lava.app.fireGlobalEvent("close_popups"),this._click_listener||(this._click_listener=Lava.Core.addGlobalHandler("click",this._onGlobalClick,this)),this.set("is_open",!0)),t.preventDefault()},_onGlobalClick:function(){Lava.Core.removeGlobalHandler(this._click_listener),this._click_listener=null,this.set("is_open",!1)},_getTargetContainer:function(){return this._target&&this._target.getContainer()||this._container},_registerTrigger:function(e){this._trigger=e,e.getContainer().addEventTarget("click",{locator_type:"Guid",locator:this.guid,name:"trigger_click"})},_registerTarget:function(e){this._target=e},_setIsOpen:function(e,t){var i=this._getTargetContainer();Lava.schema.DEBUG&&!i&&Lava.t("DropDown was created without container and target"),this._set(t,e),e?i.addClass(this._config.options.target_class):i.removeClass(this._config.options.target_class)},destroy:function(){this._click_listener&&(Lava.Core.removeGlobalHandler(this._click_listener),this._click_listener=null),this._trigger=this._target=null,this.Standard$destroy()}}),Lava.define("Lava.widget.Tree",{Extends:"Lava.widget.Standard",Shared:["_meta_storage_config","_default_if_refresher_config","_foreach_refresher_config","_direct_bind_configs","_meta_storage_bind_configs"],name:"tree",_direct_bind_configs:{is_expanded:Lava.ExpressionParser.parseScopeEval("node.is_expanded"),is_expandable:Lava.ExpressionParser.parseScopeEval("node.children.length")},_meta_storage_bind_configs:{is_expanded:Lava.ExpressionParser.parseScopeEval("$tree.meta_storage[node.guid].is_expanded"),is_expandable:Lava.ExpressionParser.parseScopeEval("$tree.meta_storage[node.guid].is_expandable")},_meta_storage_config:{fields:{is_expanded:{type:"Boolean"}}},_default_if_refresher_config:{type:"Standard"},_if_refresher_config:null,_foreach_refresher_config:{type:"Standard",get_end_element_callback:function(e){var t=e.getLastView().get("_foreach_view"),i=t?t.getContainer().getDOMElement():null;return i||e.getFirstView().getContainer().getDOMElement()}},_property_descriptors:{records:{setter:"_setRecords"},meta_storage:{is_readonly:!0}},_properties:{records:null,meta_storage:null},_event_handlers:{node_click:"_onNodeClick"},_role_handlers:{node_children_view:"_handleNodeChildrenView",root_nodes_foreach:"_handleRootNodesForeach",nodes_foreach:"_handleNodesForeach"},_meta_storage:null,_meta_storage_columns:{},_column_bind_configs:{},CREATE_META_STORAGE:!1,init:function(e,t,i,a,n){var s,r,o,l=0;if(e.options&&e.options.meta_storage_columns)for(r=e.options.meta_storage_columns,s=r.length;s>l;l++)this._meta_storage_columns[r[l]]=!0;for(o in this._direct_bind_configs)this._column_bind_configs[o]=o in this._meta_storage_columns?this._meta_storage_bind_configs[o]:this._direct_bind_configs[o];(this.CREATE_META_STORAGE||!Firestorm.Object.isEmpty(this._meta_storage_columns))&&(this._meta_storage=new Lava.data.MetaStorage(this._meta_storage_config),this._properties.meta_storage=this._meta_storage),this.Standard$init(e,t,i,a,n),this._if_refresher_config=e.options&&e.options.refresher?e.options.refresher:this._default_if_refresher_config},_setRecords:function(e,t){this._meta_storage&&(this._meta_storage.destroy(),this._meta_storage=new Lava.data.MetaStorage(this._meta_storage_config),this._set("meta_storage",this._meta_storage)),this._set(t,e)},_getMetaRecord:function(e){return this._meta_storage.get(e.get("guid"))||this._meta_storage.createMetaRecord(e.get("guid"))},_handleNodeChildrenView:function(e){e.createRefresher(this._if_refresher_config)},_handleRootNodesForeach:function(e){e.createRefresher(this._foreach_refresher_config)},_handleNodesForeach:function(e){e.createRefresher(this._foreach_refresher_config),e.getParentView().set("_foreach_view",e)},_onNodeClick:function(e,t,i,a){Lava.schema.DEBUG&&(a[0].isProperties||Lava.t("Tree: record is not instance of Properties"),"is_expanded"in this._meta_storage_columns&&(a[0].get("guid")||Lava.t("Tree: record without GUID")));var n="is_expanded"in this._meta_storage_columns?this._getMetaRecord(a[0]):a[0];n.set("is_expanded",!n.get("is_expanded")),t.preventDefault()},_toggleTree:function(e,t){var i,a,n=e.get("children"),s=0,r=n.getCount();if(r){for(;r>s;s++)i=n.getValueAt(s),i.get("children").getCount()&&this._toggleTree(i,t);a="is_expanded"in this._meta_storage_columns?this._getMetaRecord(e):e,a.set("is_expanded",t)}},_toggleRecords:function(e){var t,i,a=this._properties.records,n=0;if(a)for(t=a.getCount();t>n;n++)i=a.getValueAt(n),this._toggleTree(i,e)},expandAll:function(){this._toggleRecords(!0)},collapseAll:function(){this._toggleRecords(!1)},getDynamicScope:function(e,t){return t.property_name in this._column_bind_configs||Lava.t("unknown dynamic scope: "+t.property_name),e.getScopeByPathConfig(this._column_bind_configs[t.property_name])},destroy:function(){this._meta_storage&&(this._meta_storage.destroy(),this._meta_storage=null),this.Standard$destroy()}}),Lava.define("Lava.widget.Table",{Extends:"Lava.widget.Standard",name:"table",_properties:{records:null,_columns:null,_sort_column_name:null,_sort_descending:!1},_event_handlers:{column_header_click:"_onColumnHeaderClick"},_include_handlers:{cell:"_getCellInclude"},init:function(e,t,i,a,n){!Lava.schema.DEBUG||e.options&&e.options.columns||Lava.t("Table: config.options.columns is required"),this._properties._columns=e.options.columns,this.Standard$init(e,t,i,a,n)},_onColumnHeaderClick:function(e,t,i,a){var n,s=a[0].name;this._properties._sort_column_name!=s?(this.set("_sort_column_name",s),this.set("_sort_descending",!1)):this.set("_sort_descending",!this._properties._sort_descending),n=this._properties._sort_descending?function(e,t){return e.get(s)>t.get(s)}:function(e,t){return e.get(s)<t.get(s)},this._properties.records&&this._properties.records.sort(n)},_getCellInclude:function(e){return this._config.storage.cells[e[0].type]}}),Lava.define("Lava.widget.CalendarAbstract",{Extends:"Lava.widget.Standard",name:"calendar",_properties:{_current_year:0,_current_month:0,_current_day:0},_getMonthDescriptors:function(e){var t,i=[],a=Lava.locales[e].short_month_names;for(t=0;12>t;t++)i[t]=new Lava.mixin.Properties({index:t,title:a[t]});return i},_getMonthDescriptorRows:function(e){var t=[];return t.push(e.slice(0,4)),t.push(e.slice(4,8)),t.push(e.slice(8,12)),t},_getWeekDays:function(e){var t,i,a=Lava.locales[e].first_day_offset,n=[],s=Lava.locales[e].short_day_names;for(t=0;7>t;t++)i=new Lava.mixin.Properties({index:t,title:s[a]}),n.push(i),a=(a+1)%7;return n},_renderMonthData:function(e,t,i){var a=Lava.locales[i].first_day_offset,n=new Date(Date.UTC(e,t)),s=(n.getDay()-a+7)%7;return s&&(n=new Date(Date.UTC(e,t,1-s))),{year:e,index:t,weeks:this._renderMonthWeeksData(n)}},_renderMonthWeeksData:function(e){var t=e.getUTCFullYear(),i=e.getUTCMonth(),a=e.getUTCDate(),n=e.getTime(),s=0,r=Firestorm.Date.getDaysInMonth(t,i),o=0,l=[],_=[];_.push(this._renderDayData(t,i,a,s,n));do a==r?(a=1,i++,12==i&&(i=0,t++),r=Firestorm.Date.getDaysInMonth(t,i)):a++,s=(s+1)%7,o++,n+=864e5,0==s&&(l.push(_),_=[]),_.push(this._renderDayData(t,i,a,s,n));while(42>o);return l},_renderDayData:function(e,t,i,a,n){return{year:e,month:t,day:i,day_of_week:a,milliseconds:n,is_today:this._properties._current_day==i&&this._properties._current_month==t&&this._properties._current_year==e}}}),Lava.define("Lava.widget.Calendar",{Extends:"Lava.widget.CalendarAbstract",_property_descriptors:{value:{type:"Date",setter:"_setValue"}},_properties:{value:null,_selected_view:"days",_weekdays:null,_months_data:null,_month_year_string:null,_today_string:null,_selection_start:0,_selection_end:0,_displayed_year:null,_displayed_month:null,_month_descriptors:null,_month_descriptor_rows:null},_event_handlers:{today_click:"_onTodayClick",previous_month_click:"_onPreviousMonthClick",next_month_click:"_onNextMonthClick",days_view_month_name_click:"_onSwitchToMonthViewClick",month_click:"_onMonthClick",day_click:"_onDayClick",previous_year_click:"_onPreviousYearClick",next_year_click:"_onNextYearClick"},_role_handlers:{_year_input:"_handleYearInput"},_year_input:null,_months_cache:{},init:function(e,t,i,a,n){var s=new Date,r=this._properties,o=Lava.locales[Lava.schema.LOCALE];
r._current_year=s.getFullYear(),r._current_month=s.getMonth(),r._current_day=s.getDate(),r._displayed_year=r._current_year,r._displayed_month=r._current_month,r._weekdays=this._getWeekDays(Lava.schema.LOCALE),r._month_descriptors=this._getMonthDescriptors(Lava.schema.LOCALE),r._month_descriptor_rows=this._getMonthDescriptorRows(r._month_descriptors),this.CalendarAbstract$init(e,t,i,a,n),null==this._properties.value&&this._setValue(s,"value"),this.set("_today_string",r._current_day+" "+o.month_names[r._current_month]+" "+r._current_year),this._refreshData()},_refreshData:function(){var e=Lava.locales[Lava.schema.LOCALE],t=this._getMonthData(this._properties._displayed_year,this._properties._displayed_month);this.set("_months_data",[t]),this.set("_month_year_string",e.month_names[this._properties._displayed_month]+" "+this._properties._displayed_year)},_getMonthData:function(e,t){var i=e+""+t;return i in this._months_cache||(this._months_cache[i]=this._renderMonthData(e,t,Lava.schema.LOCALE)),this._months_cache[i]},_onPreviousMonthClick:function(e,t){var i=this._properties._displayed_month;0==i?(this.set("_displayed_year",this._properties._displayed_year-1),this.set("_displayed_month",11)):this.set("_displayed_month",i-1),this._refreshData(),t.preventDefault()},_onNextMonthClick:function(e,t){var i=this._properties._displayed_month;11==i?(this.set("_displayed_year",this._properties._displayed_year+1),this.set("_displayed_month",0)):this.set("_displayed_month",i+1),this._refreshData(),t.preventDefault()},_onTodayClick:function(e,t){var i=Date.UTC(this._properties._current_year,this._properties._current_month,this._properties._current_day);this._select(this._properties._current_year,this._properties._current_month,i),t.preventDefault()},_onDayClick:function(e,t,i,a){var n=a[0];this._select(n.year,n.month,n.milliseconds),t.preventDefault()},_select:function(e,t,i){this.set("_selection_start",i),this.set("_selection_end",i),this._properties._displayed_month!=t&&(this.set("_displayed_year",e),this.set("_displayed_month",t),this._refreshData()),this.set("value",new Date(i))},_onSwitchToMonthViewClick:function(e,t){this.set("_selected_view","months"),this._year_input&&this._year_input.set("value",this._properties._displayed_year+""),t.preventDefault()},_onPreviousYearClick:function(e,t){this.set("_displayed_year",this.get("_displayed_year")-1),this._clearInvalidInputState(),t.preventDefault()},_onNextYearClick:function(e,t){this.set("_displayed_year",this.get("_displayed_year")+1),this._clearInvalidInputState(),t.preventDefault()},_onMonthClick:function(e,t,i,a){var n=a[0];this.set("_displayed_month",n.get("index")),this.set("_selected_view","days"),this._refreshData()},_handleYearInput:function(e){this._year_input=e,e.onPropertyChanged("value",this._onYearInputValueChanged,this)},_markInputAsInvalid:function(){var e,t=this._year_input.getMainContainer();t&&(e=t.getDOMElement(),e&&Firestorm.Element.addClass(e,this._config.options.invalid_input_class))},_clearInvalidInputState:function(){var e,t=this._year_input.getMainContainer();t&&(e=t.getDOMElement(),e&&Firestorm.Element.removeClass(e,this._config.options.invalid_input_class))},_onYearInputValueChanged:function(e){var t=e.get("value");t.length>2&&t.length<6&&/^\d+$/.test(t)?(this.set("_displayed_year",+t),this._clearInvalidInputState()):this._markInputAsInvalid()},_setValue:function(e){var t=e.getFullYear(),i=e.getMonth(),a=e.getDate(),n=Date.UTC(t,i,a);this.set("_displayed_year",t),this.set("_displayed_month",i),this.set("_selection_start",n),this.set("_selection_end",n),this._set("value",e),this._refreshData()}}),Lava.define("Lava.widget.Tooltip",{Extends:"Lava.widget.Standard",name:"tooltip",_property_descriptors:{y:{type:"Integer"},x:{type:"Integer"},y_offset:{type:"Integer"},x_offset:{type:"Integer"},html:{type:"String"},is_visible:{type:"Boolean"}},_properties:{y:0,x:0,y_offset:-25,x_offset:5,html:"",is_visible:!1}}),Lava.widgets={InputAbstract:{template:["\r\n		",{name:"input_view",type:"include"},"\r\n	"],sugar:{attribute_mappings:{name:{type:"property",type_name:"String"},value:{type:"property",type_name:"String"},disabled:{type:"property",type_name:"SwitchAttribute",name:"is_disabled"},required:{type:"property",type_name:"SwitchAttribute",name:"is_required"},readonly:{type:"property",type_name:"SwitchAttribute",name:"is_readonly"}}},"class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard",is_extended:!1},CheckBox:{"extends":"InputAbstract",includes:{input_view:["\r\n		",{type:"view","class":"View",container:{type:"CheckboxElement",tag_name:"input",events:{change:[{locator_type:"Name",locator:"checkbox",name:"checked_changed"}],focus:[{locator_type:"Name",locator:"checkbox",name:"_focused"}],blur:[{locator_type:"Name",locator:"checkbox",name:"_blurred"}],compatible_changed:[{locator_type:"Name",locator:"checkbox",name:"checked_changed"}]},property_bindings:{name:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"checkbox",tail:["name"]}]},value:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"checkbox",tail:["value"]}]},disabled:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"checkbox",tail:["is_disabled"]}]},required:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"checkbox",tail:["is_required"]}]},readonly:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"checkbox",tail:["is_readonly"]}]}},resource_id:{locator_type:"Name",locator:"checkbox",name:"CHECKBOX_ELEMENT"}},roles:[{name:"_input_view"}],template:[]},"\r\n	"]},sugar:{tag_name:"checkbox",root_resource_name:"CHECKBOX_ELEMENT",attribute_mappings:{checked:{type:"property",type_name:"SwitchAttribute",name:"is_checked"},indeterminate:{type:"property",type_name:"SwitchAttribute",name:"is_indeterminate"}}},default_events:[],real_class:"input.CheckBox","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard",is_extended:!1},TextArea:{"extends":"InputAbstract",includes:{input_view:["\r\n		",{type:"view","class":"View",container:{type:"Element",tag_name:"textarea",events:{change:[{locator_type:"Name",locator:"textarea",name:"value_changed"}],input:[{locator_type:"Name",locator:"textarea",name:"input"}],focus:[{locator_type:"Name",locator:"textarea",name:"_focused"}],blur:[{locator_type:"Name",locator:"textarea",name:"_blurred"}]},property_bindings:{name:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"textarea",tail:["name"]}]},disabled:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"textarea",tail:["is_disabled"]}]},required:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"textarea",tail:["is_required"]}]},readonly:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"textarea",tail:["is_readonly"]}]}},resource_id:{locator_type:"Name",locator:"textarea",name:"TEXTAREA_ELEMENT"}},roles:[{name:"_input_view"}]},"\r\n	"]},sugar:{tag_name:"text_area",root_resource_name:"TEXTAREA_ELEMENT",attribute_mappings:{value:{type:"property",type_name:"String"}}},default_events:[],real_class:"input.TextArea","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard",is_extended:!1},TextInput:{"extends":"InputAbstract",includes:{input_view:["\r\n		",{type:"view","class":"View",container:{type:"TextInputElement",tag_name:"input",events:{change:[{locator_type:"Name",locator:"text_input",name:"value_changed"}],input:[{locator_type:"Name",locator:"text_input",name:"input"}],focus:[{locator_type:"Name",locator:"text_input",name:"_focused"}],blur:[{locator_type:"Name",locator:"text_input",name:"_blurred"}],compatible_changed:[{locator_type:"Name",locator:"text_input",name:"value_changed"}]},property_bindings:{name:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"text_input",tail:["name"]}]},disabled:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"text_input",tail:["is_disabled"]}]},required:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"text_input",tail:["is_required"]}]},readonly:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"text_input",tail:["is_readonly"]}]}},resource_id:{locator_type:"Name",locator:"text_input",name:"TEXT_INPUT_ELEMENT"}},roles:[{name:"_input_view"}],template:[]},"\r\n	"]},sugar:{tag_name:"text_input",root_resource_name:"TEXT_INPUT_ELEMENT",attribute_mappings:{value:{type:"property",type_name:"String"}}},default_events:[],real_class:"input.Text","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard",is_extended:!1},PasswordInput:{"extends":"TextInput",real_class:"input.Password","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard",is_extended:!1},Numeric:{"extends":"TextInput",real_class:"input.Numeric","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard",is_extended:!1},Radio:{"extends":"InputAbstract",includes:{input_view:["\r\n		",{type:"view","class":"View",container:{type:"Element",tag_name:"input",events:{change:[{locator_type:"Name",locator:"radio",name:"checked_changed"}],focus:[{locator_type:"Name",locator:"radio",name:"_focused"}],blur:[{locator_type:"Name",locator:"radio",name:"_blurred"}]},property_bindings:{name:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"radio",tail:["name"]}]},value:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"radio",tail:["value"]}]},disabled:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"radio",tail:["is_disabled"]}]},required:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"radio",tail:["is_required"]}]},readonly:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"radio",tail:["is_readonly"]}]}},resource_id:{locator_type:"Name",locator:"radio",name:"RADIO_ELEMENT"}},roles:[{name:"_input_view"}]},"\r\n	"]},sugar:{tag_name:"radio",root_resource_name:"RADIO_ELEMENT",attribute_mappings:{checked:{type:"property",type_name:"SwitchAttribute",name:"is_checked"}}},default_events:[],real_class:"input.Radio","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard",is_extended:!1},SubmitInput:{"extends":"InputAbstract",includes:{input_view:["\r\n		",{type:"view","class":"View",container:{type:"Element",tag_name:"input",events:{click:[{locator_type:"Name",locator:"submit",name:"clicked"}],focus:[{locator_type:"Name",locator:"submit",name:"_focused"}],blur:[{locator_type:"Name",locator:"submit",name:"_blurred"}]},property_bindings:{name:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"submit",tail:["name"]}]},value:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"submit",tail:["value"]}]},disabled:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"submit",tail:["is_disabled"]}]}},resource_id:{locator_type:"Name",locator:"submit",name:"SUBMIT_INPUT_ELEMENT"}},roles:[{name:"_input_view"}]},"\r\n	"]},sugar:{tag_name:"submit_input",root_resource_name:"SUBMIT_INPUT_ELEMENT"},default_events:[],real_class:"input.Submit","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard",is_extended:!1},SubmitButton:{"extends":"InputAbstract",includes:{input_view:["\r\n		",{type:"view","class":"View",container:{type:"Element",tag_name:"button",events:{click:[{locator_type:"Name",locator:"submit",name:"clicked"}],focus:[{locator_type:"Name",locator:"submit",name:"_focused"}],blur:[{locator_type:"Name",locator:"submit",name:"_blurred"}]},property_bindings:{name:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"submit",tail:["name"]}]},value:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"submit",tail:["value"]}]},disabled:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"submit",tail:["is_disabled"]}]}},resource_id:{locator_type:"Name",locator:"submit",name:"SUBMIT_BUTTON_ELEMENT"}},roles:[{name:"_input_view"}],template:["\r\n				",{name:"content",type:"include"},"\r\n		"]},"\r\n	"],content:[]},sugar:{tag_name:"submit_button",content_schema:{type:"include",name:"content"},root_resource_name:"SUBMIT_BUTTON_ELEMENT"},default_events:[],real_class:"input.Submit","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard",is_extended:!1},SelectAbstract:{"extends":"InputAbstract",includes:{input_view:["\r\n		",{type:"view","class":"View",container:{type:"Element",tag_name:"select",events:{change:[{locator_type:"Name",locator:"select",name:"value_changed"}],focus:[{locator_type:"Name",locator:"select",name:"_focused"}],blur:[{locator_type:"Name",locator:"select",name:"_blurred"}]}},roles:[{name:"_input_view"}],template:["\r\n			",{type:"view","class":"Foreach",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"select",tail:["optgroups"]}]},as:"optgroup",template:["\r\n				",{type:"view","class":"If",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"optgroup",tail:["label"]}]},template:["\r\n					",{type:"view","class":"View",container:{type:"Element",tag_name:"optgroup",property_bindings:{label:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"optgroup",tail:["label"]}]},disabled:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"optgroup",tail:["is_disabled"]}]}}},template:["\r\n						",{name:"group_options",type:"include"},"\r\n					"]},"\r\n				"],else_template:["\r\n					",{name:"group_options",type:"include"},"\r\n				"]},"\r\n			"]},"\r\n		"]},"\r\n	"],group_options:["\r\n		",{type:"view","class":"Foreach",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"optgroup",tail:["options"]}]},as:"option",template:["\r\n			",{type:"view","class":"Expression",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"option",tail:["title"]}]},container:{type:"Element",tag_name:"option",property_bindings:{value:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"option",tail:["value"]}]},selected:{evaluator:function(){return this._callModifier("0",[this._binds[0].getValue()])},binds:[{property_name:"option",tail:["value"]}],modifiers:[{locator_type:"Name",locator:"select",callback_name:"isValueSelected"}]},disabled:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"option",tail:["is_disabled"]}]}}}},"\r\n		"]},"\r\n	"]},default_events:[],"class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard",is_extended:!1},Select:{"extends":"SelectAbstract",real_class:"input.Select","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard",is_extended:!1},MultipleSelect:{"extends":"SelectAbstract",real_class:"input.MultipleSelect","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard",is_extended:!1},Collapsible:{template:["\r\n		",{type:"view","class":"View",container:{type:"Element",tag_name:"div",resource_id:{locator_type:"Name",locator:"collapsible",name:"COLLAPSIBLE_CONTAINER"}},roles:[{locator_type:"Name",locator:"collapsible",name:"_container_view"}],template:["\r\n			",{locator_type:"Name",locator:"collapsible",name:"content",type:"include"},"\r\n		"]},"\r\n	"],options:{animation:{"class":"Collapse"}},sugar:{tag_name:"collapsible",root_resource_name:"COLLAPSIBLE_CONTAINER",content_schema:{type:"include",name:"content"},attribute_mappings:{"is-expanded":{type:"property",type_name:"Boolean",name:"is_expanded"},"is-animation-enabled":{type:"property",type_name:"Boolean",name:"is_animation_enabled"}}},resources:{"default":{COLLAPSIBLE_CONTAINER:{type:"container_stack",value:[{name:"static_classes",value:["lava-collapsible"]}]}}},real_class:"Collapsible","class":"Lava.widget.Collapsible",extender_type:"Standard",is_extended:!0,resources_cache:{en:{COLLAPSIBLE_CONTAINER:{type:"container_stack",value:[{name:"static_classes",value:["lava-collapsible"]}]}}}},CollapsiblePanel:{type:"widget","class":"Lava.widget.CollapsiblePanel",extender_type:"Standard",template:["\r\n			",{locator_type:"Name",locator:"collapsible_panel",name:"header_wrapper",type:"include"},"\r\n			",{locator_type:"Name",locator:"collapsible_panel",name:"content_wrapper",type:"include"},"\r\n		"],container:{type:"Element",tag_name:"div",resource_id:{locator_type:"Name",locator:"collapsible_panel",name:"COLLAPSIBLE_PANEL_CONTAINER"}},"extends":"Collapsible",includes:{header_wrapper:["\r\n		",{type:"view","class":"View",container:{type:"Element",tag_name:"div",events:{click:[{locator_type:"Name",locator:"collapsible_panel",name:"header_click"}]},resource_id:{locator_type:"Name",locator:"collapsible_panel",name:"COLLAPSIBLE_PANEL_HEADER_CONTAINER"}},template:["\r\n			",{locator_type:"Name",locator:"collapsible_panel",name:"header",type:"include"},"\r\n		"]},"\r\n	"],content_wrapper:["\r\n		",{type:"view","class":"View",container:{type:"Element",tag_name:"div"},roles:[{locator_type:"Name",locator:"collapsible_panel",name:"_container_view"}],template:["\r\n			",{type:"static_tag",resource_id:{locator_type:"Name",locator:"collapsible_panel",name:"COLLAPSIBLE_PANEL_BODY_CONTAINER"},name:"div",template:["\r\n				",{locator_type:"Name",locator:"collapsible_panel",name:"content",type:"include"},"\r\n			"]},"\r\n		"]},"\r\n	"],header:['\r\n		<h3 class="panel-title">',{locator_type:"Name",locator:"collapsible_panel",name:"title",type:"include"},"</h3>\r\n	"],title:["\r\n		",{type:"view","class":"Expression",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"collapsible_panel",tail:["title"]}]}},"\r\n	"],content:["\r\n		",{type:"view","class":"Expression",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"collapsible_panel",tail:["content"]}]}},"\r\n	"]},sugar:{tag_name:"collapsible-panel",root_resource_name:"COLLAPSIBLE_PANEL_CONTAINER",content_schema:{type:"union",tag_roles:{title:{type:"include"},content:{type:"include"}},name:"content"},attribute_mappings:{"is-locked":{type:"property",type_name:"Boolean",name:"is_locked"},"is-expanded":{type:"property",type_name:"Boolean",name:"is_expanded"},"is-animation-enabled":{type:"property",type_name:"Boolean",name:"is_animation_enabled"}}},resources:{"default":{COLLAPSIBLE_PANEL_CONTAINER:{type:"container_stack",value:[{name:"static_classes",value:["panel","lava-panel"]}]},COLLAPSIBLE_PANEL_HEADER_CONTAINER:{type:"container_stack",value:[{name:"static_classes",value:["panel-heading","lava-unselectable"]}]},COLLAPSIBLE_PANEL_BODY_CONTAINER:{type:"container_stack",value:[{name:"static_classes",value:["panel-body"]}]}}},default_events:[],real_class:"CollapsiblePanel",is_extended:!0,options:{animation:{"class":"Collapse"}},resources_cache:{en:{COLLAPSIBLE_PANEL_CONTAINER:{type:"container_stack",value:[{name:"static_classes",value:["panel","lava-panel"]}]},COLLAPSIBLE_PANEL_HEADER_CONTAINER:{type:"container_stack",value:[{name:"static_classes",value:["panel-heading","lava-unselectable"]}]},COLLAPSIBLE_PANEL_BODY_CONTAINER:{type:"container_stack",value:[{name:"static_classes",value:["panel-body"]}]},COLLAPSIBLE_CONTAINER:{type:"container_stack",value:[{name:"static_classes",value:["lava-collapsible"]}]}}}},CollapsiblePanelExt:{"extends":"CollapsiblePanel",includes:{content_wrapper:["\r\n		",{type:"view","class":"If",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"collapsible_panel",tail:["is_expanded"]}]},container:{type:"Emulated",options:{prepender:"AfterPrevious"}},roles:[{locator_type:"Name",locator:"collapsible_panel",name:"_content_if"}],refresher:{type:"Collapse"},template:["\r\n			\r\n			\r\n			\r\n			",{type:"view","class":"View",container:{type:"Element",tag_name:"div"},template:["\r\n				",{type:"static_tag",resource_id:{locator_type:"Name",locator:"collapsible_panel",name:"COLLAPSIBLE_PANEL_EXT_BODY_CONTAINER"},name:"div",template:["\r\n					",{locator_type:"Name",locator:"collapsible_panel",name:"content",type:"include"},"\r\n				"]},"\r\n			"]},"\r\n		"]},"\r\n	"]},sugar:{tag_name:"collapsible-panel-ext"},resources:{"default":{COLLAPSIBLE_PANEL_EXT_BODY_CONTAINER:{type:"container_stack",value:[{name:"static_classes",value:["panel-body"]}]}}},real_class:"CollapsiblePanelExt","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard",is_extended:!1},Accordion:{template:["\r\n		",{locator_type:"Name",locator:"accordion",name:"content",type:"include"},"\r\n	"],includes:{content:["\r\n		",{type:"view","class":"Foreach",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"accordion",tail:["_panels"]}]},as:"panel",refresher:{type:"Standard"},template:["\r\n				\r\n				",{type:"widget","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard","extends":"CollapsiblePanel",assigns:{is_expanded:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"panel",tail:["is_expanded"]}]}},includes:{title:["\r\n						",{type:"view","class":"Include",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"panel",tail:["title_template"]}]},template:[]},"\r\n					"],content:["\r\n						",{type:"view","class":"Include",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"panel",tail:["content_template"]}]},template:[]},"\r\n					"]},roles:[{locator_type:"Name",locator:"accordion",name:"panel"}],resource_id:{locator_type:"Name",locator:"accordion",name:"panel"}},"\r\n			"],container:{type:"Element",tag_name:"div",resource_id:{locator_type:"Name",locator:"accordion",name:"ACCORDION_CONTAINER"}}},"\r\n	"]},storage_schema:{panels:{type:"object_collection",tag_name:"panel",properties:{title:{type:"template"},content:{type:"template"},is_expanded:{type:"lava_type",type_name:"Boolean",is_attribute:!0}}}},sugar:{tag_name:"accordion",root_resource_name:"ACCORDION_CONTAINER",content_schema:{type:"storage_object",name:"panels"},attribute_mappings:{"keep-new-panels-expanded":{type:"switch",name:"keep_new_panels_expanded"}}},resources:{"default":{ACCORDION_CONTAINER:{type:"container_stack",value:[{name:"static_classes",value:["panel-group"]}]},panel:{type:"component",value:{COLLAPSIBLE_PANEL_CONTAINER:{type:"container_stack",value:[{name:"add_classes",value:["panel-collapse"]}]}}}}},real_class:"Accordion","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard",is_extended:!1},Tabs:{template:["\r\n		",{name:"tabs_header",type:"include"},"\r\n		",{name:"tabs_body",type:"include"},"\r\n	"],includes:{tabs_header:["\r\n		",{type:"view","class":"Foreach",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"tabs",tail:["_tabs"]}]},as:"tab",template:["\r\n				",{type:"view","class":"If",argument:{evaluator:function(){return!this._binds[0].getValue()},binds:[{property_name:"tab",tail:["is_hidden"]}]},template:["\r\n					",{type:"view","class":"View",container:{type:"Element",tag_name:"li",class_bindings:{0:{evaluator:function(){return this._binds[0].getValue()?"active":""},binds:[{property_name:"tab",tail:["is_active"]}]},1:{evaluator:function(){return this._binds[0].getValue()?"":"disabled"},binds:[{property_name:"tab",tail:["is_enabled"]}]}}},template:["\r\n						",{type:"view","class":"View",container:{type:"Element",tag_name:"a",events:{click:[{locator_type:"Name",locator:"tabs",name:"header_click",arguments:[{type:2,data:{property_name:"tab"}}]}]},property_bindings:{href:{evaluator:function(){return"#"+(this._binds[0].getValue()||"")},binds:[{property_name:"tab",tail:["name"]}]}}},template:["\r\n							",{type:"view","class":"Include",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"tab",tail:["title_template"]}]},template:[]},"\r\n						"]},"\r\n					"]},"\r\n				"]},"\r\n			"],container:{type:"Element",tag_name:"ul",resource_id:{locator_type:"Name",locator:"tabs",name:"TABS_HEADERS_CONTAINER"}}},"\r\n	"],tabs_body:["\r\n		",{type:"view","class":"Foreach",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"tabs",tail:["_tabs"]}]},as:"tab",refresher:{type:"Standard"},template:["\r\n				\r\n				",{type:"view","class":"View",container:{type:"Element",tag_name:"div",static_classes:["tab-pane"],class_bindings:{0:{evaluator:function(){return this._binds[0].getValue()?"active":""},binds:[{property_name:"tab",tail:["is_active"]}]}}},template:["\r\n					",{type:"view","class":"Include",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"tab",tail:["content_template"]}]},template:[]},"\r\n				"]},"\r\n			"],container:{type:"Element",tag_name:"div",resource_id:{locator_type:"Name",locator:"tabs",name:"TABS_CONTENT_CONTAINER"}}},"\r\n	"]},storage_schema:{tabs:{type:"object_collection",tag_name:"tab",properties:{title:{type:"template"},content:{type:"template"},name:{type:"lava_type",is_attribute:!0,type_name:"String"},is_enabled:{type:"lava_type",is_attribute:!0,type_name:"Boolean"},is_hidden:{type:"lava_type",is_attribute:!0,type_name:"Boolean"},is_active:{type:"lava_type",is_attribute:!0,type_name:"Boolean"}}}},sugar:{tag_name:"tabs",content_schema:{type:"storage_object",name:"tabs"}},resources:{"default":{TABS_HEADERS_CONTAINER:{type:"container_stack",value:[{name:"static_classes",value:["nav","nav-tabs"]}]},TABS_CONTENT_CONTAINER:{type:"container_stack",value:[{name:"static_classes",value:["tab-content"]}]}}},default_events:[],real_class:"Tabs","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard",is_extended:!1},Tooltip:{type:"widget","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard",template:["\r\n			",{type:"view","class":"Expression",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"tooltip",tail:["html"]}]},escape_off:!0,template:[],container:{type:"Element",tag_name:"div",static_classes:["tooltip-inner"]}},'\r\n			<div class="tooltip-arrow"></div>\r\n		'],container:{type:"Element",tag_name:"div",static_classes:["tooltip"],style_bindings:{top:{evaluator:function(){return this._binds[0].getValue()+this._binds[1].getValue()+"px"},binds:[{locator_type:"Name",locator:"tooltip",tail:["y"]},{locator_type:"Name",locator:"tooltip",tail:["y_offset"]}]},left:{evaluator:function(){return this._binds[0].getValue()+this._binds[1].getValue()+"px"},binds:[{locator_type:"Name",locator:"tooltip",tail:["x"]},{locator_type:"Name",locator:"tooltip",tail:["x_offset"]}]}},class_bindings:{0:{evaluator:function(){return this._binds[0].getValue()?"in":"hidden"},binds:[{locator_type:"Name",locator:"tooltip",tail:["is_visible"]}]}}},real_class:"Tooltip",is_extended:!1},DropDown:{options:{target_class:"open"},real_class:"DropDown","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard",is_extended:!1},Tree:{template:["\r\n		",{type:"view","class":"Foreach",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"tree",tail:["records"]}]},as:"node",roles:[{locator_type:"Name",locator:"tree",name:"root_nodes_foreach"}],template:["\r\n				\r\n				",{locator_type:"Name",locator:"tree",name:"node",type:"include"},"\r\n			"],container:{type:"Element",tag_name:"div",resource_id:{locator_type:"Name",locator:"tree",name:"MAIN_TREE_CONTAINER"}}},"\r\n	"],assigns:{pad:{evaluator:function(){return""},flags:{isStatic:!0,isString:!0}},level:{evaluator:function(){return 0},flags:{isStatic:!0,isNumber:!0}}},includes:{node:["\r\n		",{locator_type:"Name",locator:"tree",name:"node_body",type:"include"},"\r\n		",{locator_type:"Name",locator:"tree",name:"node_children",type:"include"},"\r\n	"],node_body:["\r\n		",{type:"view","class":"View",container:{type:"Element",tag_name:"div",static_classes:["lava-tree-node"],static_properties:{unselectable:"on"},class_bindings:{0:{evaluator:function(){return"level-"+this._binds[0].getValue()},binds:[{property_name:"level"}]}}},template:["\r\n			",{locator_type:"Name",locator:"tree",name:"node_body_content",type:"include"},"\r\n		"]},"\r\n	"],node_body_content:["\r\n		",{type:"view","class":"Expression",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"pad"}]},escape_off:!0,template:[]},{type:"view","class":"View",container:{type:"Element",tag_name:"i",static_classes:["lava-tree-expander"],events:{click:[{locator_type:"Name",locator:"tree",name:"node_click",arguments:[{type:2,data:{property_name:"node"}}]}]},class_bindings:{0:{evaluator:function(){return"lava-tree"+(this._binds[0].getValue()==this._binds[1].getValue()-1?"-bottom":"-middle")+(this._binds[2].getValue()?this._binds[3].getValue()?"-expanded":"-collapsed":"-node")},binds:[{property_name:"foreach_index"},{locator_type:"Label",locator:"parent",property_name:"count"},{locator_type:"Name",locator:"tree",isDynamic:!0,property_name:"is_expandable"},{locator_type:"Name",locator:"tree",isDynamic:!0,property_name:"is_expanded"}]}}}},"\r\n		",{locator_type:"Name",locator:"tree",name:"icon",type:"include"},"\r\n		",{locator_type:"Name",locator:"tree",name:"node_title",type:"include"},"\r\n	"],icon:[],node_children:["\r\n		",{type:"view","class":"If",argument:{evaluator:function(){return this._binds[0].getValue()&&this._binds[1].getValue()},binds:[{locator_type:"Name",locator:"tree",isDynamic:!0,property_name:"is_expandable"},{locator_type:"Name",locator:"tree",isDynamic:!0,property_name:"is_expanded"}]},container:{type:"Emulated",options:{prepender:"AfterPrevious"}},roles:[{locator_type:"Name",locator:"tree",name:"node_children_view"}],assigns:{pad:{evaluator:function(){return this._binds[0].getValue()==this._binds[1].getValue()-1?this._binds[2].getValue()+'<div class="lava-tree-pad"></div>':this._binds[3].getValue()+'<div class="lava-tree-pad-line"></div>'},binds:[{property_name:"foreach_index"},{property_name:"count"},{property_name:"pad"},{property_name:"pad"}]},level:{evaluator:function(){return this._binds[0].getValue()+1},binds:[{locator_type:"Label",locator:"parent",property_name:"level"}]}},template:["\r\n			\r\n			\r\n			\r\n			\r\n			",{type:"view","class":"Foreach",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"node",tail:["children"]}]},as:"node",roles:[{locator_type:"Name",locator:"tree",name:"nodes_foreach"}],template:["\r\n					\r\n					",{locator_type:"Name",locator:"tree",name:"node",type:"include"},"\r\n				"],container:{type:"Element",tag_name:"div",static_classes:["lava-tree-container"]}},"\r\n		"]},"\r\n	"],node_title:["\r\n		",{type:"view","class":"Expression",argument:{evaluator:function(){return this._binds[0].getValue()
},flags:{isScopeEval:!0},binds:[{property_name:"node",tail:["title"]}]},container:{type:"Element",tag_name:"span",static_classes:["lava-tree-title"],events:{click:[{locator_type:"Name",locator:"tree",name:"node_click",arguments:[{type:2,data:{property_name:"node"}}]}]},class_bindings:{0:{evaluator:function(){return this._binds[0].getValue()?"lava-tree-title-expandable":""},binds:[{locator_type:"Name",locator:"tree",isDynamic:!0,property_name:"is_expandable"}]}}}},"\r\n	"]},resources:{"default":{MAIN_TREE_CONTAINER:{type:"container_stack",value:[{name:"add_classes",value:["lava-tree","lava-unselectable"]}]}}},default_events:[],real_class:"Tree","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard",is_extended:!1},Table:{type:"widget","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard",template:["\r\n			",{locator_type:"Name",locator:"table",name:"thead",type:"include"},"\r\n			",{locator_type:"Name",locator:"table",name:"tbody",type:"include"},"\r\n		"],container:{type:"Element",tag_name:"table",resource_id:{locator_type:"Name",locator:"table",name:"TABLE_ELEMENT"}},includes:{thead:["\r\n		",{type:"view","class":"View",container:{type:"Element",tag_name:"thead",resource_id:{locator_type:"Name",locator:"table",name:"THEAD_ELEMENT"}},template:["\r\n			",{type:"view","class":"Foreach",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"table",tail:["_columns"]}]},as:"column",template:["\r\n					",{type:"view","class":"View",container:{type:"Element",tag_name:"td",events:{click:[{locator_type:"Name",locator:"table",name:"column_header_click",arguments:[{type:2,data:{property_name:"column"}}]}]}},template:["\r\n						",{type:"view","class":"Expression",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"column",tail:["title"]}]},container:{type:"Element",tag_name:"span",class_bindings:{0:{evaluator:function(){return this._binds[0].getValue()==this._binds[1].getValue()?"lava-column-sort-"+(this._binds[2].getValue()?"de":"a")+"scending":""},binds:[{property_name:"column",tail:["name"]},{property_name:"_sort_column_name"},{locator_type:"Name",locator:"table",tail:["_sort_descending"]}]}}}},"\r\n					"]},"\r\n				"],container:{type:"Element",tag_name:"tr"}},"\r\n		"]},"\r\n	"],tbody:["\r\n		",{type:"view","class":"Foreach",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"table",tail:["records"]}]},as:"row",template:["\r\n				",{type:"view","class":"Foreach",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"table",tail:["_columns"]}]},as:"column",template:["\r\n						",{type:"view","class":"View",container:{type:"Element",tag_name:"td"},template:["\r\n							",{locator_type:"Name",locator:"table",name:"cell",arguments:[{type:2,data:{property_name:"column"}}],type:"include"},"\r\n						"]},"\r\n					"],container:{type:"Element",tag_name:"tr"}},"\r\n			"],container:{type:"Element",tag_name:"tbody",resource_id:{locator_type:"Name",locator:"table",name:"TBODY_ELEMENT"}}},"\r\n	"]},storage_schema:{cells:{type:"template_hash",tag_name:"cell"}},storage:{cells:{String:["\r\n				",{type:"view","class":"Expression",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"row",tail:[{property_name:"column",tail:["name"]}]}]}},"\r\n			"],Boolean:["\r\n				",{type:"view","class":"Expression",argument:{evaluator:function(){return this._callGlobalModifier("translateBoolean",[!!this._binds[0].getValue()])},flags:{hasGlobalModifiers:!0},binds:[{property_name:"row",tail:[{property_name:"column",tail:["name"]}]}]}},"\r\n			"]}},resources:{"default":{TABLE_ELEMENT:{type:"container_stack",value:[{name:"static_properties",value:{cellspacing:"0",cellpadding:"0"}}]}}},default_events:[],real_class:"Table",is_extended:!1},Calendar:{type:"widget","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard",template:["\r\n			",{type:"view","class":"If",argument:{evaluator:function(){return"days"==this._binds[0].getValue()},binds:[{locator_type:"Name",locator:"calendar",tail:["_selected_view"]}]},template:["\r\n				",{locator_type:"Name",locator:"calendar",name:"days_view",type:"include"},"\r\n			"],else_template:["\r\n				",{locator_type:"Name",locator:"calendar",name:"months_view",type:"include"},"\r\n			"]},"\r\n		"],container:{type:"Element",tag_name:"div",static_classes:["lava-calendar"]},includes:{days_view:['\r\n		<div class="lava-calendar-header">\r\n			',{type:"view","class":"View",container:{type:"Element",tag_name:"a",static_classes:["lava-calendar-left-arrow"],static_properties:{href:"#"},events:{click:[{locator_type:"Name",locator:"calendar",name:"previous_month_click"}]}},template:["&#9664;"]},"\r\n			",{type:"view","class":"Expression",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"calendar",tail:["_month_year_string"]}]},container:{type:"Element",tag_name:"a",static_classes:["lava-calendar-days-view-month-name"],static_properties:{href:"#"},events:{click:[{locator_type:"Name",locator:"calendar",name:"days_view_month_name_click"}]}}},"\r\n			",{type:"view","class":"View",container:{type:"Element",tag_name:"a",static_classes:["lava-calendar-right-arrow"],static_properties:{href:"#"},events:{click:[{locator_type:"Name",locator:"calendar",name:"next_month_click"}]}},template:["&#9654;"]},'\r\n		</div>\r\n		<div class="lava-calendar-center">\r\n			',{locator_type:"Name",locator:"calendar",name:"months",type:"include"},'\r\n		</div>\r\n		<div class="lava-calendar-footer">\r\n			',{type:"view","class":"Expression",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"calendar",tail:["_today_string"]}]},container:{type:"Element",tag_name:"a",static_classes:["lava-calendar-today-link"],static_properties:{href:"#"},events:{click:[{locator_type:"Name",locator:"calendar",name:"today_click"}]}}},"\r\n		</div>\r\n	"],months_view:['\r\n		<div class="lava-calendar-header">\r\n			',{type:"view","class":"View",container:{type:"Element",tag_name:"a",static_classes:["lava-calendar-left-arrow"],static_properties:{href:"#"},events:{click:[{locator_type:"Name",locator:"calendar",name:"previous_year_click"}]}},template:["&#9664;"]},"\r\n			",{"extends":"TextInput",assigns:{value:{evaluator:function(){return this._binds[0].getValue()+""},binds:[{locator_type:"Name",locator:"calendar",tail:["_displayed_year"]}]}},roles:[{locator_type:"Name",locator:"calendar",name:"_year_input"}],"class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard",resource_id:{locator_type:"Name",locator:"calendar",name:"year_input"},type:"widget"},"\r\n			",{type:"view","class":"View",container:{type:"Element",tag_name:"a",static_classes:["lava-calendar-right-arrow"],static_properties:{href:"#"},events:{click:[{locator_type:"Name",locator:"calendar",name:"next_year_click"}]}},template:["&#9654;"]},'\r\n		</div>\r\n		<div class="lava-calendar-center">\r\n			',{locator_type:"Name",locator:"calendar",name:"month_names",type:"include"},"\r\n		</div>\r\n	"],months:["\r\n		",{type:"view","class":"Foreach",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"calendar",tail:["_months_data"]}]},as:"month",template:['\r\n			<table class="lava-calendar-month" cellspacing="0" cellpadding="0">\r\n				<thead>\r\n					<tr>\r\n						',{type:"view","class":"Foreach",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"calendar",tail:["_weekdays"]}]},as:"weekday",template:["\r\n							<td>",{type:"view","class":"Expression",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"weekday",tail:["title"]}]}},"</td>\r\n						"]},"\r\n					</tr>\r\n				</thead>\r\n				<tbody>\r\n					",{type:"view","class":"Foreach",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"month",tail:["weeks"]}]},as:"week",template:["\r\n						<tr>\r\n							",{type:"view","class":"Foreach",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"week"}]},as:"day",template:["\r\n								",{locator_type:"Name",locator:"calendar",name:"day",type:"include"},"\r\n							"]},"\r\n						</tr>\r\n					"]},"\r\n				</tbody>\r\n			</table>\r\n		"]},"\r\n	"],day:["\r\n		",{type:"view","class":"View",container:{type:"Element",tag_name:"td",events:{mousedown:[{locator_type:"Name",locator:"calendar",name:"day_click",arguments:[{type:2,data:{property_name:"day"}}]}]},class_bindings:{0:{evaluator:function(){return this._binds[0].getValue()?"lava-calendar-today":""},binds:[{property_name:"day",tail:["is_today"]}]},1:{evaluator:function(){return this._binds[0].getValue()!=this._binds[1].getValue()?"lava-calendar-other-month-day":""},binds:[{property_name:"month",tail:["index"]},{property_name:"day",tail:["month"]}]},2:{evaluator:function(){return this._binds[0].getValue()>=this._binds[1].getValue()&&this._binds[2].getValue()<=this._binds[3].getValue()?"lava-calendar-selected-day":""},binds:[{property_name:"day",tail:["milliseconds"]},{locator_type:"Name",locator:"calendar",tail:["_selection_start"]},{property_name:"day",tail:["milliseconds"]},{locator_type:"Name",locator:"calendar",tail:["_selection_end"]}]}}},template:["\r\n			",{type:"view","class":"Expression",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"day",tail:["day"]}]}},"\r\n		"]},"\r\n	"],month_names:['\r\n		<table class="lava-calendar-month-names">\r\n			<tbody>\r\n				',{type:"view","class":"Foreach",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"calendar",tail:["_month_descriptor_rows"]}]},as:"row",template:["\r\n					<tr>\r\n						",{type:"view","class":"Foreach",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"row"}]},as:"descriptor",template:["\r\n							",{type:"view","class":"Expression",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"descriptor",tail:["title"]}]},container:{type:"Element",tag_name:"td",events:{click:[{name:"month_click",arguments:[{type:2,data:{property_name:"descriptor"}}]}]},class_bindings:{0:{evaluator:function(){return this._binds[0].getValue()==this._binds[1].getValue()?"lava-calendar-month-selected":this._binds[2].getValue()==this._binds[3].getValue()?"lava-calendar-month-current":""},binds:[{locator_type:"Name",locator:"calendar",tail:["_displayed_month"]},{property_name:"descriptor",tail:["index"]},{locator_type:"Name",locator:"calendar",tail:["_current_month"]},{property_name:"descriptor",tail:["index"]}]}}}},"\r\n						"]},"\r\n					</tr>\r\n				"]},"\r\n			</tbody>\r\n		</table>\r\n	"]},resources:{"default":{year_input:{type:"component",value:{TEXT_INPUT_ELEMENT:{type:"container_stack",value:[{name:"add_properties",value:{maxlength:"5"}},{name:"add_classes",value:["lava-calendar-year-input"]}]}}}}},options:{invalid_input_class:"lava-calendar-input-invalid"},default_events:[],real_class:"Calendar",is_extended:!1}},Lava.sugar_map={checkbox:{widget_title:"CheckBox"},text_area:{widget_title:"TextArea"},text_input:{widget_title:"TextInput"},radio:{widget_title:"Radio"},submit_input:{widget_title:"SubmitInput"},submit_button:{widget_title:"SubmitButton"},collapsible:{widget_title:"Collapsible"},"collapsible-panel":{widget_title:"CollapsiblePanel"},"collapsible-panel-ext":{widget_title:"CollapsiblePanelExt"},accordion:{widget_title:"Accordion"},tabs:{widget_title:"Tabs"}},function(e,t){"use strict";e.define("Lava.widget.input.AutofocusText",{Extends:"Lava.widget.input.Text",broadcastInDOM:function(){this.Text$broadcastInDOM();var e=this._input_container.getDOMElement();e.focus(),t.Element.setProperty(e,"value",this._properties.value)}})}(Lava,Firestorm),function(e,t,i){"use strict";e.define("Lava.widget.TodoApp",{Extends:"Lava.widget.Standard",name:"todo_app",_properties:{todo_list:null,filtered_list:null,edited_item:null,edited_item_text:"",completed_count:0,remaining_count:0,filter_name:"all",filter_names:["all","active","completed"]},_event_handlers:{delete_item_click:"_deleteItemClick",item_double_click:"_itemDoubleClick",clear_completed_click:"_clearCompletedClick"},_role_handlers:{toggle_all_checkbox:"_handleToggleAllCheckbox"},_toggle_all_checkbox:null,STORAGE_ITEM_NAME:"todos-liquidlava",init:function(t,a,n,s,r){var o=this;this._properties.todo_list=new e.system.Enumerable,this._loadItemsFromStorage(),this._properties.filtered_list=new e.system.DataView(this._properties.todo_list),this.Standard$init(t,a,n,s,r),e.focus_manager.on("focus_target_changed",this._onFocusTargetChanged,this),e.Core.addGlobalHandler("keydown",this._onKeyDown,this),new i({"/:filter":function(t){-1==o.get("filter_names").indexOf(t)&&(t="all"),o.set("filter_name",t),o._refreshData(),e.refreshViews()}}).init("/all")},_loadItemsFromStorage:function(){var e=localStorage.getItem(this.STORAGE_ITEM_NAME),t=e&&JSON.parse(e)||[],i=this;t.forEach(function(e){i._addItem(e)})},_onFocusTargetChanged:function(t,i){i&&i!=e.view_manager.getViewById("new_todo")||this._finishEdit()},_clearCompletedClick:function(){this._properties.todo_list.filter(function(e){return!e.get("is_completed")}),this._refreshData()},_refreshData:function(){var e,t=this._properties.todo_list.getValues(),i=0,a=[];t.forEach(function(e){e.get("is_completed")&&i++,a.push(e.getProperties())}),this.set("completed_count",i),this.set("remaining_count",t.length-i),this._toggle_all_checkbox&&this._toggle_all_checkbox.set("is_checked",0===this._properties.remaining_count),this._properties.filtered_list.refresh(),"all"!=this._properties.filter_name&&(e="completed"==this._properties.filter_name,this._properties.filtered_list.filter(function(t){return t.get("is_completed")==e})),localStorage.setItem(this.STORAGE_ITEM_NAME,JSON.stringify(a))},_deleteItemClick:function(e,t,i,a){this._properties.todo_list.removeValue(a[0]),this._refreshData()},_itemDoubleClick:function(e,t,i,a){var n=a[0];this.set("edited_item_text",n.get("title")),this.set("edited_item",n)},_onTaskCompletedChanged:function(){this._refreshData()},_addItem:function(t){var i=new e.mixin.Properties(t);i.onPropertyChanged("is_completed",this._onTaskCompletedChanged,this),this._properties.todo_list.push(i)},_onKeyDown:function(i,a){var n,s;a.code==t.KEY_CODES.ENTER?(n=e.view_manager.getViewById("new_todo"),s=e.focus_manager.getFocusedTarget(),n==s&&n.get("value").trim()?(this._addItem({title:n.get("value").trim(),is_completed:!1}),this._refreshData(),n.set("value","")):this._finishEdit()):a.code==t.KEY_CODES.ESCAPE&&this.set("edited_item",null)},_handleToggleAllCheckbox:function(e){this._toggle_all_checkbox=e,e.set("is_checked",0===this._properties.remaining_count),e.on("checked_changed",this._onToggleAllChanged,this)},_onToggleAllChanged:function(){var e=this._toggle_all_checkbox.get("is_checked");this._properties.todo_list.getValues().forEach(function(t){t.set("is_completed",e)}),this._refreshData()},_finishEdit:function(){var e=this._properties.edited_item,t=this._properties.edited_item_text.trim();e&&(t?e.set("title",t):this._properties.todo_list.removeValue(e),this.set("edited_item",null),this._refreshData())}})}(Lava,Firestorm,Router),page_config={type:"widget","class":"TodoApp",extender_type:"Standard",container:{type:"Element",tag_name:"body",static_properties:{"lava-app":"TodoApp"}},template:['\r\n		<section class="todoapp">\r\n			',{type:"view","class":"View",container:{type:"Element",tag_name:"header",static_classes:["header"]},template:["\r\n				<h1>todos</h1>\r\n				",{type:"widget","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard","extends":"TextInput",id:"new_todo",resources:{"default":{TEXT_INPUT_ELEMENT:{type:"container_stack",value:[{name:"add_classes",value:["new-todo"]},{name:"add_properties",value:{placeholder:"What needs to be done?"}}]}}},real_class:"input.AutofocusText"},"\r\n			"]},"\r\n			",{type:"view","class":"If",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"todo_app",tail:["todo_list","length"]}]},container:{type:"Morph"},template:["\r\n				",{type:"view","class":"View",container:{type:"Element",tag_name:"section",static_classes:["main"]},template:["\r\n					",{type:"widget","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard","extends":"CheckBox",id:"toggle_all",resources:{"default":{CHECKBOX_ELEMENT:{type:"container_stack",value:[{name:"add_classes",value:["toggle-all"]}]}}},roles:[{locator_type:"Name",locator:"todo_app",name:"toggle_all_checkbox"}]},"\r\n					",{type:"view","class":"View",container:{type:"Element",tag_name:"label",static_classes:["toggle-all-label"]},roles:[{locator_type:"Id",locator:"toggle_all",name:"label"}],template:["Mark all as complete"]},"\r\n					",{type:"view","class":"Foreach",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"todo_app",tail:["filtered_list"]}]},as:"item",refresher:{type:"Standard"},template:["\r\n							\r\n							",{type:"view","class":"If",argument:{evaluator:function(){return this._binds[0].getValue()!=this._binds[1].getValue()},binds:[{property_name:"item"},{locator_type:"Name",locator:"todo_app",tail:["edited_item"]}]},template:["\r\n									",{type:"view","class":"View",container:{type:"Element",tag_name:"div",static_classes:["view"]},template:["\r\n										",{type:"widget","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard","extends":"CheckBox",bindings:{is_checked:{property_name:"is_checked",path_config:{property_name:"item",tail:["is_completed"]}}},resources:{"default":{CHECKBOX_ELEMENT:{type:"container_stack",value:[{name:"add_classes",value:["toggle"]}]}}}},"\r\n										",{type:"view","class":"Expression",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{property_name:"item",tail:["title"]}]},container:{type:"Element",tag_name:"label",events:{dblclick:[{locator_type:"Name",locator:"todo_app",name:"item_double_click",arguments:[{type:2,data:{property_name:"item"}}]}]}}},"\r\n										",{type:"view","class":"View",container:{type:"Element",tag_name:"button",static_classes:["destroy"],events:{click:[{locator_type:"Name",locator:"todo_app",name:"delete_item_click",arguments:[{type:2,data:{property_name:"item"}}]}]}}},"\r\n									"]},"\r\n								"],else_template:["\r\n									",{type:"widget","class":"Lava.WidgetConfigExtensionGateway",extender_type:"Standard","extends":"TextInput",bindings:{value:{property_name:"value",path_config:{locator_type:"Name",locator:"todo_app",tail:["edited_item_text"]}}},resources:{"default":{TEXT_INPUT_ELEMENT:{type:"container_stack",value:[{name:"add_classes",value:["edit"]}]}}},real_class:"input.AutofocusText"},"\r\n								"],container:{type:"Element",tag_name:"li",class_bindings:{0:{evaluator:function(){return this._binds[0].getValue()?"completed":""},binds:[{property_name:"item",tail:["is_completed"]}]},1:{evaluator:function(){return this._binds[0].getValue()==this._binds[1].getValue()?"editing":""},binds:[{property_name:"item"},{locator_type:"Name",locator:"todo_app",tail:["edited_item"]}]}}}},"\r\n						"],container:{type:"Element",tag_name:"ul",static_classes:["todo-list"]}},"\r\n				"]},'\r\n				<footer class="footer">\r\n					',{type:"view","class":"View",container:{type:"Element",tag_name:"span",static_classes:["todo-count"]},template:["\r\n						<strong>",{type:"view","class":"Expression",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"todo_app",tail:["remaining_count"]}]}},"</strong> item",{type:"view","class":"Expression",argument:{evaluator:function(){return 1!=this._binds[0].getValue()?"s":""},binds:[{locator_type:"Name",locator:"todo_app",tail:["remaining_count"]}]}}," left\r\n					"]},"\r\n					",{type:"view","class":"Foreach",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"todo_app",tail:["filter_names"]}]},as:"filter_name",template:["\r\n							<li>\r\n								",{type:"view","class":"Expression",argument:{evaluator:function(){return this._callGlobalModifier("ucFirst",[this._binds[0].getValue()])},flags:{hasGlobalModifiers:!0},binds:[{property_name:"filter_name"}]},container:{type:"Element",tag_name:"a",property_bindings:{href:{evaluator:function(){return"#/"+this._binds[0].getValue()},binds:[{property_name:"filter_name"}]}},class_bindings:{0:{evaluator:function(){return this._binds[0].getValue()==this._binds[1].getValue()?"selected":""},binds:[{property_name:"filter_name"},{locator_type:"Name",locator:"todo_app",tail:["filter_name"]}]}}}},"\r\n							</li>\r\n						"],container:{type:"Element",tag_name:"ul",static_classes:["filters"]}},"\r\n					",{type:"view","class":"If",argument:{evaluator:function(){return this._binds[0].getValue()},flags:{isScopeEval:!0},binds:[{locator_type:"Name",locator:"todo_app",tail:["completed_count"]}]},container:{type:"Emulated",options:{prepender:"AfterPrevious"}},refresher:{type:"Standard"},template:["\r\n						\r\n						\r\n						",{type:"view","class":"Expression",argument:{evaluator:function(){return"Clear completed ("+this._binds[0].getValue()+")"},binds:[{locator_type:"Name",locator:"todo_app",tail:["completed_count"]}]},container:{type:"Element",tag_name:"button",static_classes:["clear-completed"],events:{click:[{locator_type:"Name",locator:"todo_app",name:"clear_completed_click"}]}}},"\r\n					"]},"\r\n				</footer>\r\n			"]},'\r\n		</section>\r\n		<footer class="info">\r\n			<p>Double-click to edit a todo</p>\r\n			<p>Created by <a href="http://lava-framework.com/">Alex Galashov</a></p>\r\n			<p>Part of <a href="http://todomvc.com">TodoMVC</a></p>\r\n		</footer>\r\n		\r\n	'],is_extended:!0};